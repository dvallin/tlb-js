!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=14)}([function(t,e,i){"use strict";const r=2.3283064365386963e-10;class n{constructor(){this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}getSeed(){return this._seed}setSeed(t){return t=t<1?1/t:t,this._seed=t,this._s0=(t>>>0)*r,t=69069*t+1>>>0,this._s1=t*r,t=69069*t+1>>>0,this._s2=t*r,this._c=1,this}getUniform(){let t=2091639*this._s0+this._c*r;return this._s0=this._s1,this._s1=this._s2,this._c=0|t,this._s2=t-this._c,this._s2}getUniformInt(t,e){let i=Math.max(t,e),r=Math.min(t,e);return Math.floor(this.getUniform()*(i-r+1))+r}getNormal(t=0,e=1){let i,r,n;do{n=(i=2*this.getUniform()-1)*i+(r=2*this.getUniform()-1)*r}while(n>1||0==n);return t+i*Math.sqrt(-2*Math.log(n)/n)*e}getPercentage(){return 1+Math.floor(100*this.getUniform())}getItem(t){return t.length?t[Math.floor(this.getUniform()*t.length)]:null}shuffle(t){let e=[],i=t.slice();for(;i.length;){let t=i.indexOf(this.getItem(i));e.push(i.splice(t,1)[0])}return e}getWeightedValue(t){let e=0;for(let i in t)e+=t[i];let i,r=this.getUniform()*e,n=0;for(i in t)if(r<(n+=t[i]))return i;return i}getState(){return[this._s0,this._s1,this._s2,this._c]}setState(t){return this._s0=t[0],this._s1=t[1],this._s2=t[2],this._c=t[3],this}clone(){return(new n).setState(this.getState())}}e.a=(new n).setSeed(Date.now())},function(t,e,i){"use strict";function r(t,e){return(t%e+e)%e}function n(t,e=0,i=1){return t<e?e:t>i?i:t}function o(t){return t.charAt(0).toUpperCase()+t.substring(1)}function s(t,...e){let i=s.map;return t.replace(/%(?:([a-z]+)|(?:{([^}]+)}))/gi,(function(r,n,s,a){if("%"==t.charAt(a-1))return r.substring(1);if(!e.length)return r;let l=e[0],u=(n||s).split(","),h=u.shift()||"",c=i[h.toLowerCase()];if(!c)return r;let f=(l=e.shift())[c].apply(l,u),d=h.charAt(0);return d!=d.toLowerCase()&&(f=o(f)),f}))}i.r(e),i.d(e,"mod",(function(){return r})),i.d(e,"clamp",(function(){return n})),i.d(e,"capitalize",(function(){return o})),i.d(e,"format",(function(){return s})),s.map={s:"toString"}},function(t,e,i){var r,n=i(10),o=i(6),s=function(t,e){return e.description=t,e},a=function(t,e,i){return s(t,(function(t){return t instanceof e[i]}))};(r={}).isNumTerm=s("a NumTerm (non-zero integer)",(function(t){return t===(0|t)&&0!==t})),r.isNameTerm=s("a NameTerm (string)",(function(t){return"string"==typeof t&&!/^-*[0-9]*$/.test(t)})),r.isTerm=s("a Term (appropriate string or number)",(function(t){return r.isNumTerm(t)||r.isNameTerm(t)})),r.isWholeNumber=s("a whole number (integer >= 0)",(function(t){return t===(0|t)&&t>=0})),r.isFormula=a("a Formula",r,"Formula"),r.isClause=a("a Clause",r,"Clause"),r.isBits=a("a Bits",r,"Bits"),r._isInteger=s("an integer",(function(t){return t===(0|t)})),r._isFunction=s("a Function",(function(t){return"function"==typeof t})),r._isString=s("a String",(function(t){return"string"==typeof t})),r._isArrayWhere=function(t){var e="an array";return t.description&&(e+=" of "+t.description),s(e,(function(e){if(o.isArray(e)){for(var i=0;i<e.length;i++)if(!t(e[i]))return!1;return!0}return!1}))},r._isFormulaOrTerm=s("a Formula or Term",(function(t){return r.isFormula(t)||r.isTerm(t)})),r._isFormulaOrTermOrBits=s("a Formula, Term, or Bits",(function(t){return r.isFormula(t)||r.isBits(t)||r.isTerm(t)})),r._MiniSat=n;var l=r._isInteger,u=r._isFunction,h=r._isString,c=r._isArrayWhere,f=r._isFormulaOrTerm,d=r._isFormulaOrTermOrBits;r._assert=function(t,e,i){if(!e(t)){var r="string"==typeof t?JSON.stringify(t):t;throw new Error(r+" is not "+(e.description||i))}};var m=function(t,e,i){if(t!==e)throw new Error("Expected "+e+" args in "+i+", got "+t)},p=r._assert;r._assertIfEnabled=function(t,e,i){p&&p(t,e,i)},r.disablingAssertions=function(t){var e=p;try{return p=null,t()}finally{p=e}},r._disablingTypeChecks=r.disablingAssertions,r.not=function(t){return p&&p(t,f),t instanceof r.Formula?new r.NotFormula(t):"number"==typeof t?-t:"-"===t.charAt(0)?t.slice(1):"-"+t},r.NAME_FALSE="$F",r.NAME_TRUE="$T",r.NUM_FALSE=1,r.NUM_TRUE=2,r.TRUE=r.NAME_TRUE,r.FALSE=r.NAME_FALSE,r.Formula=function(){},r._defineFormula=function(t,e,i){p&&p(t,u),p&&p(e,h),t.prototype=new r.Formula,t.prototype.type=e,i&&o.extend(t.prototype,i)},r.Formula.prototype.generateClauses=function(t,e){throw new Error("Cannot generate this Formula; it must be expanded")},r.Formula._nextGuid=1,r.Formula.prototype._guid=null,r.Formula.prototype.guid=function(){return null===this._guid&&(this._guid=r.Formula._nextGuid++),this._guid},r.Clause=function(){var t=o.flatten(arguments);p&&p(t,c(r.isNumTerm)),this.terms=t},r.Clause.prototype.append=function(){return new r.Clause(this.terms.concat(o.flatten(arguments)))};var g=function(){this.varName=null,this.varNum=null,this.occursPositively=!1,this.occursNegatively=!1,this.isRequired=!1,this.isForbidden=!1};r.Termifier=function(t){this.solver=t},r.Termifier.prototype.clause=function(){var t=this,e=o.flatten(arguments);return p&&p(e,c(f)),new r.Clause(o.map(e,(function(e){return t.term(e)})))},r.Termifier.prototype.term=function(t){return this.solver._formulaToTerm(t)},r.Termifier.prototype.generate=function(t,e){return this.solver._generateFormula(t,e,this)},r.Solver=function(){this.clauses=[],this._num2name=[null],this._name2num={};var t=this.getVarNum(r.NAME_FALSE,!1,!0),e=this.getVarNum(r.NAME_TRUE,!1,!0);if(t!==r.NUM_FALSE||e!==r.NUM_TRUE)throw new Error("Assertion failure: $T and $F have wrong numeric value");this._F_used=!1,this._T_used=!1,this.clauses.push(new r.Clause(-r.NUM_FALSE)),this.clauses.push(new r.Clause(r.NUM_TRUE)),this._formulaInfo={},this._nextFormulaNumByType={},this._ungeneratedFormulas={},this._numClausesAddedToMiniSat=0,this._unsat=!1,this._minisat=new n,this._termifier=new r.Termifier(this)},r.Solver.prototype.getVarNum=function(t,e,i){var r=" "+t;if(o.has(this._name2num,r))return this._name2num[r];if(e)return 0;if("$"===t.charAt(0)&&!i)throw new Error("Only generated variable names can start with $");var n=this._num2name.length;return this._name2num[r]=n,this._num2name.push(t),n},r.Solver.prototype.getVarName=function(t){p&&p(t,l);var e=this._num2name;if(t<1||t>=e.length)throw new Error("Bad variable num: "+t);return e[t]},r.Solver.prototype.toNumTerm=function(t,e){if(p&&p(t,r.isTerm),"number"==typeof t)return t;for(var i=!1;"-"===t.charAt(0);)t=t.slice(1),i=!i;var n=this.getVarNum(t,e);return n?i?-n:n:0},r.Solver.prototype.toNameTerm=function(t){if(p&&p(t,r.isTerm),"string"==typeof t){for(;"--"===t.slice(0,2);)t=t.slice(2);return t}var e=!1;return t<0&&(e=!0,t=-t),t=this.getVarName(t),e&&(t="-"+t),t},r.Solver.prototype._addClause=function(t,e,i){p&&p(t,r.isClause);var n=null;e&&(n=e,p&&p(n,c(r.isNumTerm)));var o=!1,s=!1,a=t.terms.length;n&&(t=t.append(n));for(var l=0;l<t.terms.length;l++){var u=t.terms[l],h=u<0?-u:u;if(h===r.NUM_FALSE)o=!0;else if(h===r.NUM_TRUE)s=!0;else{if(h<1||h>=this._num2name.length)throw new Error("Bad variable number: "+h);l<a&&(i?i(u):this._useFormulaTerm(u))}}this._F_used=this._F_used||o,this._T_used=this._T_used||s,this.clauses.push(t)},r.Solver.prototype._useFormulaTerm=function(t,e){var i=this;p&&p(t,r.isNumTerm);var n=t<0?-t:t;if(o.has(i._ungeneratedFormulas,n)){var s,a=i._ungeneratedFormulas[n],l=i._getFormulaInfo(a),u=t>0,h=null;if(e?s=e:(h=[],s=function(t,e){h.push({clauses:t,extraTerms:e})}),u&&!l.occursPositively){l.occursPositively=!0;var c=i._generateFormula(!0,a);s(c,[-n])}else if(!u&&!l.occursNegatively){l.occursNegatively=!0;c=i._generateFormula(!1,a);s(c,[n])}if(l.occursPositively&&l.occursNegatively&&delete i._ungeneratedFormulas[n],h&&h.length)for(var f=function(t){i._useFormulaTerm(t,s)};h.length;){var d=h.pop();i._addClauses(d.clauses,d.extraTerms,f)}}},r.Solver.prototype._addClauses=function(t,e,i){p&&p(t,c(r.isClause));var n=this;o.each(t,(function(t){n._addClause(t,e,i)}))},r.Solver.prototype.require=function(){this._requireForbidImpl(!0,o.flatten(arguments))},r.Solver.prototype.forbid=function(){this._requireForbidImpl(!1,o.flatten(arguments))},r.Solver.prototype._requireForbidImpl=function(t,e){var i=this;p&&p(e,c(f)),o.each(e,(function(e){if(e instanceof r.NotFormula)i._requireForbidImpl(!t,[e.operand]);else if(e instanceof r.Formula){var n=i._getFormulaInfo(e);if(null!==n.varNum){var o=t?1:-1;i._addClause(new r.Clause(o*n.varNum))}else i._addClauses(i._generateFormula(t,e));t?n.isRequired=!0:n.isForbidden=!0}else i._addClauses(i._generateFormula(t,e))}))},r.Solver.prototype._generateFormula=function(t,e,i){if(p&&p(e,f),e instanceof r.NotFormula)return this._generateFormula(!t,e.operand);if(e instanceof r.Formula){var n=this._getFormulaInfo(e);if(t&&n.isRequired||!t&&n.isForbidden)return[];if(t&&n.isForbidden||!t&&n.isRequired)return[new r.Clause];var s=e.generateClauses(t,i||this._termifier);return o.isArray(s)?s:[s]}var a=this.toNumTerm(e),l=t?1:-1;return a===l*r.NUM_TRUE||a===-l*r.NUM_FALSE?[]:a===l*r.NUM_FALSE||a===-l*r.NUM_TRUE?[new r.Clause]:[new r.Clause(l*a)]},r.Solver.prototype._clauseData=function(){var t=o.pluck(this.clauses,"terms");return this._T_used||t.splice(1,1),this._F_used||t.splice(0,1),t},r.Solver.prototype._clauseStrings=function(){var t=this,e=t._clauseData();return o.map(e,(function(e){return o.map(e,(function(e){var i=t.toNameTerm(e);if(/\s/.test(i)){var r="";"-"===i.charAt(0)&&(r="-",i=i.slice(1)),i=r+'"'+i+'"'}return i})).join(" v ")}))},r.Solver.prototype._getFormulaInfo=function(t,e){var i=t.guid();if(!this._formulaInfo[i]){if(e)return null;this._formulaInfo[i]=new g}return this._formulaInfo[i]},r.Solver.prototype._formulaToTerm=function(t){if(o.isArray(t))return p&&p(t,c(f)),o.map(t,o.bind(this._formulaToTerm,this));if(p&&p(t,f),t instanceof r.NotFormula)return r.not(this._formulaToTerm(t.operand));if(t instanceof r.Formula){var e=this._getFormulaInfo(t);if(e.isRequired)return r.NUM_TRUE;if(e.isForbidden)return r.NUM_FALSE;if(null===e.varNum){var i=t.type;this._nextFormulaNumByType[i]||(this._nextFormulaNumByType[i]=1);var n=this._nextFormulaNumByType[i]++;e.varName="$"+t.type+n,e.varNum=this.getVarNum(e.varName,!1,!0),this._ungeneratedFormulas[e.varNum]=t}return e.varNum}return this.toNumTerm(t)},r.or=function(){var t=o.flatten(arguments);return 0===t.length?r.FALSE:1===t.length?(p&&p(t[0],f),t[0]):new r.OrFormula(t)},r.OrFormula=function(t){p&&p(t,c(f)),this.operands=t},r._defineFormula(r.OrFormula,"or",{generateClauses:function(t,e){if(t)return e.clause(this.operands);var i=[];return o.each(this.operands,(function(t){i.push.apply(i,e.generate(!1,t))})),i}}),r.NotFormula=function(t){p&&p(t,f),this.operand=t},r._defineFormula(r.NotFormula,"not"),r.and=function(){var t=o.flatten(arguments);return 0===t.length?r.TRUE:1===t.length?(p&&p(t[0],f),t[0]):new r.AndFormula(t)},r.AndFormula=function(t){p&&p(t,c(f)),this.operands=t},r._defineFormula(r.AndFormula,"and",{generateClauses:function(t,e){if(t){var i=[];return o.each(this.operands,(function(t){i.push.apply(i,e.generate(!0,t))})),i}return e.clause(o.map(this.operands,r.not))}});var _=function(t,e){for(var i=[],r=0;r<t.length;r+=e)i.push(t.slice(r,r+e));return i};r.xor=function(){var t=o.flatten(arguments);return 0===t.length?r.FALSE:1===t.length?(p&&p(t[0],f),t[0]):new r.XorFormula(t)},r.XorFormula=function(t){p&&p(t,c(f)),this.operands=t},r._defineFormula(r.XorFormula,"xor",{generateClauses:function(t,e){var i=this.operands,n=r.not;if(i.length>3)return e.generate(t,r.xor(o.map(_(this.operands,3),(function(t){return r.xor(t)}))));if(t){if(0===i.length)return e.clause();if(1===i.length)return e.clause(i[0]);if(2===i.length){var s=i[0],a=i[1];return[e.clause(s,a),e.clause(n(s),n(a))]}if(3===i.length){s=i[0],a=i[1];var l=i[2];return[e.clause(s,a,l),e.clause(s,n(a),n(l)),e.clause(n(s),a,n(l)),e.clause(n(s),n(a),l)]}}else{if(0===i.length)return[];if(1===i.length)return e.clause(n(i[0]));if(2===i.length){s=i[0],a=i[1];return[e.clause(s,n(a)),e.clause(n(s),a)]}if(3===i.length){s=i[0],a=i[1],l=i[2];return[e.clause(n(s),n(a),n(l)),e.clause(n(s),a,l),e.clause(s,n(a),l),e.clause(s,a,n(l))]}}}}),r.atMostOne=function(){var t=o.flatten(arguments);return t.length<=1?r.TRUE:new r.AtMostOneFormula(t)},r.AtMostOneFormula=function(t){p&&p(t,c(f)),this.operands=t},r._defineFormula(r.AtMostOneFormula,"atMostOne",{generateClauses:function(t,e){var i=this.operands,n=r.not;if(i.length<=1)return[];if(2===i.length)return e.generate(t,r.not(r.and(i)));if(t&&3===i.length){for(var s=[],a=0;a<i.length;a++)for(var l=a+1;l<i.length;l++)s.push(e.clause(n(i[a]),n(i[l])));return s}if(t||3!==i.length){var u=_(i,3),h=o.map(u,(function(t){return r.or(t)}));u[u.length-1].length<2&&u.pop();var c=o.map(u,(function(t){return r.atMostOne(t)}));return e.generate(t,r.and(r.atMostOne(h),c))}var f=i[0],d=i[1],m=i[2];return[e.clause(f,d),e.clause(f,m),e.clause(d,m)]}}),r.implies=function(t,e){return p&&m(arguments.length,2,"Logic.implies"),new r.ImpliesFormula(t,e)},r.ImpliesFormula=function(t,e){p&&p(t,f),p&&p(e,f),p&&m(arguments.length,2,"Logic.implies"),this.A=t,this.B=e},r._defineFormula(r.ImpliesFormula,"implies",{generateClauses:function(t,e){return e.generate(t,r.or(r.not(this.A),this.B))}}),r.equiv=function(t,e){return p&&m(arguments.length,2,"Logic.equiv"),new r.EquivFormula(t,e)},r.EquivFormula=function(t,e){p&&p(t,f),p&&p(e,f),p&&m(arguments.length,2,"Logic.equiv"),this.A=t,this.B=e},r._defineFormula(r.EquivFormula,"equiv",{generateClauses:function(t,e){return e.generate(!t,r.xor(this.A,this.B))}}),r.exactlyOne=function(){var t=o.flatten(arguments);return 0===t.length?r.FALSE:1===t.length?(p&&p(t[0],f),t[0]):new r.ExactlyOneFormula(t)},r.ExactlyOneFormula=function(t){p&&p(t,c(f)),this.operands=t},r._defineFormula(r.ExactlyOneFormula,"exactlyOne",{generateClauses:function(t,e){var i=this.operands;return i.length<3?e.generate(t,r.xor(i)):e.generate(t,r.and(r.atMostOne(i),r.or(i)))}}),r.Bits=function(t){p&&p(t,c(f)),this.bits=t},r.constantBits=function(t){p&&p(t,r.isWholeNumber);for(var e=[];t;)e.push(1&t?r.TRUE:r.FALSE),t>>>=1;return new r.Bits(e)},r.variableBits=function(t,e){p&&p(e,r.isWholeNumber);for(var i=[],n=0;n<e;n++)i.push(t+"$"+n);return new r.Bits(i)},r.lessThanOrEqual=function(t,e){return new r.LessThanOrEqualFormula(t,e)},r.LessThanOrEqualFormula=function(t,e){p&&p(t,r.isBits),p&&p(e,r.isBits),p&&m(arguments.length,2,"Bits comparison function"),this.bits1=t,this.bits2=e};var v=function(t,e,i,n){var s=[],a=t.bits.slice(),l=e.bits.slice();if(n&&!e.bits.length)return i.clause();for(;a.length>l.length;){var u=a.pop();s.push(i.clause(r.not(u)))}for(var h=o.map(l,(function(t,e){return e<a.length?r.xor(a[e],t):t})),c=a.length-1;c>=0;c--)s.push(i.clause(h.slice(c+1),r.not(a[c]),l[c]));return n&&s.push.apply(s,i.generate(!0,r.or(h))),s};r._defineFormula(r.LessThanOrEqualFormula,"lte",{generateClauses:function(t,e){return t?v(this.bits1,this.bits2,e,!1):v(this.bits2,this.bits1,e,!0)}}),r.lessThan=function(t,e){return new r.LessThanFormula(t,e)},r.LessThanFormula=function(t,e){p&&p(t,r.isBits),p&&p(e,r.isBits),p&&m(arguments.length,2,"Bits comparison function"),this.bits1=t,this.bits2=e},r._defineFormula(r.LessThanFormula,"lt",{generateClauses:function(t,e){return t?v(this.bits1,this.bits2,e,!0):v(this.bits2,this.bits1,e,!1)}}),r.greaterThan=function(t,e){return r.lessThan(e,t)},r.greaterThanOrEqual=function(t,e){return r.lessThanOrEqual(e,t)},r.equalBits=function(t,e){return new r.EqualBitsFormula(t,e)},r.EqualBitsFormula=function(t,e){p&&p(t,r.isBits),p&&p(e,r.isBits),p&&m(arguments.length,2,"Logic.equalBits"),this.bits1=t,this.bits2=e},r._defineFormula(r.EqualBitsFormula,"equalBits",{generateClauses:function(t,e){for(var i=this.bits1.bits,n=this.bits2.bits,o=Math.max(i.length,n.length),s=[],a=0;a<o;a++)a>=i.length?s.push(r.not(n[a])):a>=n.length?s.push(r.not(i[a])):s.push(r.equiv(i[a],n[a]));return e.generate(t,r.and(s))}}),r.HalfAdderSum=function(t,e){p&&p(t,f),p&&p(e,f),p&&m(arguments.length,2,"Logic.HalfAdderSum"),this.a=t,this.b=e},r._defineFormula(r.HalfAdderSum,"hsum",{generateClauses:function(t,e){return e.generate(t,r.xor(this.a,this.b))}}),r.HalfAdderCarry=function(t,e){p&&p(t,f),p&&p(e,f),p&&m(arguments.length,2,"Logic.HalfAdderCarry"),this.a=t,this.b=e},r._defineFormula(r.HalfAdderCarry,"hcarry",{generateClauses:function(t,e){return e.generate(t,r.and(this.a,this.b))}}),r.FullAdderSum=function(t,e,i){p&&p(t,f),p&&p(e,f),p&&p(i,f),p&&m(arguments.length,3,"Logic.FullAdderSum"),this.a=t,this.b=e,this.c=i},r._defineFormula(r.FullAdderSum,"fsum",{generateClauses:function(t,e){return e.generate(t,r.xor(this.a,this.b,this.c))}}),r.FullAdderCarry=function(t,e,i){p&&p(t,f),p&&p(e,f),p&&p(i,f),p&&m(arguments.length,3,"Logic.FullAdderCarry"),this.a=t,this.b=e,this.c=i},r._defineFormula(r.FullAdderCarry,"fcarry",{generateClauses:function(t,e){return e.generate(!t,r.atMostOne(this.a,this.b,this.c))}});var b=function(t){p&&p(t,c(c(f)));for(var e=o.map(t,o.clone),i=0,n=[];i<e.length;){var s=e[i];if(s.length)if(1===s.length)n.push(s[0]),i++;else if(2===s.length){var a=new r.HalfAdderSum(s[0],s[1]),l=new r.HalfAdderCarry(s[0],s[1]);s.length=0,s.push(a),y(e,i+1,l)}else{var u=s.pop(),h=s.pop(),d=s.pop();a=new r.FullAdderSum(d,h,u),l=new r.FullAdderCarry(d,h,u);s.push(a),y(e,i+1,l)}else n.push(r.FALSE),i++}return n},y=function(t,e,i){for(;e>=t.length;)t.push([]);t[e].push(i)},w=function(t,e){if(p&&p(t,c(f)),"number"==typeof e)p&&p(e,r.isWholeNumber);else if(p&&p(e,c(r.isWholeNumber)),t.length!==e.length)throw new Error("Formula array and weight array must be same length; they are "+t.length+" and "+e.length)};r.weightedSum=function(t,e){if(w(t,e),0===t.length)return new r.Bits([]);"number"==typeof e&&(e=o.map(t,(function(){return e})));var i=[];return o.each(t,(function(t,r){for(var n=e[r],o=0;n;)1&n&&y(i,o,t),n>>>=1,o++})),new r.Bits(b(i))},r.sum=function(){var t=o.flatten(arguments);p&&p(t,c(d));var e=[];return o.each(t,(function(t){t instanceof r.Bits?o.each(t.bits,(function(t,i){y(e,i,t)})):y(e,0,t)})),new r.Bits(b(e))},r.Solver.prototype.solve=function(t){if(void 0!==t&&!(t>=1))throw new Error("_assumpVar must be a variable number");if(this._unsat)return null;for(;this._numClausesAddedToMiniSat<this.clauses.length;){var e=this._numClausesAddedToMiniSat,i=this.clauses[e].terms;p&&p(i,c(r.isNumTerm));var n=this._minisat.addClause(i);if(this._numClausesAddedToMiniSat++,!n)return this._unsat=!0,null}return p&&p(this._num2name.length-1,r.isWholeNumber),this._minisat.ensureVar(this._num2name.length-1),(n=t?this._minisat.solveAssuming(t):this._minisat.solve())?new r.Solution(this,this._minisat.getSolution()):(t||(this._unsat=!0),null)},r.Solver.prototype.solveAssuming=function(t){p&&p(t,f);var e=new r.Assumption(t),i=this._formulaToTerm(e);if(!("number"==typeof i&&i>0))throw new Error("Assertion failure: not a positive numeric term");this._useFormulaTerm(i);var n=this.solve(i);return this._minisat.retireVar(i),n},r.Assumption=function(t){p&&p(t,f),this.formula=t},r._defineFormula(r.Assumption,"assump",{generateClauses:function(t,e){return t?e.clause(this.formula):e.clause(r.not(this.formula))}}),r.Solution=function(t,e){var i=this;i._solver=t,i._assignment=e,i._ungeneratedFormulas=o.clone(t._ungeneratedFormulas),i._formulaValueCache={},i._termifier=new r.Termifier(i._solver),i._termifier.term=function(t){return i.evaluate(t)?r.NUM_TRUE:r.NUM_FALSE},i._ignoreUnknownVariables=!1},r.Solution.prototype.ignoreUnknownVariables=function(){this._ignoreUnknownVariables=!0},r.Solution.prototype.getMap=function(){for(var t=this._solver,e=this._assignment,i={},r=1;r<e.length;r++){var n=t.getVarName(r);n&&"$"!==n.charAt(0)&&(i[n]=e[r])}return i},r.Solution.prototype.getTrueVars=function(){for(var t=this._solver,e=this._assignment,i=[],r=1;r<e.length;r++)if(e[r]){var n=t.getVarName(r);n&&"$"!==n.charAt(0)&&i.push(n)}return i.sort(),i},r.Solution.prototype.getFormula=function(){for(var t=this._solver,e=this._assignment,i=[],n=1;n<e.length;n++){var o=t.getVarName(n);o&&"$"!==o.charAt(0)&&i.push(e[n]?n:-n)}return r.and(i)},r.Solution.prototype.evaluate=function(t){var e=this;if(p&&p(t,d),t instanceof r.Bits){var i=0;return o.each(t.bits,(function(t,r){e.evaluate(t)&&(i+=1<<r)})),i}var n=e._solver,s=e._ignoreUnknownVariables,a=e._assignment,l=t;if(l instanceof r.NotFormula)return!e.evaluate(l.operand);if(l instanceof r.Formula){var u=e._formulaValueCache[l.guid()];if("boolean"==typeof u)return u;var h=n._getFormulaInfo(l,!0);if(h&&h.varNum&&h.varNum<a.length&&!o.has(e._ungeneratedFormulas,h.varNum))f=a[h.varNum];else var c=n._generateFormula(!0,l,e._termifier),f=o.all(c,(function(t){return o.any(t.terms,(function(t){return e.evaluate(t)}))}));return e._formulaValueCache[l.guid()]=f,f}var m=n.toNumTerm(l,!0);if(!m){if(s)return!1;var g=String(l).replace(/^-*/,"");throw new Error("No such variable: "+g)}var _=m,v=!1;if(m<0&&(_=-_,v=!0),_<1||_>=a.length){g=_;if(_>=1&&_<n._num2name.length&&(g=n._num2name[_]),s)return!1;throw new Error("Variable not part of solution: "+g)}i=a[_];return v&&(i=!i),i},r.Solution.prototype.getWeightedSum=function(t,e){w(t,e);var i=0;if("number"==typeof e)for(var r=0;r<t.length;r++)i+=e*(this.evaluate(t[r])?1:0);else for(r=0;r<t.length;r++)i+=e[r]*(this.evaluate(t[r])?1:0);return i};var E=function(t,e){if("number"==typeof e)return e?t:[];for(var i=[],r=0;r<t.length;r++)e[r]&&i.push(t[r]);return i},k=function(t,e,i,n,o,s){var a=e,l=a.getWeightedSum(i,n),u=o&&o.formula||r.weightedSum(i,n),h=o&&o.progress,c=o&&o.strategy,f=null;if(s&&l>0){h&&h("trying",0);var d=null;f=E(i,n),(d=t.solveAssuming(r.not(r.or(f))))&&(a=d,l=0)}if(s&&"bottom-up"===c)for(var m=1;m<l;m++){h&&h("trying",m);var p=r.equalBits(u,r.constantBits(m));if(g=t.solveAssuming(p)){a=g,l=m;break}}else{if(c&&"default"!==c)throw new Error("Bad strategy: "+c);c="default"}if("default"===c)for(;!s||l>0;){h&&h("improving",l);var g,_=(s?r.lessThan:r.greaterThan)(u,r.constantBits(l));if(!(g=t.solveAssuming(_)))break;t.require(_),l=(a=g).getWeightedSum(i,n)}return s&&0===l?(f||(f=E(i,n)),t.forbid(f)):t.require(r.equalBits(u,r.constantBits(l))),h&&h("finished",l),a};r.Solver.prototype.minimizeWeightedSum=function(t,e,i,r){return k(this,t,e,i,r,!0)},r.Solver.prototype.maximizeWeightedSum=function(t,e,i,r){return k(this,t,e,i,r,!1)},t.exports=r},function(t,e,i){"use strict";i.r(e),i.d(e,"fromString",(function(){return o})),i.d(e,"add",(function(){return s})),i.d(e,"add_",(function(){return a})),i.d(e,"multiply",(function(){return l})),i.d(e,"multiply_",(function(){return u})),i.d(e,"interpolate",(function(){return h})),i.d(e,"lerp",(function(){return c})),i.d(e,"interpolateHSL",(function(){return f})),i.d(e,"lerpHSL",(function(){return d})),i.d(e,"randomize",(function(){return m})),i.d(e,"rgb2hsl",(function(){return p})),i.d(e,"hsl2rgb",(function(){return _})),i.d(e,"toRGB",(function(){return v})),i.d(e,"toHex",(function(){return b}));var r=i(1),n=i(0);function o(t){let e,i;if(t in y)e=y[t];else{if("#"==t.charAt(0)){let i=(t.match(/[0-9a-f]/gi)||[]).map(t=>parseInt(t,16));if(3==i.length)e=i.map(t=>17*t);else{for(let t=0;t<3;t++)i[t+1]+=16*i[t],i.splice(t,1);e=i}}else e=(i=t.match(/rgb\(([0-9, ]+)\)/i))?i[1].split(/\s*,\s*/).map(t=>parseInt(t)):[0,0,0];y[t]=e}return e.slice()}function s(t,...e){let i=t.slice();for(let t=0;t<3;t++)for(let r=0;r<e.length;r++)i[t]+=e[r][t];return i}function a(t,...e){for(let i=0;i<3;i++)for(let r=0;r<e.length;r++)t[i]+=e[r][i];return t}function l(t,...e){let i=t.slice();for(let t=0;t<3;t++){for(let r=0;r<e.length;r++)i[t]*=e[r][t]/255;i[t]=Math.round(i[t])}return i}function u(t,...e){for(let i=0;i<3;i++){for(let r=0;r<e.length;r++)t[i]*=e[r][i]/255;t[i]=Math.round(t[i])}return t}function h(t,e,i=.5){let r=t.slice();for(let n=0;n<3;n++)r[n]=Math.round(r[n]+i*(e[n]-t[n]));return r}const c=h;function f(t,e,i=.5){let r=p(t),n=p(e);for(let t=0;t<3;t++)r[t]+=i*(n[t]-r[t]);return _(r)}const d=f;function m(t,e){e instanceof Array||(e=Math.round(n.a.getNormal(0,e)));let i=t.slice();for(let t=0;t<3;t++)i[t]+=e instanceof Array?Math.round(n.a.getNormal(0,e[t])):e;return i}function p(t){let e,i=t[0]/255,r=t[1]/255,n=t[2]/255,o=Math.max(i,r,n),s=Math.min(i,r,n),a=0,l=(o+s)/2;if(o==s)e=0;else{let t=o-s;switch(e=l>.5?t/(2-o-s):t/(o+s),o){case i:a=(r-n)/t+(r<n?6:0);break;case r:a=(n-i)/t+2;break;case n:a=(i-r)/t+4}a/=6}return[a,e,l]}function g(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function _(t){let e=t[2];if(0==t[1])return[e=Math.round(255*e),e,e];{let i=t[1],r=e<.5?e*(1+i):e+i-e*i,n=2*e-r,o=g(n,r,t[0]+1/3),s=g(n,r,t[0]),a=g(n,r,t[0]-1/3);return[Math.round(255*o),Math.round(255*s),Math.round(255*a)]}}function v(t){return`rgb(${t.map(t=>Object(r.clamp)(t,0,255)).join(",")})`}function b(t){return`#${t.map(t=>Object(r.clamp)(t,0,255).toString(16).padStart(2,"0")).join("")}`}const y={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]}},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));class r{getContainer(){return null}setOptions(t){this._options=t}}},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return s}));var r=i(4),n=i(3);function o(t){let e=n.fromString(t);return 36*Math.floor(e[0]*(6/256))+6*Math.floor(e[1]*(6/256))+1*Math.floor(e[2]*(6/256))+16}class s extends r.a{constructor(){super(),this._offset=[0,0],this._cursor=[-1,-1],this._lastColor=""}schedule(t){setTimeout(t,1e3/60)}setOptions(t){super.setOptions(t);let e=[t.width,t.height],i=this.computeSize();this._offset=i.map((t,i)=>Math.floor((t-e[i])/2))}clear(){t.stdout.write(`[0;48;5;${o(this._options.bg)}m[2J`)}draw(e,i){let[r,n,s,a,l]=e,u=this._offset[0]+r,h=this._offset[1]+n,c=this.computeSize();if(u<0||u>=c[0])return;if(h<0||h>=c[1])return;if(u===this._cursor[0]&&h===this._cursor[1]||(t.stdout.write(function(t,e){return`[${e+1};${t+1}H`}(u,h)),this._cursor[0]=u,this._cursor[1]=h),i&&(s||(s=" ")),!s)return;let f=function(t,e){return`[0;38;5;${o(t)};48;5;${o(e)}m`}(a,l);f!==this._lastColor&&(t.stdout.write(f),this._lastColor=f);let d=[].concat(s);t.stdout.write(d[0]),this._cursor[0]++,this._cursor[0]>=c[0]&&(this._cursor[0]=0,this._cursor[1]++)}computeFontSize(){throw new Error("Terminal backend has no notion of font size")}eventToPosition(t,e){return[t,e]}computeSize(){return[t.stdout.columns,t.stdout.rows]}}}).call(this,i(8))},function(t,e,i){(function(t,i){var r;!function(){var n="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this||{},o=n._,s=Array.prototype,a=Object.prototype,l="undefined"!=typeof Symbol?Symbol.prototype:null,u=s.push,h=s.slice,c=a.toString,f=a.hasOwnProperty,d=Array.isArray,m=Object.keys,p=Object.create,g=function(){},_=function(t){return t instanceof _?t:this instanceof _?void(this._wrapped=t):new _(t)};e.nodeType?n._=_:(!i.nodeType&&i.exports&&(e=i.exports=_),e._=_),_.VERSION="1.9.1";var v,b=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,r,n){return t.call(e,i,r,n)};case 4:return function(i,r,n,o){return t.call(e,i,r,n,o)}}return function(){return t.apply(e,arguments)}},y=function(t,e,i){return _.iteratee!==v?_.iteratee(t,e):null==t?_.identity:_.isFunction(t)?b(t,e,i):_.isObject(t)&&!_.isArray(t)?_.matcher(t):_.property(t)};_.iteratee=v=function(t,e){return y(t,e,1/0)};var w=function(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),r=Array(i),n=0;n<i;n++)r[n]=arguments[n+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var o=Array(e+1);for(n=0;n<e;n++)o[n]=arguments[n];return o[e]=r,t.apply(this,o)}},E=function(t){if(!_.isObject(t))return{};if(p)return p(t);g.prototype=t;var e=new g;return g.prototype=null,e},k=function(t){return function(e){return null==e?void 0:e[t]}},S=function(t,e){return null!=t&&f.call(t,e)},M=function(t,e){for(var i=e.length,r=0;r<i;r++){if(null==t)return;t=t[e[r]]}return i?t:void 0},A=Math.pow(2,53)-1,T=k("length"),C=function(t){var e=T(t);return"number"==typeof e&&e>=0&&e<=A};_.each=_.forEach=function(t,e,i){var r,n;if(e=b(e,i),C(t))for(r=0,n=t.length;r<n;r++)e(t[r],r,t);else{var o=_.keys(t);for(r=0,n=o.length;r<n;r++)e(t[o[r]],o[r],t)}return t},_.map=_.collect=function(t,e,i){e=y(e,i);for(var r=!C(t)&&_.keys(t),n=(r||t).length,o=Array(n),s=0;s<n;s++){var a=r?r[s]:s;o[s]=e(t[a],a,t)}return o};var x=function(t){var e=function(e,i,r,n){var o=!C(e)&&_.keys(e),s=(o||e).length,a=t>0?0:s-1;for(n||(r=e[o?o[a]:a],a+=t);a>=0&&a<s;a+=t){var l=o?o[a]:a;r=i(r,e[l],l,e)}return r};return function(t,i,r,n){var o=arguments.length>=3;return e(t,b(i,n,4),r,o)}};_.reduce=_.foldl=_.inject=x(1),_.reduceRight=_.foldr=x(-1),_.find=_.detect=function(t,e,i){var r=(C(t)?_.findIndex:_.findKey)(t,e,i);if(void 0!==r&&-1!==r)return t[r]},_.filter=_.select=function(t,e,i){var r=[];return e=y(e,i),_.each(t,(function(t,i,n){e(t,i,n)&&r.push(t)})),r},_.reject=function(t,e,i){return _.filter(t,_.negate(y(e)),i)},_.every=_.all=function(t,e,i){e=y(e,i);for(var r=!C(t)&&_.keys(t),n=(r||t).length,o=0;o<n;o++){var s=r?r[o]:o;if(!e(t[s],s,t))return!1}return!0},_.some=_.any=function(t,e,i){e=y(e,i);for(var r=!C(t)&&_.keys(t),n=(r||t).length,o=0;o<n;o++){var s=r?r[o]:o;if(e(t[s],s,t))return!0}return!1},_.contains=_.includes=_.include=function(t,e,i,r){return C(t)||(t=_.values(t)),("number"!=typeof i||r)&&(i=0),_.indexOf(t,e,i)>=0},_.invoke=w((function(t,e,i){var r,n;return _.isFunction(e)?n=e:_.isArray(e)&&(r=e.slice(0,-1),e=e[e.length-1]),_.map(t,(function(t){var o=n;if(!o){if(r&&r.length&&(t=M(t,r)),null==t)return;o=t[e]}return null==o?o:o.apply(t,i)}))})),_.pluck=function(t,e){return _.map(t,_.property(e))},_.where=function(t,e){return _.filter(t,_.matcher(e))},_.findWhere=function(t,e){return _.find(t,_.matcher(e))},_.max=function(t,e,i){var r,n,o=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,l=(t=C(t)?t:_.values(t)).length;a<l;a++)null!=(r=t[a])&&r>o&&(o=r);else e=y(e,i),_.each(t,(function(t,i,r){((n=e(t,i,r))>s||n===-1/0&&o===-1/0)&&(o=t,s=n)}));return o},_.min=function(t,e,i){var r,n,o=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,l=(t=C(t)?t:_.values(t)).length;a<l;a++)null!=(r=t[a])&&r<o&&(o=r);else e=y(e,i),_.each(t,(function(t,i,r){((n=e(t,i,r))<s||n===1/0&&o===1/0)&&(o=t,s=n)}));return o},_.shuffle=function(t){return _.sample(t,1/0)},_.sample=function(t,e,i){if(null==e||i)return C(t)||(t=_.values(t)),t[_.random(t.length-1)];var r=C(t)?_.clone(t):_.values(t),n=T(r);e=Math.max(Math.min(e,n),0);for(var o=n-1,s=0;s<e;s++){var a=_.random(s,o),l=r[s];r[s]=r[a],r[a]=l}return r.slice(0,e)},_.sortBy=function(t,e,i){var r=0;return e=y(e,i),_.pluck(_.map(t,(function(t,i,n){return{value:t,index:r++,criteria:e(t,i,n)}})).sort((function(t,e){var i=t.criteria,r=e.criteria;if(i!==r){if(i>r||void 0===i)return 1;if(i<r||void 0===r)return-1}return t.index-e.index})),"value")};var R=function(t,e){return function(i,r,n){var o=e?[[],[]]:{};return r=y(r,n),_.each(i,(function(e,n){var s=r(e,n,i);t(o,e,s)})),o}};_.groupBy=R((function(t,e,i){S(t,i)?t[i].push(e):t[i]=[e]})),_.indexBy=R((function(t,e,i){t[i]=e})),_.countBy=R((function(t,e,i){S(t,i)?t[i]++:t[i]=1}));var O=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;_.toArray=function(t){return t?_.isArray(t)?h.call(t):_.isString(t)?t.match(O):C(t)?_.map(t,_.identity):_.values(t):[]},_.size=function(t){return null==t?0:C(t)?t.length:_.keys(t).length},_.partition=R((function(t,e,i){t[i?0:1].push(e)}),!0),_.first=_.head=_.take=function(t,e,i){return null==t||t.length<1?null==e?void 0:[]:null==e||i?t[0]:_.initial(t,t.length-e)},_.initial=function(t,e,i){return h.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},_.last=function(t,e,i){return null==t||t.length<1?null==e?void 0:[]:null==e||i?t[t.length-1]:_.rest(t,Math.max(0,t.length-e))},_.rest=_.tail=_.drop=function(t,e,i){return h.call(t,null==e||i?1:e)},_.compact=function(t){return _.filter(t,Boolean)};var L=function(t,e,i,r){for(var n=(r=r||[]).length,o=0,s=T(t);o<s;o++){var a=t[o];if(C(a)&&(_.isArray(a)||_.isArguments(a)))if(e)for(var l=0,u=a.length;l<u;)r[n++]=a[l++];else L(a,e,i,r),n=r.length;else i||(r[n++]=a)}return r};_.flatten=function(t,e){return L(t,e,!1)},_.without=w((function(t,e){return _.difference(t,e)})),_.uniq=_.unique=function(t,e,i,r){_.isBoolean(e)||(r=i,i=e,e=!1),null!=i&&(i=y(i,r));for(var n=[],o=[],s=0,a=T(t);s<a;s++){var l=t[s],u=i?i(l,s,t):l;e&&!i?(s&&o===u||n.push(l),o=u):i?_.contains(o,u)||(o.push(u),n.push(l)):_.contains(n,l)||n.push(l)}return n},_.union=w((function(t){return _.uniq(L(t,!0,!0))})),_.intersection=function(t){for(var e=[],i=arguments.length,r=0,n=T(t);r<n;r++){var o=t[r];if(!_.contains(e,o)){var s;for(s=1;s<i&&_.contains(arguments[s],o);s++);s===i&&e.push(o)}}return e},_.difference=w((function(t,e){return e=L(e,!0,!0),_.filter(t,(function(t){return!_.contains(e,t)}))})),_.unzip=function(t){for(var e=t&&_.max(t,T).length||0,i=Array(e),r=0;r<e;r++)i[r]=_.pluck(t,r);return i},_.zip=w(_.unzip),_.object=function(t,e){for(var i={},r=0,n=T(t);r<n;r++)e?i[t[r]]=e[r]:i[t[r][0]]=t[r][1];return i};var P=function(t){return function(e,i,r){i=y(i,r);for(var n=T(e),o=t>0?0:n-1;o>=0&&o<n;o+=t)if(i(e[o],o,e))return o;return-1}};_.findIndex=P(1),_.findLastIndex=P(-1),_.sortedIndex=function(t,e,i,r){for(var n=(i=y(i,r,1))(e),o=0,s=T(t);o<s;){var a=Math.floor((o+s)/2);i(t[a])<n?o=a+1:s=a}return o};var N=function(t,e,i){return function(r,n,o){var s=0,a=T(r);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(i&&o&&a)return r[o=i(r,n)]===n?o:-1;if(n!=n)return(o=e(h.call(r,s,a),_.isNaN))>=0?o+s:-1;for(o=t>0?s:a-1;o>=0&&o<a;o+=t)if(r[o]===n)return o;return-1}};_.indexOf=N(1,_.findIndex,_.sortedIndex),_.lastIndexOf=N(-1,_.findLastIndex),_.range=function(t,e,i){null==e&&(e=t||0,t=0),i||(i=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/i),0),n=Array(r),o=0;o<r;o++,t+=i)n[o]=t;return n},_.chunk=function(t,e){if(null==e||e<1)return[];for(var i=[],r=0,n=t.length;r<n;)i.push(h.call(t,r,r+=e));return i};var I=function(t,e,i,r,n){if(!(r instanceof e))return t.apply(i,n);var o=E(t.prototype),s=t.apply(o,n);return _.isObject(s)?s:o};_.bind=w((function(t,e,i){if(!_.isFunction(t))throw new TypeError("Bind must be called on a function");var r=w((function(n){return I(t,r,e,this,i.concat(n))}));return r})),_.partial=w((function(t,e){var i=_.partial.placeholder,r=function(){for(var n=0,o=e.length,s=Array(o),a=0;a<o;a++)s[a]=e[a]===i?arguments[n++]:e[a];for(;n<arguments.length;)s.push(arguments[n++]);return I(t,r,this,this,s)};return r})),_.partial.placeholder=_,_.bindAll=w((function(t,e){var i=(e=L(e,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var r=e[i];t[r]=_.bind(t[r],t)}})),_.memoize=function(t,e){var i=function(r){var n=i.cache,o=""+(e?e.apply(this,arguments):r);return S(n,o)||(n[o]=t.apply(this,arguments)),n[o]};return i.cache={},i},_.delay=w((function(t,e,i){return setTimeout((function(){return t.apply(null,i)}),e)})),_.defer=_.partial(_.delay,_,1),_.throttle=function(t,e,i){var r,n,o,s,a=0;i||(i={});var l=function(){a=!1===i.leading?0:_.now(),r=null,s=t.apply(n,o),r||(n=o=null)},u=function(){var u=_.now();a||!1!==i.leading||(a=u);var h=e-(u-a);return n=this,o=arguments,h<=0||h>e?(r&&(clearTimeout(r),r=null),a=u,s=t.apply(n,o),r||(n=o=null)):r||!1===i.trailing||(r=setTimeout(l,h)),s};return u.cancel=function(){clearTimeout(r),a=0,r=n=o=null},u},_.debounce=function(t,e,i){var r,n,o=function(e,i){r=null,i&&(n=t.apply(e,i))},s=w((function(s){if(r&&clearTimeout(r),i){var a=!r;r=setTimeout(o,e),a&&(n=t.apply(this,s))}else r=_.delay(o,e,this,s);return n}));return s.cancel=function(){clearTimeout(r),r=null},s},_.wrap=function(t,e){return _.partial(e,t)},_.negate=function(t){return function(){return!t.apply(this,arguments)}},_.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,r=t[e].apply(this,arguments);i--;)r=t[i].call(this,r);return r}},_.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},_.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},_.once=_.partial(_.before,2),_.restArguments=w;var F=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],V=function(t,e){var i=D.length,r=t.constructor,n=_.isFunction(r)&&r.prototype||a,o="constructor";for(S(t,o)&&!_.contains(e,o)&&e.push(o);i--;)(o=D[i])in t&&t[o]!==n[o]&&!_.contains(e,o)&&e.push(o)};_.keys=function(t){if(!_.isObject(t))return[];if(m)return m(t);var e=[];for(var i in t)S(t,i)&&e.push(i);return F&&V(t,e),e},_.allKeys=function(t){if(!_.isObject(t))return[];var e=[];for(var i in t)e.push(i);return F&&V(t,e),e},_.values=function(t){for(var e=_.keys(t),i=e.length,r=Array(i),n=0;n<i;n++)r[n]=t[e[n]];return r},_.mapObject=function(t,e,i){e=y(e,i);for(var r=_.keys(t),n=r.length,o={},s=0;s<n;s++){var a=r[s];o[a]=e(t[a],a,t)}return o},_.pairs=function(t){for(var e=_.keys(t),i=e.length,r=Array(i),n=0;n<i;n++)r[n]=[e[n],t[e[n]]];return r},_.invert=function(t){for(var e={},i=_.keys(t),r=0,n=i.length;r<n;r++)e[t[i[r]]]=i[r];return e},_.functions=_.methods=function(t){var e=[];for(var i in t)_.isFunction(t[i])&&e.push(i);return e.sort()};var B=function(t,e){return function(i){var r=arguments.length;if(e&&(i=Object(i)),r<2||null==i)return i;for(var n=1;n<r;n++)for(var o=arguments[n],s=t(o),a=s.length,l=0;l<a;l++){var u=s[l];e&&void 0!==i[u]||(i[u]=o[u])}return i}};_.extend=B(_.allKeys),_.extendOwn=_.assign=B(_.keys),_.findKey=function(t,e,i){e=y(e,i);for(var r,n=_.keys(t),o=0,s=n.length;o<s;o++)if(e(t[r=n[o]],r,t))return r};var U,K,H=function(t,e,i){return e in i};_.pick=w((function(t,e){var i={},r=e[0];if(null==t)return i;_.isFunction(r)?(e.length>1&&(r=b(r,e[1])),e=_.allKeys(t)):(r=H,e=L(e,!1,!1),t=Object(t));for(var n=0,o=e.length;n<o;n++){var s=e[n],a=t[s];r(a,s,t)&&(i[s]=a)}return i})),_.omit=w((function(t,e){var i,r=e[0];return _.isFunction(r)?(r=_.negate(r),e.length>1&&(i=e[1])):(e=_.map(L(e,!1,!1),String),r=function(t,i){return!_.contains(e,i)}),_.pick(t,r,i)})),_.defaults=B(_.allKeys,!0),_.create=function(t,e){var i=E(t);return e&&_.extendOwn(i,e),i},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend({},t):t},_.tap=function(t,e){return e(t),t},_.isMatch=function(t,e){var i=_.keys(e),r=i.length;if(null==t)return!r;for(var n=Object(t),o=0;o<r;o++){var s=i[o];if(e[s]!==n[s]||!(s in n))return!1}return!0},U=function(t,e,i,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var n=typeof t;return("function"===n||"object"===n||"object"==typeof e)&&K(t,e,i,r)},K=function(t,e,i,r){t instanceof _&&(t=t._wrapped),e instanceof _&&(e=e._wrapped);var n=c.call(t);if(n!==c.call(e))return!1;switch(n){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return l.valueOf.call(t)===l.valueOf.call(e)}var o="[object Array]"===n;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(_.isFunction(s)&&s instanceof s&&_.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var u=(i=i||[]).length;u--;)if(i[u]===t)return r[u]===e;if(i.push(t),r.push(e),o){if((u=t.length)!==e.length)return!1;for(;u--;)if(!U(t[u],e[u],i,r))return!1}else{var h,f=_.keys(t);if(u=f.length,_.keys(e).length!==u)return!1;for(;u--;)if(h=f[u],!S(e,h)||!U(t[h],e[h],i,r))return!1}return i.pop(),r.pop(),!0},_.isEqual=function(t,e){return U(t,e)},_.isEmpty=function(t){return null==t||(C(t)&&(_.isArray(t)||_.isString(t)||_.isArguments(t))?0===t.length:0===_.keys(t).length)},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=d||function(t){return"[object Array]"===c.call(t)},_.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},_.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],(function(t){_["is"+t]=function(e){return c.call(e)==="[object "+t+"]"}})),_.isArguments(arguments)||(_.isArguments=function(t){return S(t,"callee")});var W=n.document&&n.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof W&&(_.isFunction=function(t){return"function"==typeof t||!1}),_.isFinite=function(t){return!_.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&isNaN(t)},_.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===c.call(t)},_.isNull=function(t){return null===t},_.isUndefined=function(t){return void 0===t},_.has=function(t,e){if(!_.isArray(e))return S(t,e);for(var i=e.length,r=0;r<i;r++){var n=e[r];if(null==t||!f.call(t,n))return!1;t=t[n]}return!!i},_.noConflict=function(){return n._=o,this},_.identity=function(t){return t},_.constant=function(t){return function(){return t}},_.noop=function(){},_.property=function(t){return _.isArray(t)?function(e){return M(e,t)}:k(t)},_.propertyOf=function(t){return null==t?function(){}:function(e){return _.isArray(e)?M(t,e):t[e]}},_.matcher=_.matches=function(t){return t=_.extendOwn({},t),function(e){return _.isMatch(e,t)}},_.times=function(t,e,i){var r=Array(Math.max(0,t));e=b(e,i,1);for(var n=0;n<t;n++)r[n]=e(n);return r},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.now=Date.now||function(){return(new Date).getTime()};var z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},q=_.invert(z),j=function(t){var e=function(e){return t[e]},i="(?:"+_.keys(t).join("|")+")",r=RegExp(i),n=RegExp(i,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(n,e):t}};_.escape=j(z),_.unescape=j(q),_.result=function(t,e,i){_.isArray(e)||(e=[e]);var r=e.length;if(!r)return _.isFunction(i)?i.call(t):i;for(var n=0;n<r;n++){var o=null==t?void 0:t[e[n]];void 0===o&&(o=i,n=r),t=_.isFunction(o)?o.call(t):o}return t};var X=0;_.uniqueId=function(t){var e=++X+"";return t?t+e:e},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Y=/(.)^/,$={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},G=/\\|'|\r|\n|\u2028|\u2029/g,Z=function(t){return"\\"+$[t]};_.template=function(t,e,i){!e&&i&&(e=i),e=_.defaults({},e,_.templateSettings);var r,n=RegExp([(e.escape||Y).source,(e.interpolate||Y).source,(e.evaluate||Y).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(n,(function(e,i,r,n,a){return s+=t.slice(o,a).replace(G,Z),o=a+e.length,i?s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":n&&(s+="';\n"+n+"\n__p+='"),e})),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}var a=function(t){return r.call(this,t,_)},l=e.variable||"obj";return a.source="function("+l+"){\n"+s+"}",a},_.chain=function(t){var e=_(t);return e._chain=!0,e};var J=function(t,e){return t._chain?_(e).chain():e};_.mixin=function(t){return _.each(_.functions(t),(function(e){var i=_[e]=t[e];_.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),J(this,i.apply(_,t))}})),_},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=s[t];_.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],J(this,i)}})),_.each(["concat","join","slice"],(function(t){var e=s[t];_.prototype[t]=function(){return J(this,e.apply(this._wrapped,arguments))}})),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return String(this._wrapped)},void 0===(r=function(){return _}.apply(e,[]))||(i.exports=r)}()}).call(this,i(12),i(13)(t))},function(t,e,i){"use strict";var r=i(9),n=function(){var t=4022871197;return function(e){if(e){e=e.toString();for(var i=0;i<e.length;i++){var r=.02519603282416938*(t+=e.charCodeAt(i));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}t=4022871197}},o=function(t){return function(){var e,i,o=48,s=1,a=o,l=new Array(o),u=0,h=new n;for(e=0;e<o;e++)l[e]=h(Math.random());var c=function(){++a>=o&&(a=0);var t=1768863*l[a]+2.3283064365386963e-10*s;return l[a]=t-(s=0|t)},f=function(t){return Math.floor(t*(c()+11102230246251565e-32*(2097152*c()|0)))};f.string=function(t){var e,i="";for(e=0;e<t;e++)i+=String.fromCharCode(33+f(94));return i};var d=function(){var t=Array.prototype.slice.call(arguments);for(e=0;e<t.length;e++)for(i=0;i<o;i++)l[i]-=h(t[e]),l[i]<0&&(l[i]+=1)};return f.cleanString=function(t){return t=(t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[\x00-\x1F]/gi,"")).replace(/\n /,"\n")},f.hashString=function(t){for(t=f.cleanString(t),h(t),e=0;e<t.length;e++)for(u=t.charCodeAt(e),i=0;i<o;i++)l[i]-=h(u),l[i]<0&&(l[i]+=1)},f.seed=function(t){null==t&&(t=Math.random()),"string"!=typeof t&&(t=r(t,(function(t,e){return"function"==typeof e?e.toString():e}))),f.initState(),f.hashString(t)},f.addEntropy=function(){var t=[];for(e=0;e<arguments.length;e++)t.push(arguments[e]);d(u+++(new Date).getTime()+t.join("")+Math.random())},f.initState=function(){for(h(),e=0;e<o;e++)l[e]=h(" ");s=1,a=o},f.done=function(){h=null},void 0!==t&&f.seed(t),f.range=function(t){return f(t)},f.random=function(){return f(Number.MAX_VALUE-1)/Number.MAX_VALUE},f.floatBetween=function(t,e){return f.random()*(e-t)+t},f.intBetween=function(t,e){return Math.floor(f.random()*(e-t+1))+t},f}()};o.create=function(t){return new o(t)},t.exports=o},function(t,e){var i,r,n=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var l,u=[],h=!1,c=-1;function f(){h&&l&&(h=!1,l.length?u=l.concat(u):c=-1,u.length&&d())}function d(){if(!h){var t=a(f);h=!0;for(var e=u.length;e;){for(l=u,u=[];++c<e;)l&&l[c].run();c=-1,e=u.length}l=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new m(t,e)),1!==u.length||h||a(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e){function i(t,e){var i=[],r=[];return null==e&&(e=function(t,e){return i[0]===e?"[Circular ~]":"[Circular ~."+r.slice(0,i.indexOf(e)).join(".")+"]"}),function(n,o){if(i.length>0){var s=i.indexOf(this);~s?i.splice(s+1):i.push(this),~s?r.splice(s,1/0,n):r.push(n),~i.indexOf(o)&&(o=e.call(this,n,o))}else i.push(o);return null==t?o:t.call(this,n,o)}}(t.exports=function(t,e,r,n){return JSON.stringify(t,i(e,n),r)}).getSerialize=i},function(t,e,i){var r,n=i(11),o=i(6);(r=function(){var t=this._C=n();this._native={getStackPointer:function(){return t.Runtime.stackSave()},setStackPointer:function(e){t.Runtime.stackRestore(e)},allocateBytes:function(e){return t.allocate(e,"i8",t.ALLOC_STACK)},pushString:function(e){return this.allocateBytes(t.intArrayFromString(e))},savingStack:function(e){var i=this.getStackPointer();try{return e(this,t)}finally{this.setStackPointer(i)}}},t._createTheSolver(),this._clauses=[]}).prototype.ensureVar=function(t){this._C._ensureVar(t)},r.prototype.addClause=function(t){return this._clauses.push(t),this._native.savingStack((function(e,i){var r=i.allocate(4*(t.length+1),"i32",i.ALLOC_STACK);return o.each(t,(function(t,e){i.setValue(r+4*e,t,"i32")})),i.setValue(r+4*t.length,0,"i32"),!!i._addClause(r)}))},r.prototype.solve=function(){return!!this._C._solve()},r.prototype.solveAssuming=function(t){return!!this._C._solveAssuming(t)},r.prototype.getSolution=function(){for(var t=[null],e=this._C,i=e._getNumVars(),r=e._getSolution(),n=0;n<i;n++)t[n+1]=0===e.getValue(r+n,"i8");return t},r.prototype.retireVar=function(t){this._C._retireVar(t)},r.prototype.getConflictClause=function(){for(var t=this._C,e=t._getConflictClauseSize(),i=t._getConflictClause(),r=[],n=0;n<e;n++){var o=t.getValue(i+4*n,"i32"),s=o>>>1,a=1&o?-1:1;r[n]=s*a}return r},t.exports=r},function(module,exports,__webpack_require__){(function(__dirname){var C_MINISAT;C_MINISAT=function(){var module={},require=function(){},process={argv:["node","minisat"],on:function(){},stdout:{write:function(t){console.log("MINISAT-out:",t.replace(/\n$/,""))}},stderr:{write:function(t){console.log("MINISAT-err:",t.replace(/\n$/,""))}}},window=0,Module;Module||(Module=(void 0!==Module?Module:null)||{});var moduleOverrides={};for(var key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);var ENVIRONMENT_IS_NODE="object"==typeof process&&"function"==typeof require,ENVIRONMENT_IS_WEB="object"==typeof window,ENVIRONMENT_IS_WORKER="function"==typeof importScripts,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE){Module.print||(Module.print=function(t){process.stdout.write(t+"\n")}),Module.printErr||(Module.printErr=function(t){process.stderr.write(t+"\n")});var nodeFS=require("fs"),nodePath=require("path");Module.read=function(t,e){t=nodePath.normalize(t);var i=nodeFS.readFileSync(t);return i||t==nodePath.resolve(t)||(t=path.join(__dirname,"..","src",t),i=nodeFS.readFileSync(t)),i&&!e&&(i=i.toString()),i},Module.readBinary=function(t){return Module.read(t,!0)},Module.load=function(t){globalEval(read(t))},process.argv.length>1?Module.thisProgram=process.argv[1].replace(/\\/g,"/"):Module.thisProgram="unknown-program",Module.arguments=process.argv.slice(2),void 0!==module&&(module.exports=Module),process.on("uncaughtException",(function(t){if(!(t instanceof ExitStatus))throw t}))}else if(ENVIRONMENT_IS_SHELL)Module.print||(Module.print=print),"undefined"!=typeof printErr&&(Module.printErr=printErr),"undefined"!=typeof read?Module.read=read:Module.read=function(){throw"no read() available (jsc?)"},Module.readBinary=function(t){if("function"==typeof readbuffer)return new Uint8Array(readbuffer(t));var e=read(t,"binary");return assert("object"==typeof e),e},"undefined"!=typeof scriptArgs?Module.arguments=scriptArgs:void 0!==arguments&&(Module.arguments=arguments),this.Module=Module;else{if(!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER)throw"Unknown runtime environment. Where are we?";if(Module.read=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},void 0!==arguments&&(Module.arguments=arguments),"undefined"!=typeof console)Module.print||(Module.print=function(t){console.log(t)}),Module.printErr||(Module.printErr=function(t){console.log(t)});else{var TRY_USE_DUMP=!1;Module.print||(Module.print=TRY_USE_DUMP&&"undefined"!=typeof dump?function(t){dump(t)}:function(t){})}ENVIRONMENT_IS_WEB?window.Module=Module:Module.load=importScripts}function globalEval(t){eval.call(null,t)}for(var key in!Module.load&&Module.read&&(Module.load=function(t){globalEval(Module.read(t))}),Module.print||(Module.print=function(){}),Module.printErr||(Module.printErr=Module.print),Module.arguments||(Module.arguments=[]),Module.thisProgram||(Module.thisProgram="./this.program"),Module.print=Module.print,Module.printErr=Module.printErr,Module.preRun=[],Module.postRun=[],moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);var Runtime={setTempRet0:function(t){tempRet0=t},getTempRet0:function(){return tempRet0},stackSave:function(){return STACKTOP},stackRestore:function(t){STACKTOP=t},getNativeTypeSize:function(t){switch(t){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===t[t.length-1])return Runtime.QUANTUM_SIZE;if("i"===t[0]){var e=parseInt(t.substr(1));return assert(e%8==0),e/8}return 0}},getNativeFieldSize:function(t){return Math.max(Runtime.getNativeTypeSize(t),Runtime.QUANTUM_SIZE)},STACK_ALIGN:16,getAlignSize:function(t,e,i){return i||"i64"!=t&&"double"!=t?t?Math.min(e||(t?Runtime.getNativeFieldSize(t):0),Runtime.QUANTUM_SIZE):Math.min(e,8):8},dynCall:function(t,e,i){return i&&i.length?(i.splice||(i=Array.prototype.slice.call(i)),i.splice(0,0,e),Module["dynCall_"+t].apply(null,i)):Module["dynCall_"+t].call(null,e)},functionPointers:[],addFunction:function(t){for(var e=0;e<Runtime.functionPointers.length;e++)if(!Runtime.functionPointers[e])return Runtime.functionPointers[e]=t,2*(1+e);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(t){Runtime.functionPointers[(t-2)/2]=null},getAsmConst:function(code,numArgs){Runtime.asmConstCache||(Runtime.asmConstCache={});var func=Runtime.asmConstCache[code];if(func)return func;for(var args=[],i=0;i<numArgs;i++)args.push(String.fromCharCode(36)+i);var source=Pointer_stringify(code);'"'===source[0]&&(source.indexOf('"',1)===source.length-1?source=source.substr(1,source.length-2):abort("invalid EM_ASM input |"+source+"|. Please use EM_ASM(..code..) (no quotes) or EM_ASM({ ..code($0).. }, input) (to input values)"));try{var evalled=eval("(function(Module, FS) { return function("+args.join(",")+"){ "+source+" } })")(Module,void 0!==FS?FS:null)}catch(t){throw Module.printErr("error in executing inline EM_ASM code: "+t+" on: \n\n"+source+"\n\nwith args |"+args+"| (make sure to use the right one out of EM_ASM, EM_ASM_ARGS, etc.)"),t}return Runtime.asmConstCache[code]=evalled},warnOnce:function(t){Runtime.warnOnce.shown||(Runtime.warnOnce.shown={}),Runtime.warnOnce.shown[t]||(Runtime.warnOnce.shown[t]=1,Module.printErr(t))},funcWrappers:{},getFuncWrapper:function(t,e){assert(e),Runtime.funcWrappers[e]||(Runtime.funcWrappers[e]={});var i=Runtime.funcWrappers[e];return i[t]||(i[t]=function(){return Runtime.dynCall(e,t,arguments)}),i[t]},UTF8Processor:function(){var t=[],e=0;this.processCChar=function(i){if(i&=255,0==t.length)return 0==(128&i)?String.fromCharCode(i):(t.push(i),e=192==(224&i)?1:224==(240&i)?2:3,"");if(e&&(t.push(i),--e>0))return"";var r,n=t[0],o=t[1],s=t[2],a=t[3];if(2==t.length)r=String.fromCharCode((31&n)<<6|63&o);else if(3==t.length)r=String.fromCharCode((15&n)<<12|(63&o)<<6|63&s);else{var l=(7&n)<<18|(63&o)<<12|(63&s)<<6|63&a;r=String.fromCharCode(55296+((l-65536)/1024|0),(l-65536)%1024+56320)}return t.length=0,r},this.processJSString=function(t){t=unescape(encodeURIComponent(t));for(var e=[],i=0;i<t.length;i++)e.push(t.charCodeAt(i));return e}},getCompilerSetting:function(t){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(t){var e=STACKTOP;return STACKTOP=(STACKTOP=STACKTOP+t|0)+15&-16,e},staticAlloc:function(t){var e=STATICTOP;return STATICTOP=(STATICTOP=STATICTOP+t|0)+15&-16,e},dynamicAlloc:function(t){var e=DYNAMICTOP;return(DYNAMICTOP=(DYNAMICTOP=DYNAMICTOP+t|0)+15&-16)>=TOTAL_MEMORY&&enlargeMemory(),e},alignMemory:function(t,e){return t=Math.ceil(t/(e||16))*(e||16)},makeBigInt:function(t,e,i){return i?+(t>>>0)+4294967296*+(e>>>0):+(t>>>0)+4294967296*+(0|e)},GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};Module.Runtime=Runtime;var __THREW__=0,ABORT=!1,EXITSTATUS=0,undef=0,tempValue,tempInt,tempBigInt,tempInt2,tempBigInt2,tempPair,tempBigIntI,tempBigIntR,tempBigIntS,tempBigIntP,tempBigIntD,tempDouble,tempFloat,tempI64,tempI64b,tempRet0,tempRet1,tempRet2,tempRet3,tempRet4,tempRet5,tempRet6,tempRet7,tempRet8,tempRet9;function assert(t,e){t||abort("Assertion failed: "+e)}var globalScope=this,cwrap,ccall;function getCFunc(ident){var func=Module["_"+ident];if(!func)try{func=eval("_"+ident)}catch(t){}return assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)"),func}function setValue(t,e,i,r){switch("*"===(i=i||"i8").charAt(i.length-1)&&(i="i32"),i){case"i1":case"i8":HEAP8[t>>0]=e;break;case"i16":HEAP16[t>>1]=e;break;case"i32":HEAP32[t>>2]=e;break;case"i64":tempI64=[e>>>0,(tempDouble=e,+Math_abs(tempDouble)>=1?tempDouble>0?(0|Math_min(+Math_floor(tempDouble/4294967296),4294967295))>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[t>>2]=tempI64[0],HEAP32[t+4>>2]=tempI64[1];break;case"float":HEAPF32[t>>2]=e;break;case"double":HEAPF64[t>>3]=e;break;default:abort("invalid type for setValue: "+i)}}function getValue(t,e,i){switch("*"===(e=e||"i8").charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return HEAP8[t>>0];case"i16":return HEAP16[t>>1];case"i32":case"i64":return HEAP32[t>>2];case"float":return HEAPF32[t>>2];case"double":return HEAPF64[t>>3];default:abort("invalid type for setValue: "+e)}return null}!function(){var JSfuncs={stackSave:function(){Runtime.stackSave()},stackRestore:function(){Runtime.stackRestore()},arrayToC:function(t){var e=Runtime.stackAlloc(t.length);return writeArrayToMemory(t,e),e},stringToC:function(t){var e=0;return null!=t&&0!==t&&writeStringToMemory(t,e=Runtime.stackAlloc(1+(t.length<<2))),e}},toC={string:JSfuncs.stringToC,array:JSfuncs.arrayToC};ccall=function(t,e,i,r){var n=getCFunc(t),o=[],s=0;if(r)for(var a=0;a<r.length;a++){var l=toC[i[a]];l?(0===s&&(s=Runtime.stackSave()),o[a]=l(r[a])):o[a]=r[a]}var u=n.apply(null,o);return"string"===e&&(u=Pointer_stringify(u)),0!==s&&Runtime.stackRestore(s),u};var sourceRegex=/^function\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/;function parseJSFunc(t){var e=t.toString().match(sourceRegex).slice(1);return{arguments:e[0],body:e[1],returnValue:e[2]}}var JSsource={};for(var fun in JSfuncs)JSfuncs.hasOwnProperty(fun)&&(JSsource[fun]=parseJSFunc(JSfuncs[fun]));cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident),numericArgs=argTypes.every((function(t){return"number"===t})),numericRet="string"!==returnType;if(numericRet&&numericArgs)return cfunc;var argNames=argTypes.map((function(t,e){return"$"+e})),funcstr="(function("+argNames.join(",")+") {",nargs=argTypes.length;if(!numericArgs){funcstr+="var stack = "+JSsource.stackSave.body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if("number"!==type){var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";",funcstr+=convertCode.body+";",funcstr+=arg+"="+convertCode.returnValue+";"}}}var cfuncname=parseJSFunc((function(){return cfunc})).returnValue;if(funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");",!numericRet){var strgfy=parseJSFunc((function(){return Pointer_stringify})).returnValue;funcstr+="ret = "+strgfy+"(ret);"}return numericArgs||(funcstr+=JSsource.stackRestore.body.replace("()","(stack)")+";"),funcstr+="return ret})",eval(funcstr)}}(),Module.cwrap=cwrap,Module.ccall=ccall,Module.setValue=setValue,Module.getValue=getValue;var ALLOC_NORMAL=0,ALLOC_STACK=1,ALLOC_STATIC=2,ALLOC_DYNAMIC=3,ALLOC_NONE=4;function allocate(t,e,i,r){var n,o;"number"==typeof t?(n=!0,o=t):(n=!1,o=t.length);var s,a="string"==typeof e?e:null;if(s=i==ALLOC_NONE?r:[_malloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][void 0===i?ALLOC_STATIC:i](Math.max(o,a?1:e.length)),n){var l;r=s;for(assert(0==(3&s)),l=s+(-4&o);r<l;r+=4)HEAP32[r>>2]=0;for(l=s+o;r<l;)HEAP8[r++>>0]=0;return s}if("i8"===a)return t.subarray||t.slice?HEAPU8.set(t,s):HEAPU8.set(new Uint8Array(t),s),s;for(var u,h,c,f=0;f<o;){var d=t[f];"function"==typeof d&&(d=Runtime.getFunctionIndex(d)),0!==(u=a||e[f])?("i64"==u&&(u="i32"),setValue(s+f,d,u),c!==u&&(h=Runtime.getNativeTypeSize(u),c=u),f+=h):f++}return s}function Pointer_stringify(t,e){if(0===e||!t)return"";for(var i,r=!1,n=0;;){if((i=HEAPU8[t+n>>0])>=128)r=!0;else if(0==i&&!e)break;if(n++,e&&n==e)break}e||(e=n);var o="";if(!r){for(var s;e>0;)s=String.fromCharCode.apply(String,HEAPU8.subarray(t,t+Math.min(e,1024))),o=o?o+s:s,t+=1024,e-=1024;return o}var a=new Runtime.UTF8Processor;for(n=0;n<e;n++)i=HEAPU8[t+n>>0],o+=a.processCChar(i);return o}function UTF16ToString(t){for(var e=0,i="";;){var r=HEAP16[t+2*e>>1];if(0==r)return i;++e,i+=String.fromCharCode(r)}}function stringToUTF16(t,e){for(var i=0;i<t.length;++i){var r=t.charCodeAt(i);HEAP16[e+2*i>>1]=r}HEAP16[e+2*t.length>>1]=0}function UTF32ToString(t){for(var e=0,i="";;){var r=HEAP32[t+4*e>>2];if(0==r)return i;if(++e,r>=65536){var n=r-65536;i+=String.fromCharCode(55296|n>>10,56320|1023&n)}else i+=String.fromCharCode(r)}}function stringToUTF32(t,e){for(var i=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);if(n>=55296&&n<=57343)n=65536+((1023&n)<<10)|1023&t.charCodeAt(++r);HEAP32[e+4*i>>2]=n,++i}HEAP32[e+4*i>>2]=0}function demangle(t){var e=!!Module.___cxa_demangle;if(e)try{var i=_malloc(t.length);writeStringToMemory(t.substr(1),i);var r=_malloc(4),n=Module.___cxa_demangle(i,0,0,r);if(0===getValue(r,"i32")&&n)return Pointer_stringify(n)}catch(t){}finally{i&&_free(i),r&&_free(r),n&&_free(n)}var o=3,s={v:"void",b:"bool",c:"char",s:"short",i:"int",l:"long",f:"float",d:"double",w:"wchar_t",a:"signed char",h:"unsigned char",t:"unsigned short",j:"unsigned int",m:"unsigned long",x:"long long",y:"unsigned long long",z:"..."},a=[],l=!0;var u=t;try{if("Object._main"==t||"_main"==t)return"main()";if("number"==typeof t&&(t=Pointer_stringify(t)),"_"!==t[0])return t;if("_"!==t[1])return t;if("Z"!==t[2])return t;switch(t[3]){case"n":return"operator new()";case"d":return"operator delete()"}u=function e(i,r,n){r=r||1/0;var u,h="",c=[];if("N"===t[o]){if(u=function(){"K"===t[++o]&&o++;for(var e=[];"E"!==t[o];)if("S"!==t[o])if("C"!==t[o]){var i=parseInt(t.substr(o)),r=i.toString().length;if(!i||!r){o--;break}var n=t.substr(o+r,i);e.push(n),a.push(n),o+=r+i}else e.push(e[e.length-1]),o+=2;else{o++;var s=t.indexOf("_",o),l=t.substring(o,s)||0;e.push(a[l]||"?"),o=s+1}return o++,e}().join("::"),0===--r)return i?[u]:u}else if(("K"===t[o]||l&&"L"===t[o])&&o++,p=parseInt(t.substr(o))){var f=p.toString().length;u=t.substr(o+f,p),o+=f+p}if(l=!1,"I"===t[o]){o++;var d=e(!0);h+=e(!0,1,!0)[0]+" "+u+"<"+d.join(", ")+">"}else h=u;t:for(;o<t.length&&r-- >0;){var m=t[o++];if(m in s)c.push(s[m]);else switch(m){case"P":c.push(e(!0,1,!0)[0]+"*");break;case"R":c.push(e(!0,1,!0)[0]+"&");break;case"L":o++;var p=t.indexOf("E",o)-o;c.push(t.substr(o,p)),o+=p+2;break;case"A":p=parseInt(t.substr(o));if(o+=p.toString().length,"_"!==t[o])throw"?";o++,c.push(e(!0,1,!0)[0]+" ["+p+"]");break;case"E":break t;default:h+="?"+m;break t}}return n||1!==c.length||"void"!==c[0]||(c=[]),i?(h&&c.push(h+"?"),c):h+"("+c.join(", ")+")"}()}catch(t){u+="?"}return u.indexOf("?")>=0&&!e&&Runtime.warnOnce("warning: a problem occurred in builtin C++ name demangling; build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),u}function demangleAll(t){return t.replace(/__Z[\w\d_]+/g,(function(t){var e=demangle(t);return t===e?t:t+" ["+e+"]"}))}function jsStackTrace(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}function stackTrace(){return demangleAll(jsStackTrace())}Module.ALLOC_NORMAL=ALLOC_NORMAL,Module.ALLOC_STACK=ALLOC_STACK,Module.ALLOC_STATIC=ALLOC_STATIC,Module.ALLOC_DYNAMIC=ALLOC_DYNAMIC,Module.ALLOC_NONE=ALLOC_NONE,Module.allocate=allocate,Module.Pointer_stringify=Pointer_stringify,Module.UTF16ToString=UTF16ToString,Module.stringToUTF16=stringToUTF16,Module.UTF32ToString=UTF32ToString,Module.stringToUTF32=stringToUTF32,Module.stackTrace=stackTrace;var PAGE_SIZE=4096,HEAP,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function alignMemoryPage(t){return t+4095&-4096}var STATIC_BASE=0,STATICTOP=0,staticSealed=!1,STACK_BASE=0,STACKTOP=0,STACK_MAX=0,DYNAMIC_BASE=0,DYNAMICTOP=0;function enlargeMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with -s TOTAL_MEMORY=X with X higher than the current value "+TOTAL_MEMORY+", (2) compile with ALLOW_MEMORY_GROWTH which adjusts the size at runtime but prevents some optimizations, or (3) set Module.TOTAL_MEMORY before the program runs.")}for(var TOTAL_STACK=Module.TOTAL_STACK||5242880,TOTAL_MEMORY=Module.TOTAL_MEMORY||67108864,FAST_MEMORY=Module.FAST_MEMORY||2097152,totalMemory=65536;totalMemory<TOTAL_MEMORY||totalMemory<2*TOTAL_STACK;)totalMemory<16777216?totalMemory*=2:totalMemory+=16777216;totalMemory!==TOTAL_MEMORY&&(Module.printErr("increasing TOTAL_MEMORY to "+totalMemory+" to be compliant with the asm.js spec"),TOTAL_MEMORY=totalMemory),assert("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&!!new Int32Array(1).subarray&&!!new Int32Array(1).set,"JS engine does not provide full typed array support");var buffer=new ArrayBuffer(TOTAL_MEMORY);function callRuntimeCallbacks(t){for(;t.length>0;){var e=t.shift();if("function"!=typeof e){var i=e.func;"number"==typeof i?void 0===e.arg?Runtime.dynCall("v",i):Runtime.dynCall("vi",i,[e.arg]):i(void 0===e.arg?null:e.arg)}else e()}}HEAP8=new Int8Array(buffer),HEAP16=new Int16Array(buffer),HEAP32=new Int32Array(buffer),HEAPU8=new Uint8Array(buffer),HEAPU16=new Uint16Array(buffer),HEAPU32=new Uint32Array(buffer),HEAPF32=new Float32Array(buffer),HEAPF64=new Float64Array(buffer),HEAP32[0]=255,assert(255===HEAPU8[0]&&0===HEAPU8[3],"Typed arrays 2 must be run on a little-endian system"),Module.HEAP=HEAP,Module.buffer=buffer,Module.HEAP8=HEAP8,Module.HEAP16=HEAP16,Module.HEAP32=HEAP32,Module.HEAPU8=HEAPU8,Module.HEAPU16=HEAPU16,Module.HEAPU32=HEAPU32,Module.HEAPF32=HEAPF32,Module.HEAPF64=HEAPF64;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1,runtimeExited=!1;function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__),runtimeExited=!0}function postRun(){if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(t){__ATPRERUN__.unshift(t)}function addOnInit(t){__ATINIT__.unshift(t)}function addOnPreMain(t){__ATMAIN__.unshift(t)}function addOnExit(t){__ATEXIT__.unshift(t)}function addOnPostRun(t){__ATPOSTRUN__.unshift(t)}function intArrayFromString(t,e,i){var r=(new Runtime.UTF8Processor).processJSString(t);return i&&(r.length=i),e||r.push(0),r}function intArrayToString(t){for(var e=[],i=0;i<t.length;i++){var r=t[i];r>255&&(r&=255),e.push(String.fromCharCode(r))}return e.join("")}function writeStringToMemory(t,e,i){for(var r=intArrayFromString(t,i),n=0;n<r.length;){var o=r[n];HEAP8[e+n>>0]=o,n+=1}}function writeArrayToMemory(t,e){for(var i=0;i<t.length;i++)HEAP8[e+i>>0]=t[i]}function writeAsciiToMemory(t,e,i){for(var r=0;r<t.length;r++)HEAP8[e+r>>0]=t.charCodeAt(r);i||(HEAP8[e+t.length>>0]=0)}function unSign(t,e,i){return t>=0?t:e<=32?2*Math.abs(1<<e-1)+t:Math.pow(2,e)+t}function reSign(t,e,i){if(t<=0)return t;var r=e<=32?Math.abs(1<<e-1):Math.pow(2,e-1);return t>=r&&(e<=32||t>r)&&(t=-2*r+t),t}Module.addOnPreRun=Module.addOnPreRun=addOnPreRun,Module.addOnInit=Module.addOnInit=addOnInit,Module.addOnPreMain=Module.addOnPreMain=addOnPreMain,Module.addOnExit=Module.addOnExit=addOnExit,Module.addOnPostRun=Module.addOnPostRun=addOnPostRun,Module.intArrayFromString=intArrayFromString,Module.intArrayToString=intArrayToString,Module.writeStringToMemory=writeStringToMemory,Module.writeArrayToMemory=writeArrayToMemory,Module.writeAsciiToMemory=writeAsciiToMemory,Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(t,e){var i=65535&t,r=65535&e;return i*r+((t>>>16)*r+i*(e>>>16)<<16)|0}),Math.imul=Math.imul;var Math_abs=Math.abs,Math_cos=Math.cos,Math_sin=Math.sin,Math_tan=Math.tan,Math_acos=Math.acos,Math_asin=Math.asin,Math_atan=Math.atan,Math_atan2=Math.atan2,Math_exp=Math.exp,Math_log=Math.log,Math_sqrt=Math.sqrt,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_pow=Math.pow,Math_imul=Math.imul,Math_fround=Math.fround,Math_min=Math.min,runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function addRunDependency(t){runDependencies++,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}function removeRunDependency(t){if(runDependencies--,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies),0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var e=dependenciesFulfilled;dependenciesFulfilled=null,e()}}Module.addRunDependency=addRunDependency,Module.removeRunDependency=removeRunDependency,Module.preloadedImages={},Module.preloadedAudios={};var memoryInitializer=null;STATIC_BASE=8,STATICTOP=STATIC_BASE+5664,__ATINIT__.push({func:function(){__GLOBAL__I_a()}},{func:function(){__GLOBAL__I_a127()}}),allocate([78,55,77,105,110,105,115,97,116,50,48,79,117,116,79,102,77,101,109,111,114,121,69,120,99,101,112,116,105,111,110,69,0,0,0,0,0,0,0,0,88,18,0,0,8,0,0,0,78,55,77,105,110,105,115,97,116,54,79,112,116,105,111,110,69,0,0,0,0,0,0,0,88,18,0,0,56,0,0,0,10,32,32,32,32,32,32,32,32,37,115,10,0,0,0,0,0,0,0,0,80,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,200,0,0,0,1,0,0,0,3,0,0,0,1,0,0,0,1,0,0,0,78,55,77,105,110,105,115,97,116,49,48,66,111,111,108,79,112,116,105,111,110,69,0,0,128,18,0,0,176,0,0,0,80,0,0,0,0,0,0,0,32,32,45,37,115,44,32,45,110,111,45,37,115,0,0,0,40,100,101,102,97,117,108,116,58,32,37,115,41,10,0,0,111,110,0,0,0,0,0,0,111,102,102,0,0,0,0,0,110,111,45,0,0,0,0,0,0,0,0,0,64,1,0,0,1,0,0,0,4,0,0,0,2,0,0,0,2,0,0,0,78,55,77,105,110,105,115,97,116,57,73,110,116,79,112,116,105,111,110,69,0,0,0,0,128,18,0,0,40,1,0,0,80,0,0,0,0,0,0,0,32,32,45,37,45,49,50,115,32,61,32,37,45,56,115,32,91,0,0,0,0,0,0,0,105,109,105,110,0,0,0,0,37,52,100,0,0,0,0,0,32,46,46,32,0,0,0,0,105,109,97,120,0,0,0,0,93,32,40,100,101,102,97,117,108,116,58,32,37,100,41,10,0,0,0,0,0,0,0,0,69,82,82,79,82,33,32,118,97,108,117,101,32,60,37,115,62,32,105,115,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,111,112,116,105,111,110,32,34,37,115,34,46,10,0,0,0,0,0,0,0,0,69,82,82,79,82,33,32,118,97,108,117,101,32,60,37,115,62,32,105,115,32,116,111,111,32,115,109,97,108,108,32,102,111,114,32,111,112,116,105,111,110,32,34,37,115,34,46,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,118,97,114,45,100,101,99,97,121,0,0,0,0,0,0,0,84,104,101,32,118,97,114,105,97,98,108,101,32,97,99,116,105,118,105,116,121,32,100,101,99,97,121,32,102,97,99,116,111,114,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,99,108,97,45,100,101,99,97,121,0,0,0,0,0,0,0,84,104,101,32,99,108,97,117,115,101,32,97,99,116,105,118,105,116,121,32,100,101,99,97,121,32,102,97,99,116,111,114,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,114,110,100,45,102,114,101,113,0,0,0,0,0,0,0,0,84,104,101,32,102,114,101,113,117,101,110,99,121,32,119,105,116,104,32,119,104,105,99,104,32,116,104,101,32,100,101,99,105,115,105,111,110,32,104,101,117,114,105,115,116,105,99,32,116,114,105,101,115,32,116,111,32,99,104,111,111,115,101,32,97,32,114,97,110,100,111,109,32,118,97,114,105,97,98,108,101,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,114,110,100,45,115,101,101,100,0,0,0,0,0,0,0,0,85,115,101,100,32,98,121,32,116,104,101,32,114,97,110,100,111,109,32,118,97,114,105,97,98,108,101,32,115,101,108,101,99,116,105,111,110,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,99,99,109,105,110,45,109,111,100,101,0,0,0,0,0,0,67,111,110,116,114,111,108,115,32,99,111,110,102,108,105,99,116,32,99,108,97,117,115,101,32,109,105,110,105,109,105,122,97,116,105,111,110,32,40,48,61,110,111,110,101,44,32,49,61,98,97,115,105,99,44,32,50,61,100,101,101,112,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,104,97,115,101,45,115,97,118,105,110,103,0,0,0,0,67,111,110,116,114,111,108,115,32,116,104,101,32,108,101,118,101,108,32,111,102,32,112,104,97,115,101,32,115,97,118,105,110,103,32,40,48,61,110,111,110,101,44,32,49,61,108,105,109,105,116,101,100,44,32,50,61,102,117,108,108,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,114,110,100,45,105,110,105,116,0,0,0,0,0,0,0,0,82,97,110,100,111,109,105,122,101,32,116,104,101,32,105,110,105,116,105,97,108,32,97,99,116,105,118,105,116,121,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,108,117,98,121,0,0,0,0,85,115,101,32,116,104,101,32,76,117,98,121,32,114,101,115,116,97,114,116,32,115,101,113,117,101,110,99,101,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,114,102,105,114,115,116,0,0,84,104,101,32,98,97,115,101,32,114,101,115,116,97,114,116,32,105,110,116,101,114,118,97,108,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,114,105,110,99,0,0,0,0,82,101,115,116,97,114,116,32,105,110,116,101,114,118,97,108,32,105,110,99,114,101,97,115,101,32,102,97,99,116,111,114,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,103,99,45,102,114,97,99,0,84,104,101,32,102,114,97,99,116,105,111,110,32,111,102,32,119,97,115,116,101,100,32,109,101,109,111,114,121,32,97,108,108,111,119,101,100,32,98,101,102,111,114,101,32,97,32,103,97,114,98,97,103,101,32,99,111,108,108,101,99,116,105,111,110,32,105,115,32,116,114,105,103,103,101,114,101,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,109,105,110,45,108,101,97,114,110,116,115,0,0,0,0,0,77,105,110,105,109,117,109,32,108,101,97,114,110,116,32,99,108,97,117,115,101,32,108,105,109,105,116,0,0,0,0,0,0,0,0,0,192,7,0,0,5,0,0,0,6,0,0,0,7,0,0,0,0,0,0,0,124,32,37,57,100,32,124,32,37,55,100,32,37,56,100,32,37,56,100,32,124,32,37,56,100,32,37,56,100,32,37,54,46,48,102,32,124,32,37,54,46,51,102,32,37,37,32,124,10,0,0,0,0,0,0,0,124,32,32,71,97,114,98,97,103,101,32,99,111,108,108,101,99,116,105,111,110,58,32,32,32,37,49,50,100,32,98,121,116,101,115,32,61,62,32,37,49,50,100,32,98,121,116,101,115,32,32,32,32,32,32,32,32,32,32,32,32,32,124,10,0,0,0,0,0,0,0,0,78,55,77,105,110,105,115,97,116,54,83,111,108,118,101,114,69,0,0,0,0,0,0,0,88,18,0,0,168,7,0,0,60,98,111,111,108,62,0,0,10,32,32,32,32,32,32,32,32,37,115,10,0,0,0,0,60,105,110,116,51,50,62,0,69,82,82,79,82,33,32,118,97,108,117,101,32,60,37,115,62,32,105,115,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,111,112,116,105,111,110,32,34,37,115,34,46,10,0,0,0,0,0,0,0,0,69,82,82,79,82,33,32,118,97,108,117,101,32,60,37,115,62,32,105,115,32,116,111,111,32,115,109,97,108,108,32,102,111,114,32,111,112,116,105,111,110,32,34,37,115,34,46,10,0,0,0,0,0,0,0,0,67,79,82,69,0,0,0,0,60,100,111,117,98,108,101,62,0,0,0,0,0,0,0,0,0,0,0,0,168,8,0,0,1,0,0,0,8,0,0,0,3,0,0,0,3,0,0,0,78,55,77,105,110,105,115,97,116,49,50,68,111,117,98,108,101,79,112,116,105,111,110,69,0,0,0,0,0,0,0,0,128,18,0,0,136,8,0,0,80,0,0,0,0,0,0,0,32,32,45,37,45,49,50,115,32,61,32,37,45,56,115,32,37,99,37,52,46,50,103,32,46,46,32,37,52,46,50,103,37,99,32,40,100,101,102,97,117,108,116,58,32,37,103,41,10,0,0,0,0,0,0,0,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,91,32,83,101,97,114,99,104,32,83,116,97,116,105,115,116,105,99,115,32,93,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,0,124,32,67,111,110,102,108,105,99,116,115,32,124,32,32,32,32,32,32,32,32,32,32,79,82,73,71,73,78,65,76,32,32,32,32,32,32,32,32,32,124,32,32,32,32,32,32,32,32,32,32,76,69,65,82,78,84,32,32,32,32,32,32,32,32,32,32,124,32,80,114,111,103,114,101,115,115,32,124,0,124,32,32,32,32,32,32,32,32,32,32,32,124,32,32,32,32,86,97,114,115,32,32,67,108,97,117,115,101,115,32,76,105,116,101,114,97,108,115,32,124,32,32,32,32,76,105,109,105,116,32,32,67,108,97,117,115,101,115,32,76,105,116,47,67,108,32,124,32,32,32,32,32,32,32,32,32,32,124,0,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,97,115,121,109,109,0,0,0,83,104,114,105,110,107,32,99,108,97,117,115,101,115,32,98,121,32,97,115,121,109,109,101,116,114,105,99,32,98,114,97,110,99,104,105,110,103,46,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,114,99,104,101,99,107,0,0,67,104,101,99,107,32,105,102,32,97,32,99,108,97,117,115,101,32,105,115,32,97,108,114,101,97,100,121,32,105,109,112,108,105,101,100,46,32,40,99,111,115,116,108,121,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,101,108,105,109,0,0,0,0,80,101,114,102,111,114,109,32,118,97,114,105,97,98,108,101,32,101,108,105,109,105,110,97,116,105,111,110,46,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,103,114,111,119,0,0,0,0,65,108,108,111,119,32,97,32,118,97,114,105,97,98,108,101,32,101,108,105,109,105,110,97,116,105,111,110,32,115,116,101,112,32,116,111,32,103,114,111,119,32,98,121,32,97,32,110,117,109,98,101,114,32,111,102,32,99,108,97,117,115,101,115,46,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,99,108,45,108,105,109,0,0,86,97,114,105,97,98,108,101,115,32,97,114,101,32,110,111,116,32,101,108,105,109,105,110,97,116,101,100,32,105,102,32,105,116,32,112,114,111,100,117,99,101,115,32,97,32,114,101,115,111,108,118,101,110,116,32,119,105,116,104,32,97,32,108,101,110,103,116,104,32,97,98,111,118,101,32,116,104,105,115,32,108,105,109,105,116,46,32,45,49,32,109,101,97,110,115,32,110,111,32,108,105,109,105,116,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,115,117,98,45,108,105,109,0,68,111,32,110,111,116,32,99,104,101,99,107,32,105,102,32,115,117,98,115,117,109,112,116,105,111,110,32,97,103,97,105,110,115,116,32,97,32,99,108,97,117,115,101,32,108,97,114,103,101,114,32,116,104,97,110,32,116,104,105,115,46,32,45,49,32,109,101,97,110,115,32,110,111,32,108,105,109,105,116,46,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,115,105,109,112,45,103,99,45,102,114,97,99,0,0,0,0,84,104,101,32,102,114,97,99,116,105,111,110,32,111,102,32,119,97,115,116,101,100,32,109,101,109,111,114,121,32,97,108,108,111,119,101,100,32,98,101,102,111,114,101,32,97,32,103,97,114,98,97,103,101,32,99,111,108,108,101,99,116,105,111,110,32,105,115,32,116,114,105,103,103,101,114,101,100,32,100,117,114,105,110,103,32,115,105,109,112,108,105,102,105,99,97,116,105,111,110,46,0,0,0,0,0,0,0,120,14,0,0,9,0,0,0,10,0,0,0,11,0,0,0,0,0,0,0,115,117,98,115,117,109,112,116,105,111,110,32,108,101,102,116,58,32,37,49,48,100,32,40,37,49,48,100,32,115,117,98,115,117,109,101,100,44,32,37,49,48,100,32,100,101,108,101,116,101,100,32,108,105,116,101,114,97,108,115,41,13,0,0,101,108,105,109,105,110,97,116,105,111,110,32,108,101,102,116,58,32,37,49,48,100,13,0,124,32,32,69,108,105,109,105,110,97,116,101,100,32,99,108,97,117,115,101,115,58,32,32,32,32,32,37,49,48,46,50,102,32,77,98,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,124,10,0,0,0,0,124,32,32,71,97,114,98,97,103,101,32,99,111,108,108,101,99,116,105,111,110,58,32,32,32,37,49,50,100,32,98,121,116,101,115,32,61,62,32,37,49,50,100,32,98,121,116,101,115,32,32,32,32,32,32,32,32,32,32,32,32,32,124,10,0,0,0,0,0,0,0,0,78,55,77,105,110,105,115,97,116,49,48,83,105,109,112,83,111,108,118,101,114,69,0,0,128,18,0,0,96,14,0,0,192,7,0,0,0,0,0,0,60,100,111,117,98,108,101,62,0,0,0,0,0,0,0,0,60,105,110,116,51,50,62,0,83,73,77,80,0,0,0,0,60,98,111,111,108,62,0,0,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,89,79,33,0,0,0,0,0,2,0,0,0,0,0,0,0,48,15,0,0,0,0,0,0,117,110,99,97,117,103,104,116,0,0,0,0,0,0,0,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,58,32,37,115,0,0,0,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,0,0,0,0,0,0,0,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,102,111,114,101,105,103,110,32,101,120,99,101,112,116,105,111,110,0,0,0,116,101,114,109,105,110,97,116,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,116,104,114,101,97,100,95,111,110,99,101,32,102,97,105,108,117,114,101,32,105,110,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,95,102,97,115,116,40,41,0,0,0,0,0,0,0,0,99,97,110,110,111,116,32,99,114,101,97,116,101,32,112,116,104,114,101,97,100,32,107,101,121,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,0,0,0,0,0,0,99,97,110,110,111,116,32,122,101,114,111,32,111,117,116,32,116,104,114,101,97,100,32,118,97,108,117,101,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,0,0,0,0,0,0,0,200,16,0,0,12,0,0,0,13,0,0,0,1,0,0,0,0,0,0,0,115,116,100,58,58,98,97,100,95,97,108,108,111,99,0,0,83,116,57,98,97,100,95,97,108,108,111,99,0,0,0,0,128,18,0,0,184,16,0,0,80,17,0,0,0,0,0,0,116,101,114,109,105,110,97,116,101,95,104,97,110,100,108,101,114,32,117,110,101,120,112,101,99,116,101,100,108,121,32,114,101,116,117,114,110,101,100,0,116,101,114,109,105,110,97,116,101,95,104,97,110,100,108,101,114,32,117,110,101,120,112,101,99,116,101,100,108,121,32,116,104,114,101,119,32,97,110,32,101,120,99,101,112,116,105,111,110,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,83,116,57,101,120,99,101,112,116,105,111,110,0,0,0,0,88,18,0,0,64,17,0,0,83,116,57,116,121,112,101,95,105,110,102,111,0,0,0,0,88,18,0,0,88,17,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,54,95,95,115,104,105,109,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,0,0,0,0,128,18,0,0,112,17,0,0,104,17,0,0,0,0,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,0,0,0,128,18,0,0,168,17,0,0,152,17,0,0,0,0,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,57,95,95,112,111,105,110,116,101,114,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,112,98,97,115,101,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,0,0,0,128,18,0,0,8,18,0,0,152,17,0,0,0,0,0,0,128,18,0,0,224,17,0,0,48,18,0,0,0,0,0,0,0,0,0,0,208,17,0,0,14,0,0,0,15,0,0,0,16,0,0,0,17,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,200,18,0,0,14,0,0,0,18,0,0,0,16,0,0,0,17,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,48,95,95,115,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,128,18,0,0,160,18,0,0,208,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,255,255,255,255,255,255,255,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,255,255,255,255,255,255,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,1,2,4,7,3,6,5,0,0,0,0,0,0,0,0,105,110,102,105,110,105,116,121,0,0,0,0,0,0,0,0,110,97,110,0,0,0,0,0,95,112,137,0,255,9,47,15,10,0,0,0,100,0,0,0,232,3,0,0,16,39,0,0,160,134,1,0,64,66,15,0,128,150,152,0,0,225,245,5],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE);var tempDoublePtr=Runtime.alignMemory(allocate(12,"i8",ALLOC_STATIC),8);function copyTempFloat(t){HEAP8[tempDoublePtr]=HEAP8[t],HEAP8[tempDoublePtr+1]=HEAP8[t+1],HEAP8[tempDoublePtr+2]=HEAP8[t+2],HEAP8[tempDoublePtr+3]=HEAP8[t+3]}function copyTempDouble(t){HEAP8[tempDoublePtr]=HEAP8[t],HEAP8[tempDoublePtr+1]=HEAP8[t+1],HEAP8[tempDoublePtr+2]=HEAP8[t+2],HEAP8[tempDoublePtr+3]=HEAP8[t+3],HEAP8[tempDoublePtr+4]=HEAP8[t+4],HEAP8[tempDoublePtr+5]=HEAP8[t+5],HEAP8[tempDoublePtr+6]=HEAP8[t+6],HEAP8[tempDoublePtr+7]=HEAP8[t+7]}function _atexit(t,e){__ATEXIT__.unshift({func:t,arg:e})}function ___cxa_atexit(){return _atexit.apply(null,arguments)}assert(tempDoublePtr%8==0),Module._i64Subtract=_i64Subtract;var ___errno_state=0;function ___setErrNo(t){return HEAP32[___errno_state>>2]=t,t}var ERRNO_CODES={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};function _sysconf(t){switch(t){case 30:return PAGE_SIZE;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 79:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"==typeof navigator&&navigator.hardwareConcurrency||1}return ___setErrNo(ERRNO_CODES.EINVAL),-1}function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:function(t){if(!t||EXCEPTIONS.infos[t])return t;for(var e in EXCEPTIONS.infos){if(EXCEPTIONS.infos[e].adjusted===t)return e}return t},addRef:function(t){t&&EXCEPTIONS.infos[t].refcount++},decRef:function(t){if(t){var e=EXCEPTIONS.infos[t];assert(e.refcount>0),e.refcount--,0===e.refcount&&(e.destructor&&Runtime.dynCall("vi",e.destructor,[t]),delete EXCEPTIONS.infos[t],___cxa_free_exception(t))}},clearRef:function(t){t&&(EXCEPTIONS.infos[t].refcount=0)}};function ___resumeException(t){throw EXCEPTIONS.last||(EXCEPTIONS.last=t),EXCEPTIONS.clearRef(EXCEPTIONS.deAdjust(t)),t+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function ___cxa_find_matching_catch(){var t=EXCEPTIONS.last;if(!t)return 0|(asm.setTempRet0(0),0);var e=EXCEPTIONS.infos[t],i=e.type;if(!i)return 0|(asm.setTempRet0(0),t);var r=Array.prototype.slice.call(arguments);Module.___cxa_is_pointer_type(i);___cxa_find_matching_catch.buffer||(___cxa_find_matching_catch.buffer=_malloc(4)),HEAP32[___cxa_find_matching_catch.buffer>>2]=t,t=___cxa_find_matching_catch.buffer;for(var n=0;n<r.length;n++)if(r[n]&&Module.___cxa_can_catch(r[n],i,t))return t=HEAP32[t>>2],e.adjusted=t,0|(asm.setTempRet0(r[n]),t);return t=HEAP32[t>>2],0|(asm.setTempRet0(i),t)}function ___cxa_throw(t,e,i){throw EXCEPTIONS.infos[t]={ptr:t,adjusted:t,type:e,destructor:i,refcount:0},EXCEPTIONS.last=t,"uncaught_exception"in __ZSt18uncaught_exceptionv?__ZSt18uncaught_exceptionv.uncaught_exception++:__ZSt18uncaught_exceptionv.uncaught_exception=1,t+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function _abort(){Module.abort()}Module._memset=_memset,Module._bitshift64Shl=_bitshift64Shl;var FS=void 0,SOCKFS=void 0;function _send(t,e,i,r){return SOCKFS.getSocket(t)?_write(t,e,i):(___setErrNo(ERRNO_CODES.EBADF),-1)}function _pwrite(t,e,i,r){var n=FS.getStream(t);if(!n)return ___setErrNo(ERRNO_CODES.EBADF),-1;try{var o=HEAP8;return FS.write(n,o,e,i,r)}catch(t){return FS.handleFSError(t),-1}}function _write(t,e,i){var r=FS.getStream(t);if(!r)return ___setErrNo(ERRNO_CODES.EBADF),-1;try{var n=HEAP8;return FS.write(r,n,e,i)}catch(t){return FS.handleFSError(t),-1}}function _fileno(t){return(t=FS.getStreamFromPtr(t))?t.fd:-1}function _fwrite(t,e,i,r){var n=i*e;if(0==n)return 0;var o=_write(_fileno(r),t,n);if(-1==o){var s=FS.getStreamFromPtr(r);return s&&(s.error=!0),0}return o/e|0}function __reallyNegative(t){return t<0||0===t&&1/t==-1/0}function __formatString(t,e){var i=t,r=0;function n(t){var i;return"double"===t?(HEAP32[tempDoublePtr>>2]=HEAP32[e+r>>2],HEAP32[tempDoublePtr+4>>2]=HEAP32[e+(r+4)>>2],i=+HEAPF64[tempDoublePtr>>3]):"i64"==t?i=[HEAP32[e+r>>2],HEAP32[e+(r+4)>>2]]:(t="i32",i=HEAP32[e+r>>2]),r+=Runtime.getNativeFieldSize(t),i}for(var o,s,a=[];;){var l=i;if(0===(o=HEAP8[i>>0]))break;if(s=HEAP8[i+1>>0],37==o){var u=!1,h=!1,c=!1,f=!1,d=!1;t:for(;;){switch(s){case 43:u=!0;break;case 45:h=!0;break;case 35:c=!0;break;case 48:if(f)break t;f=!0;break;case 32:d=!0;break;default:break t}s=HEAP8[++i+1>>0]}var m=0;if(42==s)m=n("i32"),s=HEAP8[++i+1>>0];else for(;s>=48&&s<=57;)m=10*m+(s-48),s=HEAP8[++i+1>>0];var p,g=!1,_=-1;if(46==s){if(_=0,g=!0,42==(s=HEAP8[++i+1>>0]))_=n("i32"),i++;else for(;;){var v=HEAP8[i+1>>0];if(v<48||v>57)break;_=10*_+(v-48),i++}s=HEAP8[i+1>>0]}switch(_<0&&(_=6,g=!1),String.fromCharCode(s)){case"h":104==HEAP8[i+2>>0]?(i++,p=1):p=2;break;case"l":108==HEAP8[i+2>>0]?(i++,p=8):p=4;break;case"L":case"q":case"j":p=8;break;case"z":case"t":case"I":p=4;break;default:p=null}switch(p&&i++,s=HEAP8[i+1>>0],String.fromCharCode(s)){case"d":case"i":case"u":case"o":case"x":case"X":case"p":var b=100==s||105==s,y=T=n("i"+8*(p=p||4));if(8==p&&(T=Runtime.makeBigInt(T[0],T[1],117==s)),p<=4)T=(b?reSign:unSign)(T&Math.pow(256,p)-1,8*p);var w=Math.abs(T),E="";if(100==s||105==s)A=8==p&&i64Math?i64Math.stringify(y[0],y[1],null):reSign(T,8*p,1).toString(10);else if(117==s)A=8==p&&i64Math?i64Math.stringify(y[0],y[1],!0):unSign(T,8*p,1).toString(10),T=Math.abs(T);else if(111==s)A=(c?"0":"")+w.toString(8);else if(120==s||88==s){if(E=c&&0!=T?"0x":"",8==p&&i64Math)if(y[1]){A=(y[1]>>>0).toString(16);for(var k=(y[0]>>>0).toString(16);k.length<8;)k="0"+k;A+=k}else A=(y[0]>>>0).toString(16);else if(T<0){T=-T,A=(w-1).toString(16);for(var S=[],M=0;M<A.length;M++)S.push((15-parseInt(A[M],16)).toString(16));for(A=S.join("");A.length<2*p;)A="f"+A}else A=w.toString(16);88==s&&(E=E.toUpperCase(),A=A.toUpperCase())}else 112==s&&(0===w?A="(nil)":(E="0x",A=w.toString(16)));if(g)for(;A.length<_;)A="0"+A;for(T>=0&&(u?E="+"+E:d&&(E=" "+E)),"-"==A.charAt(0)&&(E="-"+E,A=A.substr(1));E.length+A.length<m;)h?A+=" ":f?A="0"+A:E=" "+E;(A=E+A).split("").forEach((function(t){a.push(t.charCodeAt(0))}));break;case"f":case"F":case"e":case"E":case"g":case"G":var A,T=n("double");if(isNaN(T))A="nan",f=!1;else if(isFinite(T)){var C=!1,x=Math.min(_,20);if(103==s||71==s){C=!0,_=_||1;var R=parseInt(T.toExponential(x).split("e")[1],10);_>R&&R>=-4?(s=(103==s?"f":"F").charCodeAt(0),_-=R+1):(s=(103==s?"e":"E").charCodeAt(0),_--),x=Math.min(_,20)}101==s||69==s?(A=T.toExponential(x),/[eE][-+]\d$/.test(A)&&(A=A.slice(0,-1)+"0"+A.slice(-1))):102!=s&&70!=s||(A=T.toFixed(x),0===T&&__reallyNegative(T)&&(A="-"+A));var O=A.split("e");if(C&&!c)for(;O[0].length>1&&-1!=O[0].indexOf(".")&&("0"==O[0].slice(-1)||"."==O[0].slice(-1));)O[0]=O[0].slice(0,-1);else for(c&&-1==A.indexOf(".")&&(O[0]+=".");_>x++;)O[0]+="0";A=O[0]+(O.length>1?"e"+O[1]:""),69==s&&(A=A.toUpperCase()),T>=0&&(u?A="+"+A:d&&(A=" "+A))}else A=(T<0?"-":"")+"inf",f=!1;for(;A.length<m;)h?A+=" ":A=!f||"-"!=A[0]&&"+"!=A[0]?(f?"0":" ")+A:A[0]+"0"+A.slice(1);s<97&&(A=A.toUpperCase()),A.split("").forEach((function(t){a.push(t.charCodeAt(0))}));break;case"s":var L=n("i8*"),P=L?_strlen(L):"(null)".length;if(g&&(P=Math.min(P,_)),!h)for(;P<m--;)a.push(32);if(L)for(M=0;M<P;M++)a.push(HEAPU8[L++>>0]);else a=a.concat(intArrayFromString("(null)".substr(0,P),!0));if(h)for(;P<m--;)a.push(32);break;case"c":for(h&&a.push(n("i8"));--m>0;)a.push(32);h||a.push(n("i8"));break;case"n":var N=n("i32*");HEAP32[N>>2]=a.length;break;case"%":a.push(o);break;default:for(M=l;M<i+2;M++)a.push(HEAP8[M>>0])}i+=2}else a.push(o),i+=1}return a}function _fprintf(t,e,i){var r=__formatString(e,i),n=Runtime.stackSave(),o=_fwrite(allocate(r,"i8",ALLOC_STACK),1,r.length,t);return Runtime.stackRestore(n),o}function _printf(t,e){var i=__formatString(t,e),r=intArrayToString(i);return"\n"===r[r.length-1]&&(r=r.substr(0,r.length-1)),Module.print(r),i.length}function _pthread_once(t,e){_pthread_once.seen||(_pthread_once.seen={}),t in _pthread_once.seen||(Runtime.dynCall("v",e),_pthread_once.seen[t]=1)}function _fputc(t,e){var i=unSign(255&t);if(HEAP8[_fputc.ret>>0]=i,-1==_write(_fileno(e),_fputc.ret,1)){var r=FS.getStreamFromPtr(e);return r&&(r.error=!0),-1}return i}Module._strlen=_strlen;var PTHREAD_SPECIFIC={};function _pthread_getspecific(t){return PTHREAD_SPECIFIC[t]||0}function _fputs(t,e){return _write(_fileno(e),t,_strlen(t))}Module._i64Add=_i64Add;var _stdout=allocate(1,"i32*",ALLOC_STATIC);function _puts(t){var e=Pointer_stringify(t),i=e.substr(0);return"\n"===i[i.length-1]&&(i=i.substr(0,i.length-1)),Module.print(i),e.length}function _pthread_setspecific(t,e){return t in PTHREAD_SPECIFIC?(PTHREAD_SPECIFIC[t]=e,0):ERRNO_CODES.EINVAL}function __exit(t){Module.exit(t)}function _exit(t){__exit(t)}var _UItoD=!0;function _malloc(t){return Runtime.dynamicAlloc(t+8)+8&4294967288}function ___cxa_allocate_exception(t){return _malloc(t)}function _fmod(t,e){return t%e}function _fmodl(){return _fmod.apply(null,arguments)}function ___cxa_pure_virtual(){throw ABORT=!0,"Pure virtual function called!"}function _time(t){var e=Date.now()/1e3|0;return t&&(HEAP32[t>>2]=e),e}Module._malloc=_malloc,Module._bitshift64Lshr=_bitshift64Lshr;var PTHREAD_SPECIFIC_NEXT_KEY=1;function _pthread_key_create(t,e){return 0==t?ERRNO_CODES.EINVAL:(HEAP32[t>>2]=PTHREAD_SPECIFIC_NEXT_KEY,PTHREAD_SPECIFIC[PTHREAD_SPECIFIC_NEXT_KEY]=0,PTHREAD_SPECIFIC_NEXT_KEY++,0)}function ___cxa_guard_acquire(t){return HEAP8[t>>0]?0:(HEAP8[t>>0]=1,1)}function ___cxa_guard_release(){}function _vfprintf(t,e,i){return _fprintf(t,e,HEAP32[i>>2])}function ___cxa_begin_catch(t){return __ZSt18uncaught_exceptionv.uncaught_exception--,EXCEPTIONS.caught.push(t),EXCEPTIONS.addRef(EXCEPTIONS.deAdjust(t)),t}function _emscripten_memcpy_big(t,e,i){return HEAPU8.set(HEAPU8.subarray(e,e+i),t),t}Module._memcpy=_memcpy;var _llvm_pow_f64=Math_pow;function _sbrk(t){var e=_sbrk;e.called||(DYNAMICTOP=alignMemoryPage(DYNAMICTOP),e.called=!0,assert(Runtime.dynamicAlloc),e.alloc=Runtime.dynamicAlloc,Runtime.dynamicAlloc=function(){abort("cannot dynamically allocate, sbrk now has control")});var i=DYNAMICTOP;return 0!=t&&e.alloc(t),i}var _fabs=Math_abs;function ___errno_location(){return ___errno_state}var _BItoD=!0;function _copysign(t,e){return __reallyNegative(t)===__reallyNegative(e)?t:-t}function _copysignl(){return _copysign.apply(null,arguments)}var ___dso_handle=allocate(1,"i32*",ALLOC_STATIC),_stderr=allocate(1,"i32*",ALLOC_STATIC);___errno_state=Runtime.staticAlloc(4),HEAP32[___errno_state>>2]=0,_fputc.ret=allocate([0],"i8",ALLOC_STATIC),STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP),staticSealed=!0,STACK_MAX=STACK_BASE+TOTAL_STACK,DYNAMIC_BASE=DYNAMICTOP=Runtime.alignMemory(STACK_MAX),assert(DYNAMIC_BASE<TOTAL_MEMORY,"TOTAL_MEMORY not big enough for stack");var ctlz_i8=allocate([8,7,6,6,5,5,5,5,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"i8",ALLOC_DYNAMIC),cttz_i8=allocate([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",ALLOC_DYNAMIC);function invoke_iiii(t,e,i,r){try{return Module.dynCall_iiii(t,e,i,r)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;asm.setThrew(1,0)}}function invoke_viiiii(t,e,i,r,n,o){try{Module.dynCall_viiiii(t,e,i,r,n,o)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;asm.setThrew(1,0)}}function invoke_vi(t,e){try{Module.dynCall_vi(t,e)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;asm.setThrew(1,0)}}function invoke_vii(t,e,i){try{Module.dynCall_vii(t,e,i)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;asm.setThrew(1,0)}}function invoke_ii(t,e){try{return Module.dynCall_ii(t,e)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;asm.setThrew(1,0)}}function invoke_v(t){try{Module.dynCall_v(t)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;asm.setThrew(1,0)}}function invoke_viiiiii(t,e,i,r,n,o,s){try{Module.dynCall_viiiiii(t,e,i,r,n,o,s)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;asm.setThrew(1,0)}}function invoke_iii(t,e,i){try{return Module.dynCall_iii(t,e,i)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;asm.setThrew(1,0)}}function invoke_viiii(t,e,i,r,n){try{Module.dynCall_viiii(t,e,i,r,n)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;asm.setThrew(1,0)}}Module.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array},Module.asmLibraryArg={abort:abort,assert:assert,min:Math_min,invoke_iiii:invoke_iiii,invoke_viiiii:invoke_viiiii,invoke_vi:invoke_vi,invoke_vii:invoke_vii,invoke_ii:invoke_ii,invoke_v:invoke_v,invoke_viiiiii:invoke_viiiiii,invoke_iii:invoke_iii,invoke_viiii:invoke_viiii,_fabs:_fabs,_llvm_pow_f64:_llvm_pow_f64,_send:_send,_fmod:_fmod,___cxa_guard_acquire:___cxa_guard_acquire,___setErrNo:___setErrNo,_vfprintf:_vfprintf,___cxa_allocate_exception:___cxa_allocate_exception,___cxa_find_matching_catch:___cxa_find_matching_catch,___cxa_guard_release:___cxa_guard_release,_pwrite:_pwrite,__reallyNegative:__reallyNegative,_sbrk:_sbrk,___cxa_begin_catch:___cxa_begin_catch,_emscripten_memcpy_big:_emscripten_memcpy_big,_fileno:_fileno,___resumeException:___resumeException,__ZSt18uncaught_exceptionv:__ZSt18uncaught_exceptionv,_sysconf:_sysconf,_pthread_getspecific:_pthread_getspecific,_atexit:_atexit,_pthread_once:_pthread_once,_puts:_puts,_printf:_printf,_pthread_key_create:_pthread_key_create,_write:_write,___errno_location:___errno_location,_pthread_setspecific:_pthread_setspecific,___cxa_atexit:___cxa_atexit,_copysign:_copysign,_fputc:_fputc,___cxa_throw:___cxa_throw,__exit:__exit,_copysignl:_copysignl,_abort:_abort,_fwrite:_fwrite,_time:_time,_fprintf:_fprintf,__formatString:__formatString,_fputs:_fputs,_exit:_exit,___cxa_pure_virtual:___cxa_pure_virtual,_fmodl:_fmodl,STACKTOP:STACKTOP,STACK_MAX:STACK_MAX,tempDoublePtr:tempDoublePtr,ABORT:ABORT,cttz_i8:cttz_i8,ctlz_i8:ctlz_i8,NaN:NaN,Infinity:1/0,___dso_handle:___dso_handle,_stderr:_stderr};var asm=function(t,e,i){"use asm";var r=new t.Int8Array(i);var n=new t.Int16Array(i);var o=new t.Int32Array(i);var s=new t.Uint8Array(i);var a=new t.Uint16Array(i);var l=new t.Uint32Array(i);var u=new t.Float32Array(i);var h=new t.Float64Array(i);var c=e.STACKTOP|0;var f=e.STACK_MAX|0;var d=e.tempDoublePtr|0;var m=e.ABORT|0;var p=e.cttz_i8|0;var g=e.ctlz_i8|0;var _=e.___dso_handle|0;var v=e._stderr|0;var b=0;var y=0;var w=0;var E=0;var k=+e.NaN,S=+e.Infinity;var M=0,A=0,T=0,C=0,x=0.0,R=0,O=0,L=0,P=0.0;var N=0;var I=0;var F=0;var D=0;var V=0;var B=0;var U=0;var K=0;var H=0;var W=0;var z=t.Math.floor;var q=t.Math.abs;var j=t.Math.sqrt;var X=t.Math.pow;var Y=t.Math.cos;var $=t.Math.sin;var G=t.Math.tan;var Z=t.Math.acos;var J=t.Math.asin;var Q=t.Math.atan;var tt=t.Math.atan2;var et=t.Math.exp;var it=t.Math.log;var rt=t.Math.ceil;var nt=t.Math.imul;var ot=e.abort;var st=e.assert;var at=e.min;var lt=e.invoke_iiii;var ut=e.invoke_viiiii;var ht=e.invoke_vi;var ct=e.invoke_vii;var ft=e.invoke_ii;var dt=e.invoke_v;var mt=e.invoke_viiiiii;var pt=e.invoke_iii;var gt=e.invoke_viiii;var _t=e._fabs;var vt=e._llvm_pow_f64;var bt=e._send;var yt=e._fmod;var wt=e.___cxa_guard_acquire;var Et=e.___setErrNo;var kt=e._vfprintf;var St=e.___cxa_allocate_exception;var Mt=e.___cxa_find_matching_catch;var At=e.___cxa_guard_release;var Tt=e._pwrite;var Ct=e.__reallyNegative;var xt=e._sbrk;var Rt=e.___cxa_begin_catch;var Ot=e._emscripten_memcpy_big;var Lt=e._fileno;var Pt=e.___resumeException;var Nt=e.__ZSt18uncaught_exceptionv;var It=e._sysconf;var Ft=e._pthread_getspecific;var Dt=e._atexit;var Vt=e._pthread_once;var Bt=e._puts;var Ut=e._printf;var Kt=e._pthread_key_create;var Ht=e._write;var Wt=e.___errno_location;var zt=e._pthread_setspecific;var qt=e.___cxa_atexit;var jt=e._copysign;var Xt=e._fputc;var Yt=e.___cxa_throw;var $t=e.__exit;var Gt=e._copysignl;var Zt=e._abort;var Jt=e._fwrite;var Qt=e._time;var te=e._fprintf;var ee=e.__formatString;var ie=e._fputs;var re=e._exit;var ne=e.___cxa_pure_virtual;var oe=e._fmodl;var se=0.0;function ae(t){t=t|0;var e=0;e=c;c=c+t|0;c=c+15&-16;return e|0}function le(){return c|0}function ue(t){t=t|0;c=t}function he(t,e){t=t|0;e=e|0;if(!b){b=t;y=e}}function ce(t){t=t|0;r[d>>0]=r[t>>0];r[d+1>>0]=r[t+1>>0];r[d+2>>0]=r[t+2>>0];r[d+3>>0]=r[t+3>>0]}function fe(t){t=t|0;r[d>>0]=r[t>>0];r[d+1>>0]=r[t+1>>0];r[d+2>>0]=r[t+2>>0];r[d+3>>0]=r[t+3>>0];r[d+4>>0]=r[t+4>>0];r[d+5>>0]=r[t+5>>0];r[d+6>>0]=r[t+6>>0];r[d+7>>0]=r[t+7>>0]}function de(t){t=t|0;N=t}function me(){return N|0}function pe(t){t=t|0;Rt(t|0)|0;mr()}function ge(t){t=t|0;return}function _e(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var a=0;a=c;o[t>>2]=112;o[t+4>>2]=e;o[t+8>>2]=i;o[t+12>>2]=n;o[t+16>>2]=s;if((r[144]|0)==0?(wt(144)|0)!=0:0){o[32]=0;o[33]=0;o[34]=0;qt(19,128,_|0)|0;At(144)}s=o[33]|0;if((s|0)==(o[34]|0)){n=(s>>1)+2&-2;n=(n|0)<2?2:n;if((n|0)>(2147483647-s|0)){e=St(1)|0;Yt(e|0,48,0)}i=o[32]|0;e=n+s|0;o[34]=e;e=Ur(i,e<<2)|0;o[32]=e;if((e|0)==0?(o[(Wt()|0)>>2]|0)==12:0){e=St(1)|0;Yt(e|0,48,0)}s=o[33]|0}o[33]=s+1;s=(o[32]|0)+(s<<2)|0;if(!s){c=a;return}o[s>>2]=t;c=a;return}function ve(t){t=t|0;var e=0;e=c;ur(t);c=e;return}function be(t){t=t|0;var e=0,i=0;e=c;i=o[t>>2]|0;if(!i){c=e;return}o[t+4>>2]=0;Br(i);o[t>>2]=0;o[t+8>>2]=0;c=e;return}function ye(t){t=t|0;var e=0;e=c;ur(t);c=e;return}function we(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0;i=c;if((r[e>>0]|0)!=45){u=0;c=i;return u|0}n=e+1|0;s=110;l=n;u=0;while(1){a=u+1|0;if((r[l>>0]|0)!=s<<24>>24){s=1;break}l=e+(u+2)|0;if((a|0)==3){s=0;n=l;break}else{s=r[264+a>>0]|0;u=a}}if(Jr(n,o[t+4>>2]|0)|0){u=0;c=i;return u|0}r[t+20>>0]=s;u=1;c=i;return u|0}function Ee(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0;a=c;c=c+16|0;i=a;n=o[v>>2]|0;s=t+4|0;l=o[s>>2]|0;o[i>>2]=l;o[i+4>>2]=l;te(n|0,216,i|0)|0;l=0;while(1){u=l>>>0<(32-((an(o[s>>2]|0)|0)<<1)|0)>>>0;Xt(32,n|0)|0;if(u)l=l+1|0;else break}o[i>>2]=(r[t+20>>0]|0)!=0?248:256;te(n|0,232,i|0)|0;if(!e){c=a;return}o[i>>2]=o[t+8>>2];te(n|0,88,i|0)|0;Xt(10,n|0)|0;c=a;return}function ke(t){t=t|0;var e=0;e=c;ur(t);c=e;return}function Se(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0;i=c;c=c+16|0;a=i;s=i+8|0;if((r[e>>0]|0)!=45){d=0;c=i;return d|0}h=e+1|0;n=t+4|0;l=o[n>>2]|0;u=r[l>>0]|0;t:do{if(u<<24>>24){f=0;while(1){d=f;f=f+1|0;if((r[h>>0]|0)!=u<<24>>24){t=0;break}u=r[l+f>>0]|0;h=e+(d+2)|0;if(!(u<<24>>24))break t}c=i;return t|0}}while(0);if((r[h>>0]|0)!=61){d=0;c=i;return d|0}e=h+1|0;l=Zr(e,s,10)|0;if(!(o[s>>2]|0)){d=0;c=i;return d|0}if((l|0)>(o[t+24>>2]|0)){d=o[v>>2]|0;f=o[n>>2]|0;o[a>>2]=e;o[a+4>>2]=f;te(d|0,416,a|0)|0;re(1)}if((l|0)<(o[t+20>>2]|0)){d=o[v>>2]|0;f=o[n>>2]|0;o[a>>2]=e;o[a+4>>2]=f;te(d|0,472,a|0)|0;re(1)}o[t+28>>2]=l;d=1;c=i;return d|0}function Me(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0;i=c;c=c+16|0;r=i;n=o[v>>2]|0;s=o[t+16>>2]|0;o[r>>2]=o[t+4>>2];o[r+4>>2]=s;te(n|0,336,r|0)|0;s=o[t+20>>2]|0;if((s|0)==-2147483648)Jt(360,4,1,n|0)|0;else{o[r>>2]=s;te(n|0,368,r|0)|0}Jt(376,4,1,n|0)|0;s=o[t+24>>2]|0;if((s|0)==2147483647)Jt(384,4,1,n|0)|0;else{o[r>>2]=s;te(n|0,368,r|0)|0}o[r>>2]=o[t+28>>2];te(n|0,392,r|0)|0;if(!e){c=i;return}o[r>>2]=o[t+8>>2];te(n|0,88,r|0)|0;Xt(10,n|0)|0;c=i;return}function Ae(t){t=t|0;var e=0,i=0,n=0,s=0,a=0;s=c;o[t>>2]=1816;n=t+4|0;i=t+32|0;a=t+48|0;o[n+0>>2]=0;o[n+4>>2]=0;o[n+8>>2]=0;o[n+12>>2]=0;o[n+16>>2]=0;o[n+20>>2]=0;o[i+0>>2]=0;o[i+4>>2]=0;o[i+8>>2]=0;o[i+12>>2]=0;h[a>>3]=+h[75];h[t+56>>3]=+h[89];h[t+64>>3]=+h[103];h[t+72>>3]=+h[123];r[t+80>>0]=r[1364]|0;o[t+84>>2]=o[269];o[t+88>>2]=o[297];r[t+92>>0]=0;r[t+93>>0]=r[1292]|0;h[t+96>>3]=+h[204];o[t+104>>2]=o[439];o[t+108>>2]=o[359];h[t+112>>3]=+h[191];h[t+120>>3]=.3333333333333333;h[t+128>>3]=1.1;o[t+136>>2]=100;h[t+144>>3]=1.5;a=t+316|0;o[t+332>>2]=0;o[t+336>>2]=0;o[t+340>>2]=0;o[t+348>>2]=0;o[t+352>>2]=0;o[t+356>>2]=0;o[t+364>>2]=0;o[t+368>>2]=0;o[t+372>>2]=0;o[t+380>>2]=0;o[t+384>>2]=0;o[t+388>>2]=0;o[t+396>>2]=0;o[t+400>>2]=0;o[t+404>>2]=0;i=t+544|0;o[t+412>>2]=0;o[t+416>>2]=0;o[t+420>>2]=0;o[t+428>>2]=0;o[t+432>>2]=0;o[t+436>>2]=0;o[t+444>>2]=0;o[t+448>>2]=0;o[t+452>>2]=0;on(t+152|0,0,176)|0;o[t+456>>2]=i;n=t+460|0;o[n+0>>2]=0;o[n+4>>2]=0;o[n+8>>2]=0;o[n+12>>2]=0;o[n+16>>2]=0;o[n+20>>2]=0;o[t+488>>2]=a;r[t+492>>0]=1;h[t+496>>3]=1.0;h[t+504>>3]=1.0;o[t+512>>2]=0;o[t+516>>2]=-1;a=t+520|0;n=t+536|0;o[a+0>>2]=0;o[a+4>>2]=0;o[a+8>>2]=0;o[a+12>>2]=0;r[n>>0]=1;n=t+540|0;o[n+0>>2]=0;o[n+4>>2]=0;o[n+8>>2]=0;o[n+12>>2]=0;o[n+16>>2]=0;ti(i,1048576);r[t+560>>0]=0;i=t+604|0;n=t+664|0;a=t+564|0;e=a+36|0;do{o[a>>2]=0;a=a+4|0}while((a|0)<(e|0));a=i+0|0;e=a+36|0;do{o[a>>2]=0;a=a+4|0}while((a|0)<(e|0));a=t+680|0;o[n+0>>2]=-1;o[n+4>>2]=-1;o[n+8>>2]=-1;o[n+12>>2]=-1;r[a>>0]=0;c=s;return}function Te(t){t=t|0;var e=0;e=c;Ce(t);ur(t);c=e;return}function Ce(t){t=t|0;var e=0,i=0,r=0;e=c;o[t>>2]=1816;i=t+628|0;r=o[i>>2]|0;if(r){o[t+632>>2]=0;Br(r);o[i>>2]=0;o[t+636>>2]=0}i=t+616|0;r=o[i>>2]|0;if(r){o[t+620>>2]=0;Br(r);o[i>>2]=0;o[t+624>>2]=0}i=t+604|0;r=o[i>>2]|0;if(r){o[t+608>>2]=0;Br(r);o[i>>2]=0;o[t+612>>2]=0}i=t+588|0;r=o[i>>2]|0;if(r){o[t+592>>2]=0;Br(r);o[i>>2]=0;o[t+596>>2]=0}i=t+576|0;r=o[i>>2]|0;if(r){o[t+580>>2]=0;Br(r);o[i>>2]=0;o[t+584>>2]=0}i=t+564|0;r=o[i>>2]|0;if(r){o[t+568>>2]=0;Br(r);o[i>>2]=0;o[t+572>>2]=0}i=o[t+544>>2]|0;if(i)Br(i);i=t+472|0;r=o[i>>2]|0;if(r){o[t+476>>2]=0;Br(r);o[i>>2]=0;o[t+480>>2]=0}i=t+460|0;r=o[i>>2]|0;if(r){o[t+464>>2]=0;Br(r);o[i>>2]=0;o[t+468>>2]=0}ei(t+412|0);i=t+396|0;r=o[i>>2]|0;if(r){o[t+400>>2]=0;Br(r);o[i>>2]=0;o[t+404>>2]=0}i=t+380|0;r=o[i>>2]|0;if(r){o[t+384>>2]=0;Br(r);o[i>>2]=0;o[t+388>>2]=0}r=t+364|0;i=o[r>>2]|0;if(i){o[t+368>>2]=0;Br(i);o[r>>2]=0;o[t+372>>2]=0}i=t+348|0;r=o[i>>2]|0;if(r){o[t+352>>2]=0;Br(r);o[i>>2]=0;o[t+356>>2]=0}i=t+332|0;r=o[i>>2]|0;if(r){o[t+336>>2]=0;Br(r);o[i>>2]=0;o[t+340>>2]=0}i=t+316|0;r=o[i>>2]|0;if(r){o[t+320>>2]=0;Br(r);o[i>>2]=0;o[t+324>>2]=0}i=t+304|0;r=o[i>>2]|0;if(r){o[t+308>>2]=0;Br(r);o[i>>2]=0;o[t+312>>2]=0}i=t+292|0;r=o[i>>2]|0;if(r){o[t+296>>2]=0;Br(r);o[i>>2]=0;o[t+300>>2]=0}i=t+280|0;r=o[i>>2]|0;if(r){o[t+284>>2]=0;Br(r);o[i>>2]=0;o[t+288>>2]=0}i=t+268|0;r=o[i>>2]|0;if(r){o[t+272>>2]=0;Br(r);o[i>>2]=0;o[t+276>>2]=0}i=t+256|0;r=o[i>>2]|0;if(r){o[t+260>>2]=0;Br(r);o[i>>2]=0;o[t+264>>2]=0}i=t+32|0;r=o[i>>2]|0;if(r){o[t+36>>2]=0;Br(r);o[i>>2]=0;o[t+40>>2]=0}i=t+16|0;r=o[i>>2]|0;if(r){o[t+20>>2]=0;Br(r);o[i>>2]=0;o[t+24>>2]=0}r=t+4|0;i=o[r>>2]|0;if(!i){c=e;return}o[t+8>>2]=0;Br(i);o[r>>2]=0;o[t+12>>2]=0;c=e;return}function xe(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,a=0,l=0,u=0.0,f=0,d=0,m=0,p=0,g=0,_=0;n=c;c=c+16|0;l=n+4|0;a=n;s=t+580|0;f=o[s>>2]|0;if((f|0)>0){m=f+-1|0;p=o[(o[t+576>>2]|0)+(m<<2)>>2]|0;o[s>>2]=m;s=p}else{p=t+540|0;s=o[p>>2]|0;o[p>>2]=s+1}f=t+412|0;p=s<<1;o[l>>2]=p;ii(f,l);o[a>>2]=p|1;ii(f,a);l=t+332|0;f=r[544]|0;a=s+1|0;ri(l,a);r[(o[l>>2]|0)+s>>0]=f;l=t+396|0;f=t+400|0;if((o[f>>2]|0)<(a|0)){m=t+404|0;p=o[m>>2]|0;if((p|0)<(a|0)){g=s+2-p&-2;d=(p>>1)+2&-2;d=(g|0)>(d|0)?g:d;if((d|0)>(2147483647-p|0)){g=St(1)|0;Yt(g|0,48,0)}_=o[l>>2]|0;g=d+p|0;o[m>>2]=g;g=Ur(_,g<<3)|0;o[l>>2]=g;if((g|0)==0?(o[(Wt()|0)>>2]|0)==12:0){_=St(1)|0;Yt(_|0,48,0)}}m=o[f>>2]|0;if((m|0)<(a|0))do{d=(o[l>>2]|0)+(m<<3)|0;if(d){_=d;o[_>>2]=0;o[_+4>>2]=0}m=m+1|0}while((m|0)!=(a|0));o[f>>2]=a}f=(o[l>>2]|0)+(s<<3)|0;o[f>>2]=-1;o[f+4>>2]=0;f=t+316|0;if(!(r[t+93>>0]|0))u=0.0;else{_=t+72|0;u=+h[_>>3]*1389796.0;u=u-+(~~(u/2147483647.0)|0)*2147483647.0;h[_>>3]=u;u=u/2147483647.0*1.0e-5}l=t+320|0;if((o[l>>2]|0)<(a|0)){d=t+324|0;m=o[d>>2]|0;if((m|0)<(a|0)){_=s+2-m&-2;p=(m>>1)+2&-2;p=(_|0)>(p|0)?_:p;if((p|0)>(2147483647-m|0)){_=St(1)|0;Yt(_|0,48,0)}g=o[f>>2]|0;_=p+m|0;o[d>>2]=_;_=Ur(g,_<<3)|0;o[f>>2]=_;if((_|0)==0?(o[(Wt()|0)>>2]|0)==12:0){_=St(1)|0;Yt(_|0,48,0)}}p=o[l>>2]|0;if((p|0)<(a|0)){d=o[f>>2]|0;do{m=d+(p<<3)|0;if(m)h[m>>3]=0.0;p=p+1|0}while((p|0)!=(a|0))}o[l>>2]=a}h[(o[f>>2]|0)+(s<<3)>>3]=u;ni(t+588|0,s,0);ni(t+348|0,s,1);l=t+364|0;e=r[e>>0]|0;ri(l,a);r[(o[l>>2]|0)+s>>0]=e;l=t+380|0;e=t+384|0;if((o[e>>2]|0)<(a|0)){f=t+388|0;m=o[f>>2]|0;if((m|0)<(a|0)){_=s+2-m&-2;d=(m>>1)+2&-2;d=(_|0)>(d|0)?_:d;if((d|0)>(2147483647-m|0)){_=St(1)|0;Yt(_|0,48,0)}g=o[l>>2]|0;_=d+m|0;o[f>>2]=_;_=Ur(g,_)|0;o[l>>2]=_;if((_|0)==0?(o[(Wt()|0)>>2]|0)==12:0){_=St(1)|0;Yt(_|0,48,0)}}f=o[e>>2]|0;if((f|0)<(a|0))do{d=(o[l>>2]|0)+f|0;if(d)r[d>>0]=0;f=f+1|0}while((f|0)!=(a|0));o[e>>2]=a}e=t+288|0;l=o[e>>2]|0;if((l|0)<(a|0)){_=s+2-l&-2;a=(l>>1)+2&-2;a=(_|0)>(a|0)?_:a;if((a|0)>(2147483647-l|0)){_=St(1)|0;Yt(_|0,48,0)}g=t+280|0;p=o[g>>2]|0;_=a+l|0;o[e>>2]=_;_=Ur(p,_<<2)|0;o[g>>2]=_;if((_|0)==0?(o[(Wt()|0)>>2]|0)==12:0){_=St(1)|0;Yt(_|0,48,0)}}a=t+380|0;e=(o[a>>2]|0)+s|0;l=(r[e>>0]|0)==0;if(i){if(l){_=t+200|0;g=_;g=ln(o[g>>2]|0,o[g+4>>2]|0,1,0)|0;o[_>>2]=g;o[_+4>>2]=N}}else if(!l){_=t+200|0;g=_;g=ln(o[g>>2]|0,o[g+4>>2]|0,-1,-1)|0;o[_>>2]=g;o[_+4>>2]=N}r[e>>0]=i&1;i=t+460|0;if((o[t+476>>2]|0)>(s|0)?(o[(o[t+472>>2]|0)+(s<<2)>>2]|0)>-1:0){c=n;return s|0}if(!(r[(o[a>>2]|0)+s>>0]|0)){c=n;return s|0}oi(i,s);c=n;return s|0}function Re(t,e){t=t|0;e=e|0;var i=0,n=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0;i=c;c=c+16|0;u=i+1|0;l=i;n=t+492|0;if(!(r[n>>0]|0)){v=0;c=i;return v|0}v=o[e>>2]|0;a=e+4|0;h=o[a>>2]|0;r[u+0>>0]=r[l+0>>0]|0;li(v,h,u);h=o[a>>2]|0;t:do{if((h|0)>0){u=t+332|0;l=r[528]|0;f=0;d=0;p=-2;while(1){v=o[e>>2]|0;m=o[v+(f<<2)>>2]|0;_=s[(o[u>>2]|0)+(m>>1)>>0]|0;b=_^m&1;g=b&255;y=l&255;if((m|0)==(p^1|0)?1:(g<<24>>24==l<<24>>24&(y>>>1^1)|y&2&b|0)!=0){t=1;break}b=r[536]|0;y=b&255;if((m|0)!=(p|0)?((y>>>1^1)&g<<24>>24==b<<24>>24|_&2&y|0)==0:0){o[v+(d<<2)>>2]=m;h=o[a>>2]|0;d=d+1|0}else m=p;f=f+1|0;if((f|0)<(h|0))p=m;else break t}c=i;return t|0}else{f=0;d=0}}while(0);l=f-d|0;if((l|0)>0){h=h-l|0;o[a>>2]=h}if(!h){r[n>>0]=0;y=0;c=i;return y|0}else if((h|0)==1){b=o[o[e>>2]>>2]|0;v=b>>1;r[(o[t+332>>2]|0)+v>>0]=(b&1^1)&255^1;y=o[t+296>>2]|0;v=(o[t+396>>2]|0)+(v<<3)|0;o[v>>2]=-1;o[v+4>>2]=y;v=t+284|0;y=o[v>>2]|0;o[v>>2]=y+1;o[(o[t+280>>2]|0)+(y<<2)>>2]=b;y=(Le(t)|0)==-1;r[n>>0]=y&1;c=i;return y|0}else{e=ui(t+544|0,e,0)|0;a=t+256|0;n=t+260|0;u=o[n>>2]|0;l=t+264|0;if((u|0)==(o[l>>2]|0)){h=(u>>1)+2&-2;h=(h|0)<2?2:h;if((h|0)>(2147483647-u|0)){y=St(1)|0;Yt(y|0,48,0)}b=o[a>>2]|0;y=h+u|0;o[l>>2]=y;y=Ur(b,y<<2)|0;o[a>>2]=y;if((y|0)==0?(o[(Wt()|0)>>2]|0)==12:0){y=St(1)|0;Yt(y|0,48,0)}u=o[n>>2]|0}o[n>>2]=u+1;n=(o[a>>2]|0)+(u<<2)|0;if(n)o[n>>2]=e;Pe(t,e);y=1;c=i;return y|0}return 0}function Oe(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0;n=o[e>>2]|0;e=n>>1;r[(o[t+332>>2]|0)+e>>0]=(n&1^1)&255^1;s=o[t+296>>2]|0;e=(o[t+396>>2]|0)+(e<<3)|0;o[e>>2]=i;o[e+4>>2]=s;i=t+284|0;e=o[i>>2]|0;o[i>>2]=e+1;o[(o[t+280>>2]|0)+(e<<2)>>2]=n;return}function Le(t){t=t|0;var e=0,i=0,n=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0,k=0,S=0,M=0,A=0,T=0,C=0,x=0,R=0,O=0,L=0,P=0,I=0,F=0,D=0,V=0,B=0,U=0,K=0;u=c;c=c+16|0;_=u;a=t+512|0;b=o[a>>2]|0;g=t+284|0;if((b|0)>=(o[g>>2]|0)){V=0;F=0;U=-1;B=t+184|0;P=B;D=P;D=o[D>>2]|0;P=P+4|0;P=o[P>>2]|0;P=ln(D|0,P|0,V|0,F|0)|0;D=N;I=B;o[I>>2]=P;B=B+4|0;o[B>>2]=D;B=t+520|0;D=B;I=D;I=o[I>>2]|0;D=D+4|0;D=o[D>>2]|0;F=nn(I|0,D|0,V|0,F|0)|0;V=N;D=B;o[D>>2]=F;B=B+4|0;o[B>>2]=V;c=u;return U|0}m=t+280|0;l=t+428|0;n=t+412|0;h=t+332|0;f=t+544|0;d=_+4|0;e=t+396|0;p=t+296|0;i=t+456|0;M=-1;v=0;do{o[a>>2]=b+1;E=o[(o[m>>2]|0)+(b<<2)>>2]|0;if(r[(o[l>>2]|0)+E>>0]|0){y=o[n>>2]|0;b=y+(E*12|0)+4|0;S=o[b>>2]|0;if((S|0)>0){y=y+(E*12|0)|0;w=0;k=0;do{T=o[y>>2]|0;A=T+(w<<3)|0;if((o[(o[o[i>>2]>>2]|0)+(o[A>>2]<<2)>>2]&3|0)!=1){B=A;U=o[B+4>>2]|0;S=T+(k<<3)|0;o[S>>2]=o[B>>2];o[S+4>>2]=U;S=o[b>>2]|0;k=k+1|0}w=w+1|0}while((w|0)<(S|0))}else{w=0;k=0}y=w-k|0;if((y|0)>0)o[b>>2]=S-y;r[(o[l>>2]|0)+E>>0]=0}b=o[n>>2]|0;v=v+1|0;y=o[b+(E*12|0)>>2]|0;b=b+(E*12|0)+4|0;k=o[b>>2]|0;w=y+(k<<3)|0;t:do{if(!k){w=y;S=y}else{E=E^1;k=(k<<3)+-1|0;T=y;S=y;while(1){while(1){e:while(1){L=o[T+4>>2]|0;U=s[(o[h>>2]|0)+(L>>1)>>0]^L&1;I=r[528]|0;P=I&255;F=P&2;P=P>>>1^1;if((U&255)<<24>>24==I<<24>>24&P|F&U){R=19;break}A=o[T>>2]|0;R=o[f>>2]|0;O=R+(A<<2)|0;C=R+(A+1<<2)|0;x=o[C>>2]|0;if((x|0)==(E|0)){U=R+(A+2<<2)|0;x=o[U>>2]|0;o[C>>2]=x;o[U>>2]=E}C=T+8|0;o[_>>2]=A;o[d>>2]=x;if((x|0)!=(L|0)?(U=s[(o[h>>2]|0)+(x>>1)>>0]^x&1,((U&255)<<24>>24==I<<24>>24&P|F&U|0)!=0):0){R=27;break}F=o[O>>2]|0;if(F>>>0<=95){R=31;break}P=o[h>>2]|0;I=r[536]|0;L=I&255;U=L&2;L=L>>>1^1;B=2;while(1){D=O+(B<<2)+4|0;V=o[D>>2]|0;K=s[P+(V>>1)>>0]^V&1;B=B+1|0;if(!((K&255)<<24>>24==I<<24>>24&L|U&K))break;if((B|0)>=(F>>>5|0)){R=32;break e}}K=R+(A+2<<2)|0;o[K>>2]=V;o[D>>2]=E;hi((o[n>>2]|0)+((o[K>>2]^1)*12|0)|0,_);if((C|0)==(w|0))break t;else T=C}if((R|0)==19){R=0;B=T;U=o[B+4>>2]|0;K=S;o[K>>2]=o[B>>2];o[K+4>>2]=U;T=T+8|0;S=S+8|0}else if((R|0)==27){R=0;U=_;K=o[U+4>>2]|0;T=S;o[T>>2]=o[U>>2];o[T+4>>2]=K;T=C;S=S+8|0}else if((R|0)==31){I=r[536]|0;R=32}if((R|0)==32){R=S+8|0;O=_;P=o[O+4>>2]|0;L=S;o[L>>2]=o[O>>2];o[L+4>>2]=P;L=x>>1;P=x&1;O=(o[h>>2]|0)+L|0;K=s[O>>0]^P;U=I&255;if((K&255)<<24>>24==I<<24>>24&(U>>>1^1)|U&2&K)break;r[O>>0]=(P^1)&255^1;S=o[p>>2]|0;T=(o[e>>2]|0)+(L<<3)|0;o[T>>2]=A;o[T+4>>2]=S;T=o[g>>2]|0;o[g>>2]=T+1;o[(o[m>>2]|0)+(T<<2)>>2]=x;T=C;S=R}if((T|0)==(w|0))break t}o[a>>2]=o[g>>2];if(C>>>0<w>>>0){M=(y+(k-C)|0)>>>3;while(1){B=C;C=C+8|0;U=o[B+4>>2]|0;K=R;o[K>>2]=o[B>>2];o[K+4>>2]=U;if(C>>>0>=w>>>0)break;else R=R+8|0}T=T+(M+2<<3)|0;S=S+(M+2<<3)|0}else{T=C;S=R}if((T|0)==(w|0)){M=A;break}else M=A}}}while(0);y=w-S|0;if((y|0)>0)o[b>>2]=(o[b>>2]|0)-(y>>3);b=o[a>>2]|0}while((b|0)<(o[g>>2]|0));B=v;D=((v|0)<0)<<31>>31;K=M;U=t+184|0;I=U;V=I;V=o[V>>2]|0;I=I+4|0;I=o[I>>2]|0;I=ln(V|0,I|0,B|0,D|0)|0;V=N;F=U;o[F>>2]=I;U=U+4|0;o[U>>2]=V;U=t+520|0;V=U;F=V;F=o[F>>2]|0;V=V+4|0;V=o[V>>2]|0;D=nn(F|0,V|0,B|0,D|0)|0;B=N;V=U;o[V>>2]=D;U=U+4|0;o[U>>2]=B;c=u;return K|0}function Pe(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0;i=c;c=c+16|0;u=i+8|0;n=i;s=o[t+544>>2]|0;r=s+(e<<2)|0;a=s+(e+1<<2)|0;l=t+412|0;h=(o[l>>2]|0)+((o[a>>2]^1)*12|0)|0;s=s+(e+2<<2)|0;f=o[s>>2]|0;o[u>>2]=e;o[u+4>>2]=f;hi(h,u);s=(o[l>>2]|0)+((o[s>>2]^1)*12|0)|0;a=o[a>>2]|0;o[n>>2]=e;o[n+4>>2]=a;hi(s,n);if(!(o[r>>2]&4)){f=t+208|0;h=f;h=ln(o[h>>2]|0,o[h+4>>2]|0,1,0)|0;o[f>>2]=h;o[f+4>>2]=N;f=t+224|0;h=f;h=ln((o[r>>2]|0)>>>5|0,0,o[h>>2]|0,o[h+4>>2]|0)|0;o[f>>2]=h;o[f+4>>2]=N;c=i;return}else{f=t+216|0;h=f;h=ln(o[h>>2]|0,o[h+4>>2]|0,1,0)|0;o[f>>2]=h;o[f+4>>2]=N;f=t+232|0;h=f;h=ln((o[r>>2]|0)>>>5|0,0,o[h>>2]|0,o[h+4>>2]|0)|0;o[f>>2]=h;o[f+4>>2]=N;c=i;return}}function Ne(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0;s=c;c=c+16|0;h=s+4|0;l=s;a=o[t+544>>2]|0;n=a+(e<<2)|0;u=o[a+(e+1<<2)>>2]^1;if(!i){o[h>>2]=u;i=t+428|0;f=o[i>>2]|0;u=f+u|0;if(!(r[u>>0]|0)){r[u>>0]=1;si(t+444|0,h);f=o[i>>2]|0}e=o[a+(e+2<<2)>>2]^1;o[l>>2]=e;e=f+e|0;if(!(r[e>>0]|0)){r[e>>0]=1;si(t+444|0,l)}}else{l=t+412|0;i=o[l>>2]|0;h=i+(u*12|0)|0;a=a+(e+2<<2)|0;u=i+(u*12|0)+4|0;f=o[u>>2]|0;t:do{if((f|0)>0){p=o[h>>2]|0;m=0;while(1){d=m+1|0;if((o[p+(m<<3)>>2]|0)==(e|0)){d=m;break t}if((d|0)<(f|0))m=d;else break}}else d=0}while(0);f=f+-1|0;if((d|0)<(f|0)){do{i=o[h>>2]|0;f=d;d=d+1|0;m=i+(d<<3)|0;p=o[m+4>>2]|0;f=i+(f<<3)|0;o[f>>2]=o[m>>2];o[f+4>>2]=p;f=(o[u>>2]|0)+-1|0}while((d|0)<(f|0));i=o[l>>2]|0}o[u>>2]=f;l=o[a>>2]^1;a=i+(l*12|0)|0;l=i+(l*12|0)+4|0;u=o[l>>2]|0;t:do{if((u|0)>0){i=o[a>>2]|0;f=0;while(1){h=f+1|0;if((o[i+(f<<3)>>2]|0)==(e|0)){h=f;break t}if((h|0)<(u|0))f=h;else break}}else h=0}while(0);e=u+-1|0;if((h|0)<(e|0))do{d=o[a>>2]|0;e=h;h=h+1|0;m=d+(h<<3)|0;p=o[m+4>>2]|0;e=d+(e<<3)|0;o[e>>2]=o[m>>2];o[e+4>>2]=p;e=(o[l>>2]|0)+-1|0}while((h|0)<(e|0));o[l>>2]=e}if(!(o[n>>2]&4)){p=t+208|0;m=p;m=ln(o[m>>2]|0,o[m+4>>2]|0,-1,-1)|0;o[p>>2]=m;o[p+4>>2]=N;p=t+224|0;m=p;m=nn(o[m>>2]|0,o[m+4>>2]|0,(o[n>>2]|0)>>>5|0,0)|0;o[p>>2]=m;o[p+4>>2]=N;c=s;return}else{p=t+216|0;m=p;m=ln(o[m>>2]|0,o[m+4>>2]|0,-1,-1)|0;o[p>>2]=m;o[p+4>>2]=N;p=t+232|0;m=p;m=nn(o[m>>2]|0,o[m+4>>2]|0,(o[n>>2]|0)>>>5|0,0)|0;o[p>>2]=m;o[p+4>>2]=N;c=s;return}}function Ie(t,e){t=t|0;e=e|0;var i=0,n=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0;a=c;n=t+544|0;f=o[n>>2]|0;i=f+(e<<2)|0;Ne(t,e,0);f=o[f+(e+1<<2)>>2]|0;l=f>>1;f=(s[(o[t+332>>2]|0)+l>>0]|0)^f&1;m=r[528]|0;d=m&255;if((((f&255)<<24>>24==m<<24>>24&(d>>>1^1)|d&2&f|0)!=0?(u=(o[t+396>>2]|0)+(l<<3)|0,h=o[u>>2]|0,(h|0)!=-1):0)?((o[n>>2]|0)+(h<<2)|0)==(i|0):0)o[u>>2]=-1;o[i>>2]=o[i>>2]&-4|1;d=o[(o[n>>2]|0)+(e<<2)>>2]|0;m=t+556|0;o[m>>2]=((((d>>>3&1)+(d>>>5)<<2)+4|0)>>>2)+(o[m>>2]|0);c=a;return}function Fe(t,e){t=t|0;e=e|0;var i=0,n=0,a=0,l=0,u=0,h=0,f=0;i=c;n=o[e>>2]|0;if(n>>>0<=31){h=0;c=i;return h|0}a=o[t+332>>2]|0;l=r[528]|0;u=l&255;h=u&2;u=u>>>1^1;t=0;while(1){f=o[e+(t<<2)+4>>2]|0;f=(s[a+(f>>1)>>0]|0)^f&1;t=t+1|0;if((f&255)<<24>>24==l<<24>>24&u|h&f){n=1;e=5;break}if((t|0)>=(n>>>5|0)){n=0;e=5;break}}if((e|0)==5){c=i;return n|0}return 0}function De(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0;s=c;i=t+296|0;if((o[i>>2]|0)<=(e|0)){c=s;return}n=t+284|0;v=o[n>>2]|0;l=t+292|0;b=o[l>>2]|0;y=o[b+(e<<2)>>2]|0;if((v|0)>(y|0)){_=t+280|0;f=t+332|0;h=t+88|0;u=t+348|0;d=t+460|0;p=t+476|0;g=t+472|0;m=t+380|0;do{v=v+-1|0;y=o[(o[_>>2]|0)+(v<<2)>>2]>>1;r[(o[f>>2]|0)+y>>0]=r[544]|0;b=o[h>>2]|0;if((b|0)<=1){if((b|0)==1?(v|0)>(o[(o[l>>2]|0)+((o[i>>2]|0)+-1<<2)>>2]|0):0)a=7}else a=7;if((a|0)==7){a=0;r[(o[u>>2]|0)+y>>0]=o[(o[_>>2]|0)+(v<<2)>>2]&1}if(!((o[p>>2]|0)>(y|0)?(o[(o[g>>2]|0)+(y<<2)>>2]|0)>-1:0))a=11;if((a|0)==11?(a=0,(r[(o[m>>2]|0)+y>>0]|0)!=0):0)oi(d,y);b=o[l>>2]|0;y=o[b+(e<<2)>>2]|0}while((v|0)>(y|0));v=o[n>>2]|0}o[t+512>>2]=y;t=o[b+(e<<2)>>2]|0;if((v-t|0)>0)o[n>>2]=t;if(((o[i>>2]|0)-e|0)<=0){c=s;return}o[i>>2]=e;c=s;return}function Ve(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0,u=0,f=0,d=0,m=0,p=0,g=0.0,_=0;e=c;n=t+72|0;g=+h[n>>3]*1389796.0;g=g-+(~~(g/2147483647.0)|0)*2147483647.0;h[n>>3]=g;u=t+464|0;if(g/2147483647.0<+h[t+64>>3]?(f=o[u>>2]|0,(f|0)!=0):0){g=g*1389796.0;g=g-+(~~(g/2147483647.0)|0)*2147483647.0;h[n>>3]=g;f=o[(o[t+460>>2]|0)+(~~(+(f|0)*(g/2147483647.0))<<2)>>2]|0;m=r[(o[t+332>>2]|0)+f>>0]|0;d=r[544]|0;p=d&255;if(((p>>>1^1)&m<<24>>24==d<<24>>24|m&2&p|0)!=0?(r[(o[t+380>>2]|0)+f>>0]|0)!=0:0){p=t+176|0;m=p;m=ln(o[m>>2]|0,o[m+4>>2]|0,1,0)|0;o[p>>2]=m;o[p+4>>2]=N}}else f=-1;d=t+460|0;p=t+332|0;m=t+380|0;while(1){if(((f|0)!=-1?(_=r[(o[p>>2]|0)+f>>0]|0,a=r[544]|0,i=a&255,s=i>>>1^1,(s&_<<24>>24==a<<24>>24|_&2&i|0)!=0):0)?(r[(o[m>>2]|0)+f>>0]|0)!=0:0)break;if(!(o[u>>2]|0)){i=-2;l=17;break}f=ci(d)|0}if((l|0)==17){c=e;return i|0}u=r[(o[t+364>>2]|0)+f>>0]|0;l=u&255;if(!(s&u<<24>>24==a<<24>>24|i&2&l)){p=r[528]|0;_=p&255;_=((_>>>1^1)&u<<24>>24==p<<24>>24|l&2&_|0)!=0|f<<1;c=e;return _|0}if(!(r[t+92>>0]|0)){_=(r[(o[t+348>>2]|0)+f>>0]|0)!=0|f<<1;c=e;return _|0}else{g=+h[n>>3]*1389796.0;g=g-+(~~(g/2147483647.0)|0)*2147483647.0;h[n>>3]=g;_=g/2147483647.0<.5|f<<1;c=e;return _|0}return 0}function Be(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,a=0,l=0,f=0,d=0,m=0,p=0,g=0,_=0.0,v=0,b=0,y=0,w=0,E=0,k=0,S=0,M=0,A=0,T=0,C=0,x=0,R=0,O=0,L=0,P=0,I=0,F=0,D=0,V=0,B=0,U=0,K=0,H=0,W=0,z=0,q=0.0,j=0;s=c;c=c+16|0;p=s+8|0;b=s+4|0;d=s;f=i+4|0;a=o[f>>2]|0;l=i+8|0;if((a|0)==(o[l>>2]|0)){g=(a>>1)+2&-2;g=(g|0)<2?2:g;if((g|0)>(2147483647-a|0)){z=St(1)|0;Yt(z|0,48,0)}W=o[i>>2]|0;z=g+a|0;o[l>>2]=z;z=Ur(W,z<<2)|0;o[i>>2]=z;if((z|0)==0?(o[(Wt()|0)>>2]|0)==12:0){z=St(1)|0;Yt(z|0,48,0)}a=o[f>>2]|0}l=(o[i>>2]|0)+(a<<2)|0;if(l){o[l>>2]=0;a=o[f>>2]|0}o[f>>2]=a+1;g=t+544|0;L=t+280|0;a=t+588|0;l=t+396|0;C=t+504|0;R=t+316|0;x=t+540|0;T=t+476|0;A=t+472|0;M=t+460|0;S=t+488|0;k=t+296|0;w=t+496|0;E=t+272|0;O=t+268|0;I=-2;P=(o[t+284>>2]|0)+-1|0;F=0;do{D=o[g>>2]|0;e=D+(e<<2)|0;V=o[e>>2]|0;if((V&4|0)!=0?(_=+h[w>>3],z=e+(V>>>5<<2)+4|0,q=_+ +u[z>>2],u[z>>2]=q,q>1.0e20):0){U=o[E>>2]|0;if((U|0)>0){B=o[O>>2]|0;V=0;do{z=D+(o[B+(V<<2)>>2]<<2)|0;z=z+((o[z>>2]|0)>>>5<<2)+4|0;u[z>>2]=+u[z>>2]*1.0e-20;V=V+1|0}while((V|0)!=(U|0))}h[w>>3]=_*1.0e-20}I=(I|0)!=-2&1;if(I>>>0<(o[e>>2]|0)>>>5>>>0)do{V=o[e+(I<<2)+4>>2]|0;o[b>>2]=V;V=V>>1;D=(o[a>>2]|0)+V|0;do{if((r[D>>0]|0)==0?(o[(o[l>>2]|0)+(V<<3)+4>>2]|0)>0:0){U=o[R>>2]|0;z=U+(V<<3)|0;q=+h[C>>3]+ +h[z>>3];h[z>>3]=q;if(q>1.0e+100){K=o[x>>2]|0;if((K|0)>0){B=0;do{z=U+(B<<3)|0;h[z>>3]=+h[z>>3]*1.0e-100;B=B+1|0}while((B|0)!=(K|0))}h[C>>3]=+h[C>>3]*1.0e-100}if((o[T>>2]|0)>(V|0)?(y=o[A>>2]|0,v=o[y+(V<<2)>>2]|0,(v|0)>-1):0){B=o[M>>2]|0;U=o[B+(v<<2)>>2]|0;t:do{if(!v)W=0;else{z=v;while(1){W=z;z=z+-1>>1;H=B+(z<<2)|0;K=o[H>>2]|0;j=o[o[S>>2]>>2]|0;if(!(+h[j+(U<<3)>>3]>+h[j+(K<<3)>>3]))break t;o[B+(W<<2)>>2]=K;o[y+(o[H>>2]<<2)>>2]=W;if(!z){W=0;break}}}}while(0);o[B+(W<<2)>>2]=U;o[y+(U<<2)>>2]=W}r[D>>0]=1;if((o[(o[l>>2]|0)+(V<<3)+4>>2]|0)<(o[k>>2]|0)){si(i,b);break}else{F=F+1|0;break}}}while(0);I=I+1|0}while((I|0)<((o[e>>2]|0)>>>5|0));e=o[L>>2]|0;D=o[a>>2]|0;do{I=P;P=P+-1|0;I=o[e+(I<<2)>>2]|0;B=I>>1;V=D+B|0}while((r[V>>0]|0)==0);e=o[(o[l>>2]|0)+(B<<3)>>2]|0;r[V>>0]=0;F=F+-1|0}while((F|0)>0);o[o[i>>2]>>2]=I^1;b=t+616|0;w=o[b>>2]|0;v=t+620|0;if(!w)E=o[v>>2]|0;else{o[v>>2]=0;E=0}y=o[f>>2]|0;if((E|0)<(y|0)){S=t+624|0;k=o[S>>2]|0;if((k|0)<(y|0)){j=y+1-k&-2;E=(k>>1)+2&-2;E=(j|0)>(E|0)?j:E;if((E|0)>(2147483647-k|0)){j=St(1)|0;Yt(j|0,48,0)}j=E+k|0;o[S>>2]=j;w=Ur(w,j<<2)|0;o[b>>2]=w;if((w|0)==0?(o[(Wt()|0)>>2]|0)==12:0){j=St(1)|0;Yt(j|0,48,0)}}E=o[v>>2]|0;t:do{if((E|0)<(y|0))while(1){w=w+(E<<2)|0;if(w)o[w>>2]=0;E=E+1|0;if((E|0)==(y|0))break t;w=o[b>>2]|0}}while(0);o[v>>2]=y;y=o[f>>2]|0}if((y|0)>0){E=o[b>>2]|0;w=o[i>>2]|0;k=0;do{o[E+(k<<2)>>2]=o[w+(k<<2)>>2];k=k+1|0;y=o[f>>2]|0}while((k|0)<(y|0))}w=o[t+84>>2]|0;if((w|0)==1)if((y|0)>1){d=o[i>>2]|0;m=1;w=1;while(1){y=o[d+(m<<2)>>2]|0;p=o[l>>2]|0;E=o[p+(y>>1<<3)>>2]|0;t:do{if((E|0)!=-1){k=(o[g>>2]|0)+(E<<2)|0;S=o[k>>2]|0;if(S>>>0>63){E=o[a>>2]|0;M=1;while(1){j=o[k+(M<<2)+4>>2]>>1;if((r[E+j>>0]|0)==0?(o[p+(j<<3)+4>>2]|0)>0:0)break;M=M+1|0;if((M|0)>=(S>>>5|0))break t}o[d+(w<<2)>>2]=y;w=w+1|0}}else{o[d+(w<<2)>>2]=y;w=w+1|0}}while(0);m=m+1|0;p=o[f>>2]|0;if((m|0)>=(p|0)){d=p;break}}}else{d=y;m=1;w=1}else if((w|0)==2)if((y|0)>1){g=1;w=1;do{E=o[i>>2]|0;y=o[E+(g<<2)>>2]|0;if((o[(o[l>>2]|0)+(y>>1<<3)>>2]|0)!=-1){o[d>>2]=y;o[p+0>>2]=o[d+0>>2];if(!(Ue(t,p)|0)){y=o[i>>2]|0;E=y;y=o[y+(g<<2)>>2]|0;m=62}}else m=62;if((m|0)==62){m=0;o[E+(w<<2)>>2]=y;w=w+1|0}g=g+1|0;y=o[f>>2]|0}while((g|0)<(y|0));d=y;m=g}else{d=y;m=1;w=1}else{d=y;m=y;w=y}j=t+240|0;z=j;z=ln(o[z>>2]|0,o[z+4>>2]|0,d|0,((d|0)<0)<<31>>31|0)|0;o[j>>2]=z;o[j+4>>2]=N;m=m-w|0;if((m|0)>0){d=d-m|0;o[f>>2]=d}j=t+248|0;z=j;z=ln(o[z>>2]|0,o[z+4>>2]|0,d|0,((d|0)<0)<<31>>31|0)|0;o[j>>2]=z;o[j+4>>2]=N;if((d|0)==1)i=0;else{i=o[i>>2]|0;if((d|0)>2){t=o[l>>2]|0;f=2;m=1;do{m=(o[t+(o[i+(f<<2)>>2]>>1<<3)+4>>2]|0)>(o[t+(o[i+(m<<2)>>2]>>1<<3)+4>>2]|0)?f:m;f=f+1|0}while((f|0)<(d|0))}else m=1;z=i+(m<<2)|0;j=o[z>>2]|0;i=i+4|0;o[z>>2]=o[i>>2];o[i>>2]=j;i=o[(o[l>>2]|0)+(j>>1<<3)+4>>2]|0}o[n>>2]=i;if((o[v>>2]|0)>0)n=0;else{c=s;return}do{r[(o[a>>2]|0)+(o[(o[b>>2]|0)+(n<<2)>>2]>>1)>>0]=0;n=n+1|0}while((n|0)<(o[v>>2]|0));c=s;return}function Ue(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0;i=c;d=o[e>>2]|0;h=t+396|0;g=o[h>>2]|0;u=t+544|0;v=(o[u>>2]|0)+(o[g+(d>>1<<3)>>2]<<2)|0;a=t+604|0;n=t+608|0;if(o[a>>2]|0)o[n>>2]=0;s=t+588|0;l=t+612|0;t=t+616|0;m=1;while(1){if(m>>>0<(o[v>>2]|0)>>>5>>>0){_=o[v+(m<<2)+4>>2]|0;p=_>>1;if((o[g+(p<<3)+4>>2]|0)!=0?(f=r[(o[s>>2]|0)+p>>0]|0,(f+-1<<24>>24&255)>=2):0){v=o[n>>2]|0;b=(v|0)==(o[l>>2]|0);if(f<<24>>24==3?1:(o[g+(p<<3)>>2]|0)==-1){u=8;break}if(b){g=(v>>1)+2&-2;g=(g|0)<2?2:g;if((g|0)>(2147483647-v|0)){u=24;break}y=o[a>>2]|0;b=g+v|0;o[l>>2]=b;b=Ur(y,b<<3)|0;o[a>>2]=b;if((b|0)==0?(o[(Wt()|0)>>2]|0)==12:0){u=24;break}v=o[n>>2]|0}o[n>>2]=v+1;g=(o[a>>2]|0)+(v<<3)|0;if(g){y=g;o[y>>2]=m;o[y+4>>2]=d}o[e>>2]=_;v=o[h>>2]|0;d=_;g=v;v=(o[u>>2]|0)+(o[v+(p<<3)>>2]<<2)|0;m=0}}else{d=(o[s>>2]|0)+(d>>1)|0;if(!(r[d>>0]|0)){r[d>>0]=2;si(t,e)}d=o[n>>2]|0;if(!d){n=1;u=34;break}y=d+-1|0;d=o[a>>2]|0;m=o[d+(y<<3)>>2]|0;d=o[d+(y<<3)+4>>2]|0;o[e>>2]=d;g=o[h>>2]|0;v=(o[u>>2]|0)+(o[g+(d>>1<<3)>>2]<<2)|0;o[n>>2]=y}m=m+1|0}if((u|0)==8){if(b){u=(v>>1)+2&-2;u=(u|0)<2?2:u;if((u|0)>(2147483647-v|0)){y=St(1)|0;Yt(y|0,48,0)}b=o[a>>2]|0;y=u+v|0;o[l>>2]=y;y=Ur(b,y<<3)|0;o[a>>2]=y;if((y|0)==0?(o[(Wt()|0)>>2]|0)==12:0){y=St(1)|0;Yt(y|0,48,0)}v=o[n>>2]|0}l=v+1|0;o[n>>2]=l;u=(o[a>>2]|0)+(v<<3)|0;if(u){l=u;o[l>>2]=0;o[l+4>>2]=d;l=o[n>>2]|0}if((l|0)>0)u=0;else{y=0;c=i;return y|0}do{h=(o[s>>2]|0)+(o[(o[a>>2]|0)+(u<<3)+4>>2]>>1)|0;if(!(r[h>>0]|0)){r[h>>0]=3;si(t,(o[a>>2]|0)+(u<<3)+4|0);l=o[n>>2]|0}u=u+1|0}while((u|0)<(l|0));n=0;c=i;return n|0}else if((u|0)==24)Yt(St(1)|0,48,0);else if((u|0)==34){c=i;return n|0}return 0}function Ke(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0;l=c;c=c+32|0;a=l+16|0;s=l+12|0;u=l+8|0;n=l;d=i+20|0;h=i+16|0;if((o[d>>2]|0)>0){f=0;do{r[(o[i>>2]|0)+(o[(o[h>>2]|0)+(f<<2)>>2]|0)>>0]=0;f=f+1|0}while((f|0)<(o[d>>2]|0))}if(o[h>>2]|0)o[d>>2]=0;f=o[e>>2]|0;o[u>>2]=f;o[s>>2]=f;o[a+0>>2]=o[s+0>>2];fi(i,a,0);h=(o[i>>2]|0)+f|0;if(!(r[h>>0]|0)){r[h>>0]=1;si(i+16|0,u)}if(!(o[t+296>>2]|0)){c=l;return}e=f>>1;m=t+588|0;r[(o[m>>2]|0)+e>>0]=1;p=o[t+284>>2]|0;d=t+292|0;v=o[o[d>>2]>>2]|0;if((p|0)>(v|0)){u=t+280|0;h=t+396|0;f=i+16|0;t=t+544|0;do{p=p+-1|0;_=o[(o[u>>2]|0)+(p<<2)>>2]|0;g=_>>1;if(r[(o[m>>2]|0)+g>>0]|0){v=o[h>>2]|0;b=o[v+(g<<3)>>2]|0;t:do{if((b|0)==-1){_=_^1;o[n>>2]=_;o[s>>2]=_;o[a+0>>2]=o[s+0>>2];fi(i,a,0);_=(o[i>>2]|0)+_|0;if(!(r[_>>0]|0)){r[_>>0]=1;si(f,n)}}else{_=(o[t>>2]|0)+(b<<2)|0;b=o[_>>2]|0;if(b>>>0>63){y=1;while(1){w=o[_+(y<<2)+4>>2]>>1;if((o[v+(w<<3)+4>>2]|0)>0){r[(o[m>>2]|0)+w>>0]=1;b=o[_>>2]|0}y=y+1|0;if((y|0)>=(b>>>5|0))break t;v=o[h>>2]|0}}}}while(0);r[(o[m>>2]|0)+g>>0]=0;v=o[o[d>>2]>>2]|0}}while((p|0)>(v|0))}r[(o[m>>2]|0)+e>>0]=0;c=l;return}function He(t){t=t|0;var e=0,i=0,n=0,a=0,l=0,f=0,d=0.0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0,k=0,S=0,M=0;i=c;c=c+16|0;p=i+4|0;y=i;e=t+272|0;E=o[e>>2]|0;d=+h[t+496>>3]/+(E|0);a=t+544|0;l=t+268|0;w=o[l>>2]|0;o[y>>2]=a;o[p+0>>2]=o[y+0>>2];di(w,E,p);p=o[e>>2]|0;if((p|0)>0){f=t+332|0;m=t+396|0;g=0;w=0;do{b=o[l>>2]|0;y=o[b+(g<<2)>>2]|0;E=o[a>>2]|0;_=E+(y<<2)|0;v=o[_>>2]|0;do{if(v>>>0>95){k=o[E+(y+1<<2)>>2]|0;E=k>>1;k=(s[(o[f>>2]|0)+E>>0]|0)^k&1;M=r[528]|0;S=M&255;if(((k&255)<<24>>24==M<<24>>24&(S>>>1^1)|S&2&k|0)!=0?(M=o[(o[m>>2]|0)+(E<<3)>>2]|0,(M|0)!=-1&(M|0)==(y|0)):0){n=9;break}if((g|0)>=((p|0)/2|0|0)?!(+u[_+(v>>>5<<2)+4>>2]<d):0){n=9;break}Ie(t,y)}else n=9}while(0);if((n|0)==9){n=0;o[b+(w<<2)>>2]=y;w=w+1|0}g=g+1|0;p=o[e>>2]|0}while((g|0)<(p|0))}else{g=0;w=0}n=g-w|0;if((n|0)>0)o[e>>2]=p-n;if(!(+((o[t+556>>2]|0)>>>0)>+h[t+96>>3]*+((o[t+548>>2]|0)>>>0))){c=i;return}Hn[o[(o[t>>2]|0)+8>>2]&31](t);c=i;return}function We(t,e){t=t|0;e=e|0;var i=0,n=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0,k=0;i=c;n=e+4|0;f=o[n>>2]|0;if((f|0)>0){l=t+544|0;a=t+332|0;u=0;h=0;do{y=o[e>>2]|0;p=o[y+(u<<2)>>2]|0;f=(o[l>>2]|0)+(p<<2)|0;m=o[f>>2]|0;do{if(m>>>0>31){w=o[a>>2]|0;_=r[528]|0;g=_&255;E=g&2;g=g>>>1^1;v=m>>>5;b=0;do{k=o[f+(b<<2)+4>>2]|0;k=(s[w+(k>>1)>>0]|0)^k&1;b=b+1|0;if((k&255)<<24>>24==_<<24>>24&g|E&k){d=7;break}}while((b|0)<(v|0));if((d|0)==7){d=0;Ie(t,p);break}if(m>>>0>95){d=r[536]|0;g=m>>>5;p=2;do{_=f+(p<<2)+4|0;k=o[_>>2]|0;k=(s[(o[a>>2]|0)+(k>>1)>>0]|0)^k&1;E=d&255;if((k&255)<<24>>24==d<<24>>24&(E>>>1^1)|E&2&k){o[_>>2]=o[f+(g+-1<<2)+4>>2];m=o[f>>2]|0;if(m&8){m=m>>>5;o[f+(m+-1<<2)+4>>2]=o[f+(m<<2)+4>>2];m=o[f>>2]|0}m=m+-32|0;o[f>>2]=m;p=p+-1|0}p=p+1|0;g=m>>>5}while((p|0)<(g|0));p=o[e>>2]|0;y=p;p=o[p+(u<<2)>>2]|0;d=16}else d=16}else d=16}while(0);if((d|0)==16){d=0;o[y+(h<<2)>>2]=p;h=h+1|0}u=u+1|0;f=o[n>>2]|0}while((u|0)<(f|0))}else{u=0;h=0}e=u-h|0;if((e|0)<=0){c=i;return}o[n>>2]=f-e;c=i;return}function ze(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0;s=c;c=c+16|0;i=s+4|0;a=s;o[i>>2]=0;e=i+4|0;o[e>>2]=0;n=i+8|0;o[n>>2]=0;o[a>>2]=0;l=t+540|0;d=o[l>>2]|0;if((d|0)>0){h=t+380|0;u=t+332|0;f=0;do{if((r[(o[h>>2]|0)+f>>0]|0)!=0?(p=r[(o[u>>2]|0)+f>>0]|0,g=r[544]|0,m=g&255,((m>>>1^1)&p<<24>>24==g<<24>>24|p&2&m|0)!=0):0){ai(i,a);d=o[l>>2]|0}f=f+1|0;o[a>>2]=f}while((f|0)<(d|0))}mi(t+460|0,i);t=o[i>>2]|0;if(!t){c=s;return}o[e>>2]=0;Br(t);o[i>>2]=0;o[n>>2]=0;c=s;return}function qe(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0,u=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0;e=c;n=t+492|0;if((r[n>>0]|0)!=0?(Le(t)|0)==-1:0){n=t+284|0;s=t+516|0;if((o[n>>2]|0)==(o[s>>2]|0)){v=1;c=e;return v|0}a=t+520|0;v=a;_=o[v+4>>2]|0;if((_|0)>0|(_|0)==0&(o[v>>2]|0)>>>0>0){v=1;c=e;return v|0}We(t,t+268|0);if(r[t+536>>0]|0){We(t,t+256|0);u=t+564|0;l=t+568|0;if((o[l>>2]|0)>0){d=t+588|0;f=0;do{r[(o[d>>2]|0)+(o[(o[u>>2]|0)+(f<<2)>>2]|0)>>0]=1;f=f+1|0}while((f|0)<(o[l>>2]|0))}p=o[n>>2]|0;if((p|0)>0){f=o[t+280>>2]|0;d=o[t+588>>2]|0;g=0;m=0;do{_=o[f+(g<<2)>>2]|0;if(!(r[d+(_>>1)>>0]|0)){o[f+(m<<2)>>2]=_;p=o[n>>2]|0;m=m+1|0}g=g+1|0}while((g|0)<(p|0))}else{g=0;m=0}f=g-m|0;if((f|0)>0){p=p-f|0;o[n>>2]=p}o[t+512>>2]=p;t:do{if((o[l>>2]|0)>0){m=t+588|0;f=0;do{r[(o[m>>2]|0)+(o[(o[u>>2]|0)+(f<<2)>>2]|0)>>0]=0;f=f+1|0;d=o[l>>2]|0}while((f|0)<(d|0));if((d|0)>0){d=t+580|0;m=t+584|0;f=t+576|0;p=0;while(1){_=o[d>>2]|0;if((_|0)==(o[m>>2]|0)){g=(_>>1)+2&-2;g=(g|0)<2?2:g;if((g|0)>(2147483647-_|0)){i=28;break}v=o[f>>2]|0;g=g+_|0;o[m>>2]=g;g=Ur(v,g<<2)|0;o[f>>2]=g;if((g|0)==0?(o[(Wt()|0)>>2]|0)==12:0){i=28;break}_=o[d>>2]|0}else g=o[f>>2]|0;v=g+(_<<2)|0;if(v){o[v>>2]=0;_=o[d>>2]|0}o[d>>2]=_+1;v=o[u>>2]|0;o[g+(_<<2)>>2]=o[v+(p<<2)>>2];p=p+1|0;if((p|0)>=(o[l>>2]|0))break t}if((i|0)==28)Yt(St(1)|0,48,0)}else i=21}else i=21}while(0);if((i|0)==21)v=o[u>>2]|0;if(v)o[l>>2]=0}if(+((o[t+556>>2]|0)>>>0)>+h[t+96>>3]*+((o[t+548>>2]|0)>>>0))Hn[o[(o[t>>2]|0)+8>>2]&31](t);ze(t);o[s>>2]=o[n>>2];_=t+224|0;v=t+232|0;_=ln(o[v>>2]|0,o[v+4>>2]|0,o[_>>2]|0,o[_+4>>2]|0)|0;v=a;o[v>>2]=_;o[v+4>>2]=N;v=1;c=e;return v|0}r[n>>0]=0;v=0;c=e;return v|0}function je(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,a=0,l=0,f=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0,k=0,S=0,M=0,A=0,T=0,C=0,x=0,R=0,O=0,L=0,P=0,I=0,F=0,D=0,V=0,B=0,U=0,K=0,H=0,W=0,z=0,q=0,j=0,Y=0,$=0,G=0,Z=0,J=0,Q=0,tt=0,et=0,it=0,rt=0,nt=0,ot=0.0,st=0,at=0,lt=0,ut=0.0,ht=0,ct=0,ft=0,dt=0,mt=0,pt=0,gt=0.0,_t=0,vt=0,bt=0.0;f=c;c=c+64|0;J=f;O=f+60|0;T=f+56|0;n=f+44|0;Q=f+40|0;o[n>>2]=0;l=n+4|0;o[l>>2]=0;a=n+8|0;o[a>>2]=0;B=e+160|0;V=B;V=ln(o[V>>2]|0,o[V+4>>2]|0,1,0)|0;o[B>>2]=V;o[B+4>>2]=N;B=(i|0)<0;V=e+680|0;D=e+664|0;F=e+672|0;g=e+296|0;E=e+272|0;m=e+284|0;P=e+640|0;R=e+308|0;x=e+304|0;_=e+332|0;L=e+292|0;et=e+168|0;b=e+396|0;w=e+280|0;I=e+184|0;C=e+192|0;y=e+48|0;q=e+504|0;G=e+56|0;tt=e+496|0;it=e+656|0;U=e+144|0;K=e+648|0;H=e+128|0;W=e+44|0;z=e+200|0;j=e+208|0;Y=e+224|0;$=e+216|0;v=e+232|0;Z=e+540|0;p=e+292|0;k=e+544|0;M=e+276|0;S=e+268|0;A=e+268|0;rt=0;t:while(1){nt=B|(rt|0)<(i|0);while(1){st=Le(e)|0;if((st|0)!=-1)break;if(!nt){st=41;break t}if(r[V>>0]|0){st=41;break t}st=D;at=o[st+4>>2]|0;if((at|0)>=0?(vt=C,_t=o[vt+4>>2]|0,!(_t>>>0<at>>>0|((_t|0)==(at|0)?(o[vt>>2]|0)>>>0<(o[st>>2]|0)>>>0:0))):0){st=41;break t}st=F;at=o[st+4>>2]|0;if((at|0)>=0?(vt=I,_t=o[vt+4>>2]|0,!(_t>>>0<at>>>0|((_t|0)==(at|0)?(o[vt>>2]|0)>>>0<(o[st>>2]|0)>>>0:0))):0){st=41;break t}if((o[g>>2]|0)==0?!(qe(e)|0):0){st=50;break t}if(+((o[E>>2]|0)-(o[m>>2]|0)|0)>=+h[P>>3])He(e);while(1){st=o[g>>2]|0;if((st|0)>=(o[R>>2]|0)){st=59;break}ht=o[(o[x>>2]|0)+(st<<2)>>2]|0;at=s[(o[_>>2]|0)+(ht>>1)>>0]|0;vt=at^ht&1;lt=vt&255;pt=r[528]|0;_t=pt&255;if(!(lt<<24>>24==pt<<24>>24&(_t>>>1^1)|_t&2&vt)){st=56;break}o[O>>2]=o[m>>2];ai(L,O)}if((st|0)==56){st=0;_t=r[536]|0;vt=_t&255;if((vt>>>1^1)&lt<<24>>24==_t<<24>>24|at&2&vt){st=57;break t}if((ht|0)==-2)st=59}if((st|0)==59){vt=et;vt=ln(o[vt>>2]|0,o[vt+4>>2]|0,1,0)|0;ht=et;o[ht>>2]=vt;o[ht+4>>2]=N;ht=Ve(e)|0;if((ht|0)==-2){st=60;break t}}o[J>>2]=o[m>>2];ai(L,J);vt=ht>>1;r[(o[_>>2]|0)+vt>>0]=(ht&1^1)&255^1;_t=o[g>>2]|0;vt=(o[b>>2]|0)+(vt<<3)|0;o[vt>>2]=-1;o[vt+4>>2]=_t;vt=o[m>>2]|0;o[m>>2]=vt+1;o[(o[w>>2]|0)+(vt<<2)>>2]=ht}_t=C;_t=ln(o[_t>>2]|0,o[_t+4>>2]|0,1,0)|0;vt=C;o[vt>>2]=_t;o[vt+4>>2]=N;rt=rt+1|0;if(!(o[g>>2]|0)){st=5;break}if(o[n>>2]|0)o[l>>2]=0;Be(e,st,n,T);De(e,o[T>>2]|0);if((o[l>>2]|0)==1){_t=o[o[n>>2]>>2]|0;vt=_t>>1;r[(o[_>>2]|0)+vt>>0]=(_t&1^1)&255^1;pt=o[g>>2]|0;vt=(o[b>>2]|0)+(vt<<3)|0;o[vt>>2]=-1;o[vt+4>>2]=pt;vt=o[m>>2]|0;o[m>>2]=vt+1;o[(o[w>>2]|0)+(vt<<2)>>2]=_t}else{nt=ui(k,n,1)|0;st=o[E>>2]|0;if((st|0)==(o[M>>2]|0)){at=(st>>1)+2&-2;at=(at|0)<2?2:at;if((at|0)>(2147483647-st|0)){st=14;break}_t=o[S>>2]|0;vt=at+st|0;o[M>>2]=vt;vt=Ur(_t,vt<<2)|0;o[S>>2]=vt;if((vt|0)==0?(o[(Wt()|0)>>2]|0)==12:0){st=14;break}st=o[E>>2]|0}o[E>>2]=st+1;st=(o[S>>2]|0)+(st<<2)|0;if(st)o[st>>2]=nt;Pe(e,nt);lt=o[k>>2]|0;vt=lt+(nt<<2)|0;ot=+h[tt>>3];vt=vt+((o[vt>>2]|0)>>>5<<2)+4|0;bt=ot+ +u[vt>>2];u[vt>>2]=bt;if(bt>1.0e20){at=o[E>>2]|0;if((at|0)>0){st=o[A>>2]|0;ht=0;do{vt=lt+(o[st+(ht<<2)>>2]<<2)|0;vt=vt+((o[vt>>2]|0)>>>5<<2)+4|0;u[vt>>2]=+u[vt>>2]*1.0e-20;ht=ht+1|0}while((ht|0)!=(at|0))}h[tt>>3]=ot*1.0e-20}_t=o[o[n>>2]>>2]|0;vt=_t>>1;r[(o[_>>2]|0)+vt>>0]=(_t&1^1)&255^1;pt=o[g>>2]|0;vt=(o[b>>2]|0)+(vt<<3)|0;o[vt>>2]=nt;o[vt+4>>2]=pt;vt=o[m>>2]|0;o[m>>2]=vt+1;o[(o[w>>2]|0)+(vt<<2)>>2]=_t}h[q>>3]=1.0/+h[y>>3]*+h[q>>3];h[tt>>3]=1.0/+h[G>>3]*+h[tt>>3];vt=(o[it>>2]|0)+-1|0;o[it>>2]=vt;if(vt)continue;ot=+h[U>>3]*+h[K>>3];h[K>>3]=ot;o[it>>2]=~~ot;ot=+h[H>>3]*+h[P>>3];h[P>>3]=ot;if((o[W>>2]|0)<=0)continue;st=o[C>>2]|0;nt=o[z>>2]|0;mt=o[g>>2]|0;if(!mt)at=m;else at=o[p>>2]|0;at=o[at>>2]|0;dt=o[j>>2]|0;ft=o[Y>>2]|0;ct=o[$>>2]|0;ht=v;lt=o[ht>>2]|0;ht=o[ht+4>>2]|0;ut=+(o[Z>>2]|0);gt=1.0/ut;if((mt|0)<0)bt=0.0;else{pt=0;bt=0.0;while(1){if(!pt)_t=0;else _t=o[(o[p>>2]|0)+(pt+-1<<2)>>2]|0;if((pt|0)==(mt|0))vt=m;else vt=(o[p>>2]|0)+(pt<<2)|0;bt=bt+ +X(+gt,+ +(pt|0))*+((o[vt>>2]|0)-_t|0);if((pt|0)==(mt|0))break;else pt=pt+1|0}}o[J>>2]=st;o[J+4>>2]=nt-at;o[J+8>>2]=dt;o[J+12>>2]=ft;o[J+16>>2]=~~ot;o[J+20>>2]=ct;vt=J+24|0;h[d>>3]=(+(lt>>>0)+4294967296.0*+(ht>>>0))/+(ct|0);o[vt>>2]=o[d>>2];o[vt+4>>2]=o[d+4>>2];vt=J+32|0;h[d>>3]=bt/ut*100.0;o[vt>>2]=o[d>>2];o[vt+4>>2]=o[d+4>>2];Ut(1832,J|0)|0}if((st|0)==5)r[t>>0]=r[536]|0;else if((st|0)==14)Yt(St(1)|0,48,0);else if((st|0)==41){ot=+(o[Z>>2]|0);ut=1.0/ot;_=o[g>>2]|0;if((_|0)<0)gt=0.0;else{g=0;gt=0.0;while(1){if(!g)v=0;else v=o[(o[p>>2]|0)+(g+-1<<2)>>2]|0;if((g|0)==(_|0))b=m;else b=(o[p>>2]|0)+(g<<2)|0;gt=gt+ +X(+ut,+ +(g|0))*+((o[b>>2]|0)-v|0);if((g|0)==(_|0))break;else g=g+1|0}}h[e+528>>3]=gt/ot;De(e,0);r[t>>0]=r[544]|0}else if((st|0)==50)r[t>>0]=r[536]|0;else if((st|0)==57){o[Q>>2]=ht^1;vt=e+16|0;o[J+0>>2]=o[Q+0>>2];Ke(e,J,vt);r[t>>0]=r[536]|0}else if((st|0)==60)r[t>>0]=r[528]|0;t=o[n>>2]|0;if(!t){c=f;return}o[l>>2]=0;Br(t);o[n>>2]=0;o[a>>2]=0;c=f;return}function Xe(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0.0,E=0,k=0,S=0,M=0.0,A=0,T=0;n=c;c=c+16|0;a=n;i=e+4|0;if(o[i>>2]|0)o[e+8>>2]=0;s=e+36|0;l=e+32|0;if((o[s>>2]|0)>0){u=e+16|0;f=0;do{r[(o[u>>2]|0)+(o[(o[l>>2]|0)+(f<<2)>>2]|0)>>0]=0;f=f+1|0}while((f|0)<(o[s>>2]|0))}if(o[l>>2]|0)o[s>>2]=0;l=e+492|0;if(!(r[l>>0]|0)){r[t>>0]=r[536]|0;c=n;return}u=e+152|0;S=u;S=ln(o[S>>2]|0,o[S+4>>2]|0,1,0)|0;o[u>>2]=S;o[u+4>>2]=N;M=+h[e+120>>3]*+(o[e+208>>2]|0);u=e+640|0;h[u>>3]=M;w=+(o[e+104>>2]|0);if(M<w)h[u>>3]=w;E=o[e+136>>2]|0;h[e+648>>3]=+(E|0);o[e+656>>2]=E;E=r[544]|0;u=e+44|0;if((o[u>>2]|0)>0){Bt(2288)|0;Bt(2368)|0;Bt(2448)|0;Bt(2528)|0;m=r[544]|0}else m=E;d=e+192|0;f=e+184|0;S=m&255;t:do{if((S>>>1^1)&E<<24>>24==m<<24>>24|E&2&S){g=e+80|0;b=e+112|0;p=e+108|0;m=e+680|0;_=e+664|0;v=e+672|0;y=0;while(1){w=+h[b>>3];if(!(r[g>>0]|0))w=+X(+w,+ +(y|0));else{S=y+1|0;if((y|0)>0){k=0;E=1;do{k=k+1|0;E=E<<1|1}while((E|0)<(S|0));S=E+-1|0}else{k=0;S=0}if((S|0)!=(y|0)){E=y;do{A=S>>1;k=k+-1|0;E=(E|0)%(A|0)|0;S=A+-1|0}while((S|0)!=(E|0))}w=+X(+w,+ +(k|0))}je(a,e,~~(w*+(o[p>>2]|0)));E=r[a>>0]|0;if(r[m>>0]|0)break t;S=_;k=o[S+4>>2]|0;if((k|0)>=0?(A=d,T=o[A+4>>2]|0,!(T>>>0<k>>>0|((T|0)==(k|0)?(o[A>>2]|0)>>>0<(o[S>>2]|0)>>>0:0))):0)break t;S=v;k=o[S+4>>2]|0;if((k|0)>=0?(T=f,A=o[T+4>>2]|0,!(A>>>0<k>>>0|((A|0)==(k|0)?(o[T>>2]|0)>>>0<(o[S>>2]|0)>>>0:0))):0)break t;A=r[544]|0;T=A&255;if(!((T>>>1^1)&E<<24>>24==A<<24>>24|E&2&T))break;else y=y+1|0}}}while(0);if((o[u>>2]|0)>0)Bt(2528)|0;A=r[528]|0;T=A&255;a=E&2;if(!((T>>>1^1)&E<<24>>24==A<<24>>24|a&T)){A=r[536]|0;T=A&255;if(((T>>>1^1)&E<<24>>24==A<<24>>24|a&T|0)!=0?(o[s>>2]|0)==0:0)r[l>>0]=0}else{s=e+540|0;ri(i,o[s>>2]|0);if((o[s>>2]|0)>0){a=e+332|0;l=0;do{r[(o[i>>2]|0)+l>>0]=r[(o[a>>2]|0)+l>>0]|0;l=l+1|0}while((l|0)<(o[s>>2]|0))}}De(e,0);r[t>>0]=E;c=n;return}function Ye(t,e){t=t|0;e=e|0;var i=0,n=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0;i=c;a=t+412|0;pi(a);u=t+540|0;if((o[u>>2]|0)>0){l=t+544|0;n=0;do{h=n<<1;d=o[a>>2]|0;f=d+(h*12|0)+4|0;if((o[f>>2]|0)>0){p=d+(h*12|0)|0;m=0;do{v=(o[p>>2]|0)+(m<<3)|0;d=o[v>>2]|0;g=o[l>>2]|0;_=g+(d<<2)|0;if(!(o[_>>2]&16)){b=gi(e,_)|0;o[v>>2]=b;o[_>>2]=o[_>>2]|16;o[g+(d+1<<2)>>2]=b}else o[v>>2]=o[g+(d+1<<2)>>2];m=m+1|0}while((m|0)<(o[f>>2]|0));f=o[a>>2]|0}else f=d;d=h|1;h=f+(d*12|0)+4|0;if((o[h>>2]|0)>0){_=f+(d*12|0)|0;g=0;do{f=(o[_>>2]|0)+(g<<3)|0;p=o[f>>2]|0;m=o[l>>2]|0;d=m+(p<<2)|0;if(!(o[d>>2]&16)){b=gi(e,d)|0;o[f>>2]=b;o[d>>2]=o[d>>2]|16;o[m+(p+1<<2)>>2]=b}else o[f>>2]=o[m+(p+1<<2)>>2];g=g+1|0}while((g|0)<(o[h>>2]|0))}n=n+1|0}while((n|0)<(o[u>>2]|0))}n=t+284|0;if((o[n>>2]|0)>0){h=t+280|0;u=t+396|0;l=t+544|0;a=t+332|0;f=0;do{_=o[u>>2]|0;p=_+(o[(o[h>>2]|0)+(f<<2)>>2]>>1<<3)|0;g=o[p>>2]|0;do{if((g|0)!=-1){b=o[l>>2]|0;v=b+(g<<2)|0;m=(o[v>>2]&16|0)==0;if(m){y=o[b+(g+1<<2)>>2]|0;d=y>>1;y=(s[(o[a>>2]|0)+d>>0]|0)^y&1;E=r[528]|0;w=E&255;if(!((y&255)<<24>>24==E<<24>>24&(w>>>1^1)|w&2&y))break;E=o[_+(d<<3)>>2]|0;if(!((E|0)!=-1&(E|0)==(g|0)))break;if(m){E=gi(e,v)|0;o[p>>2]=E;o[v>>2]=o[v>>2]|16;o[b+(g+1<<2)>>2]=E;break}}o[p>>2]=o[b+(g+1<<2)>>2]}}while(0);f=f+1|0}while((f|0)<(o[n>>2]|0))}n=t+272|0;d=o[n>>2]|0;if((d|0)>0){l=t+268|0;a=t+544|0;f=o[l>>2]|0;u=0;h=0;do{p=f+(u<<2)|0;m=o[p>>2]|0;_=o[a>>2]|0;g=_+(m<<2)|0;v=o[g>>2]|0;if((v&3|0)!=1){if(!(v&16)){d=gi(e,g)|0;o[p>>2]=d;o[g>>2]=o[g>>2]|16;o[_+(m+1<<2)>>2]=d;d=o[l>>2]|0;f=d;d=o[d+(u<<2)>>2]|0}else{d=o[_+(m+1<<2)>>2]|0;o[p>>2]=d}o[f+(h<<2)>>2]=d;d=o[n>>2]|0;h=h+1|0}u=u+1|0}while((u|0)<(d|0))}else{u=0;h=0}a=u-h|0;if((a|0)>0)o[n>>2]=d-a;n=t+260|0;f=o[n>>2]|0;if((f|0)>0){a=t+256|0;t=t+544|0;h=o[a>>2]|0;l=0;u=0;do{d=h+(l<<2)|0;p=o[d>>2]|0;m=o[t>>2]|0;_=m+(p<<2)|0;g=o[_>>2]|0;if((g&3|0)!=1){if(!(g&16)){f=gi(e,_)|0;o[d>>2]=f;o[_>>2]=o[_>>2]|16;o[m+(p+1<<2)>>2]=f;f=o[a>>2]|0;h=f;f=o[f+(l<<2)>>2]|0}else{f=o[m+(p+1<<2)>>2]|0;o[d>>2]=f}o[h+(u<<2)>>2]=f;f=o[n>>2]|0;u=u+1|0}l=l+1|0}while((l|0)<(f|0))}else{l=0;u=0}e=l-u|0;if((e|0)<=0){c=i;return}o[n>>2]=f-e;c=i;return}function $e(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0,u=0;s=c;c=c+32|0;l=s;e=s+8|0;i=t+548|0;n=t+556|0;a=(o[i>>2]|0)-(o[n>>2]|0)|0;o[e+0>>2]=0;o[e+4>>2]=0;o[e+8>>2]=0;o[e+12>>2]=0;ti(e,a);a=e+16|0;r[a>>0]=0;Ye(t,e);if((o[t+44>>2]|0)>1){u=o[e+4>>2]<<2;o[l>>2]=o[i>>2]<<2;o[l+4>>2]=u;Ut(1888,l|0)|0}r[t+560>>0]=r[a>>0]|0;a=t+544|0;l=o[a>>2]|0;if(l)Br(l);o[a>>2]=o[e>>2];o[i>>2]=o[e+4>>2];o[t+552>>2]=o[e+8>>2];o[n>>2]=o[e+12>>2];c=s;return}function Ge(){var t=0,e=0,i=0;t=c;c=c+16|0;e=t;r[528]=0;r[536]=1;r[544]=2;_e(552,608,624,2136,2144);o[138]=2168;h[72]=0.0;h[73]=1.0;r[592]=0;r[593]=0;n[297]=n[e+0>>1]|0;n[298]=n[e+2>>1]|0;n[299]=n[e+4>>1]|0;h[75]=.95;_e(664,720,736,2136,2144);o[166]=2168;h[86]=0.0;h[87]=1.0;r[704]=0;r[705]=0;n[353]=n[e+0>>1]|0;n[354]=n[e+2>>1]|0;n[355]=n[e+4>>1]|0;h[89]=.999;_e(776,832,848,2136,2144);o[194]=2168;h[100]=0.0;h[101]=1.0;r[816]=1;r[817]=1;n[409]=n[e+0>>1]|0;n[410]=n[e+2>>1]|0;n[411]=n[e+4>>1]|0;h[103]=0.0;_e(936,992,1008,2136,2144);o[234]=2168;h[120]=0.0;h[121]=S;r[976]=0;r[977]=0;n[489]=n[e+0>>1]|0;n[490]=n[e+2>>1]|0;n[491]=n[e+4>>1]|0;h[123]=91648253.0;_e(1048,1080,1096,2136,2016);o[262]=280;i=1068|0;o[i>>2]=0;o[i+4>>2]=2;o[269]=2;_e(1160,1192,1208,2136,2016);o[290]=280;i=1180|0;o[i>>2]=0;o[i+4>>2]=2;o[297]=2;_e(1272,1296,1312,2136,1992);o[318]=160;r[1292]=0;_e(1344,1368,1376,2136,1992);o[336]=160;r[1364]=1;_e(1408,1440,1448,2136,2016);o[352]=280;i=1428|0;o[i>>2]=1;o[i+4>>2]=2147483647;o[359]=100;_e(1480,1536,1544,2136,2144);o[370]=2168;h[188]=1.0;h[189]=S;r[1520]=0;r[1521]=0;n[761]=n[e+0>>1]|0;n[762]=n[e+2>>1]|0;n[763]=n[e+4>>1]|0;h[191]=2.0;_e(1584,1640,1648,2136,2144);o[396]=2168;h[201]=0.0;h[202]=S;r[1624]=0;r[1625]=0;n[813]=n[e+0>>1]|0;n[814]=n[e+2>>1]|0;n[815]=n[e+4>>1]|0;h[204]=.2;_e(1728,1760,1776,2136,2016);o[432]=280;e=1748|0;o[e>>2]=0;o[e+4>>2]=2147483647;o[439]=0;c=t;return}function Ze(t){t=t|0;var e=0;e=c;ur(t);c=e;return}function Je(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,f=0,d=0,m=0,p=0.0,g=0.0;i=c;c=c+16|0;a=i;s=i+8|0;if((r[e>>0]|0)!=45){m=0;c=i;return m|0}f=e+1|0;n=t+4|0;l=o[n>>2]|0;u=r[l>>0]|0;t:do{if(u<<24>>24){d=0;while(1){m=d;d=d+1|0;if((r[f>>0]|0)!=u<<24>>24){t=0;break}u=r[l+d>>0]|0;f=e+(m+2)|0;if(!(u<<24>>24))break t}c=i;return t|0}}while(0);if((r[f>>0]|0)!=61){m=0;c=i;return m|0}l=f+1|0;p=+Gr(l,s);if(!(o[s>>2]|0)){m=0;c=i;return m|0}g=+h[t+32>>3];if(p>=g?(r[t+41>>0]|0)==0|p!=g:0){m=o[v>>2]|0;d=o[n>>2]|0;o[a>>2]=l;o[a+4>>2]=d;te(m|0,2024,a|0)|0;re(1)}g=+h[t+24>>3];if(p<=g?(r[t+40>>0]|0)==0|p!=g:0){m=o[v>>2]|0;d=o[n>>2]|0;o[a>>2]=l;o[a+4>>2]=d;te(m|0,2080,a|0)|0;re(1)}h[t+48>>3]=p;m=1;c=i;return m|0}function Qe(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0.0,u=0,f=0.0,m=0.0,p=0;i=c;c=c+48|0;n=i;s=o[v>>2]|0;p=o[t+16>>2]|0;u=(r[t+40>>0]|0)!=0?91:40;m=+h[t+24>>3];f=+h[t+32>>3];a=(r[t+41>>0]|0)!=0?93:41;l=+h[t+48>>3];o[n>>2]=o[t+4>>2];o[n+4>>2]=p;o[n+8>>2]=u;u=n+12|0;h[d>>3]=m;o[u>>2]=o[d>>2];o[u+4>>2]=o[d+4>>2];u=n+20|0;h[d>>3]=f;o[u>>2]=o[d>>2];o[u+4>>2]=o[d+4>>2];o[n+28>>2]=a;a=n+32|0;h[d>>3]=l;o[a>>2]=o[d>>2];o[a+4>>2]=o[d+4>>2];te(s|0,2232,n|0)|0;if(!e){c=i;return}o[n>>2]=o[t+8>>2];te(s|0,2e3,n|0)|0;Xt(10,s|0)|0;c=i;return}function ti(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0;i=c;r=t+8|0;n=o[r>>2]|0;if(n>>>0<e>>>0)a=n;else{c=i;return}while(1){if(a>>>0>=e>>>0)break;a=((a>>>3)+2+(a>>>1)&-2)+a|0;o[r>>2]=a;if(a>>>0<=n>>>0){s=4;break}}if((s|0)==4)Yt(St(1)|0,48,0);r=Ur(o[t>>2]|0,a<<2)|0;if((r|0)==0?(o[(Wt()|0)>>2]|0)==12:0)Yt(St(1)|0,48,0);o[t>>2]=r;c=i;return}function ei(t){t=t|0;var e=0,i=0,r=0,n=0,s=0,a=0,l=0;e=c;r=t+32|0;i=o[r>>2]|0;if(i){o[t+36>>2]=0;Br(i);o[r>>2]=0;o[t+40>>2]=0}r=t+16|0;i=o[r>>2]|0;if(i){o[t+20>>2]=0;Br(i);o[r>>2]=0;o[t+24>>2]=0}r=o[t>>2]|0;if(!r){c=e;return}i=t+4|0;s=o[i>>2]|0;if((s|0)>0){n=0;do{l=r+(n*12|0)|0;a=o[l>>2]|0;if(a){o[r+(n*12|0)+4>>2]=0;Br(a);o[l>>2]=0;o[r+(n*12|0)+8>>2]=0;r=o[t>>2]|0;s=o[i>>2]|0}n=n+1|0}while((n|0)<(s|0))}o[i>>2]=0;Br(r);o[t>>2]=0;o[t+8>>2]=0;c=e;return}function ii(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0;n=c;c=c+16|0;r=n+4|0;i=n;h=o[e>>2]|0;a=h+1|0;s=t+4|0;if((o[s>>2]|0)<(a|0)){u=t+8|0;l=o[u>>2]|0;if((l|0)<(a|0)){f=h+2-l&-2;h=(l>>1)+2&-2;h=(f|0)>(h|0)?f:h;if((h|0)>(2147483647-l|0)){f=St(1)|0;Yt(f|0,48,0)}d=o[t>>2]|0;f=h+l|0;o[u>>2]=f;f=Ur(d,f*12|0)|0;o[t>>2]=f;if((f|0)==0?(o[(Wt()|0)>>2]|0)==12:0){d=St(1)|0;Yt(d|0,48,0)}}u=o[s>>2]|0;if((u|0)<(a|0)){l=o[t>>2]|0;do{h=l+(u*12|0)|0;if(h){o[h>>2]=0;o[l+(u*12|0)+4>>2]=0;o[l+(u*12|0)+8>>2]=0}u=u+1|0}while((u|0)!=(a|0))}o[s>>2]=a;h=o[e>>2]|0}s=o[t>>2]|0;if(!(o[s+(h*12|0)>>2]|0)){f=h;d=t+16|0;o[i>>2]=f;o[r+0>>2]=o[i+0>>2];fi(d,r,0);c=n;return}o[s+(h*12|0)+4>>2]=0;f=o[e>>2]|0;d=t+16|0;o[i>>2]=f;o[r+0>>2]=o[i+0>>2];fi(d,r,0);c=n;return}function ri(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0;n=c;i=t+4|0;if((o[i>>2]|0)>=(e|0)){c=n;return}a=t+8|0;s=o[a>>2]|0;if((s|0)<(e|0)){u=e+1-s&-2;l=(s>>1)+2&-2;l=(u|0)>(l|0)?u:l;if((l|0)>(2147483647-s|0)){u=St(1)|0;Yt(u|0,48,0)}h=o[t>>2]|0;u=l+s|0;o[a>>2]=u;u=Ur(h,u)|0;o[t>>2]=u;if((u|0)==0?(o[(Wt()|0)>>2]|0)==12:0){h=St(1)|0;Yt(h|0,48,0)}}s=o[i>>2]|0;if((s|0)<(e|0)){t=o[t>>2]|0;do{a=t+s|0;if(a)r[a>>0]=0;s=s+1|0}while((s|0)!=(e|0))}o[i>>2]=e;c=n;return}function ni(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0;a=c;s=e+1|0;n=t+4|0;if((o[n>>2]|0)>=(s|0)){h=o[t>>2]|0;h=h+e|0;r[h>>0]=i;c=a;return}u=t+8|0;l=o[u>>2]|0;if((l|0)<(s|0)){f=e+2-l&-2;h=(l>>1)+2&-2;h=(f|0)>(h|0)?f:h;if((h|0)>(2147483647-l|0)){f=St(1)|0;Yt(f|0,48,0)}d=o[t>>2]|0;f=h+l|0;o[u>>2]=f;f=Ur(d,f)|0;o[t>>2]=f;if((f|0)==0?(o[(Wt()|0)>>2]|0)==12:0){d=St(1)|0;Yt(d|0,48,0)}}l=o[n>>2]|0;if((l|0)<(s|0))do{u=(o[t>>2]|0)+l|0;if(u)r[u>>0]=0;l=l+1|0}while((l|0)!=(s|0));o[n>>2]=s;d=o[t>>2]|0;d=d+e|0;r[d>>0]=i;c=a;return}function oi(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,f=0,d=0,m=0;i=c;c=c+16|0;s=i;o[s>>2]=e;a=t+12|0;n=e+1|0;r=t+16|0;if((o[r>>2]|0)<(n|0)){u=t+20|0;l=o[u>>2]|0;if((l|0)<(n|0)){d=e+2-l&-2;f=(l>>1)+2&-2;f=(d|0)>(f|0)?d:f;if((f|0)>(2147483647-l|0)){d=St(1)|0;Yt(d|0,48,0)}m=o[a>>2]|0;d=f+l|0;o[u>>2]=d;d=Ur(m,d<<2)|0;o[a>>2]=d;if((d|0)==0?(o[(Wt()|0)>>2]|0)==12:0){m=St(1)|0;Yt(m|0,48,0)}}l=o[r>>2]|0;if((n|0)>(l|0))on((o[a>>2]|0)+(l<<2)|0,-1,n-l<<2|0)|0;o[r>>2]=n}o[(o[a>>2]|0)+(e<<2)>>2]=o[t+4>>2];ai(t,s);r=o[a>>2]|0;s=o[r+(e<<2)>>2]|0;e=o[t>>2]|0;n=o[e+(s<<2)>>2]|0;if(!s){d=0;m=e+(d<<2)|0;o[m>>2]=n;m=r+(n<<2)|0;o[m>>2]=d;c=i;return}t=t+28|0;while(1){a=s;s=s+-1>>1;l=e+(s<<2)|0;u=o[l>>2]|0;m=o[o[t>>2]>>2]|0;if(!(+h[m+(n<<3)>>3]>+h[m+(u<<3)>>3])){t=14;break}o[e+(a<<2)>>2]=u;o[r+(o[l>>2]<<2)>>2]=a;if(!s){a=0;t=14;break}}if((t|0)==14){m=e+(a<<2)|0;o[m>>2]=n;m=r+(n<<2)|0;o[m>>2]=a;c=i;return}}function si(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0;i=c;r=t+4|0;n=o[r>>2]|0;s=t+8|0;a=o[s>>2]|0;if((n|0)==(a|0)&(a|0)<(n+1|0)){a=(n>>1)+2&-2;a=(a|0)<2?2:a;if((a|0)>(2147483647-n|0)){a=St(1)|0;Yt(a|0,48,0)}l=o[t>>2]|0;n=a+n|0;o[s>>2]=n;n=Ur(l,n<<2)|0;o[t>>2]=n;if((n|0)==0?(o[(Wt()|0)>>2]|0)==12:0){l=St(1)|0;Yt(l|0,48,0)}}else n=o[t>>2]|0;l=o[r>>2]|0;o[r>>2]=l+1;r=n+(l<<2)|0;if(!r){c=i;return}o[r>>2]=o[e>>2];c=i;return}function ai(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0;i=c;r=t+4|0;n=o[r>>2]|0;s=t+8|0;a=o[s>>2]|0;if((n|0)==(a|0)&(a|0)<(n+1|0)){a=(n>>1)+2&-2;a=(a|0)<2?2:a;if((a|0)>(2147483647-n|0)){a=St(1)|0;Yt(a|0,48,0)}l=o[t>>2]|0;n=a+n|0;o[s>>2]=n;n=Ur(l,n<<2)|0;o[t>>2]=n;if((n|0)==0?(o[(Wt()|0)>>2]|0)==12:0){l=St(1)|0;Yt(l|0,48,0)}}else n=o[t>>2]|0;l=o[r>>2]|0;o[r>>2]=l+1;r=n+(l<<2)|0;if(!r){c=i;return}o[r>>2]=o[e>>2];c=i;return}function li(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0;i=c;c=c+16|0;n=i+2|0;a=i+1|0;s=i;if((e|0)<16){s=e+-1|0;if((s|0)>0)a=0;else{c=i;return}do{n=a;a=a+1|0;if((a|0)<(e|0)){u=n;l=a;do{u=(o[t+(l<<2)>>2]|0)<(o[t+(u<<2)>>2]|0)?l:u;l=l+1|0}while((l|0)!=(e|0))}else u=n;d=t+(n<<2)|0;m=o[d>>2]|0;p=t+(u<<2)|0;o[d>>2]=o[p>>2];o[p>>2]=m}while((a|0)!=(s|0));c=i;return}l=o[t+(((e|0)/2|0)<<2)>>2]|0;f=-1;d=e;while(1){do{f=f+1|0;h=t+(f<<2)|0;u=o[h>>2]|0}while((u|0)<(l|0));do{d=d+-1|0;m=t+(d<<2)|0;p=o[m>>2]|0}while((l|0)<(p|0));if((f|0)>=(d|0))break;o[h>>2]=p;o[m>>2]=u}r[n+0>>0]=r[a+0>>0]|0;li(t,f,n);p=e-f|0;r[n+0>>0]=r[s+0>>0]|0;li(h,p,n);c=i;return}function ui(t,e,i){t=t|0;e=e|0;i=i|0;var r=0,n=0,a=0,l=0,h=0,f=0;r=c;l=i&1;a=s[t+16>>0]|0|l;n=e+4|0;h=((a+(o[n>>2]|0)<<2)+4|0)>>>2;f=t+4|0;ti(t,h+(o[f>>2]|0)|0);i=o[f>>2]|0;h=h+i|0;o[f>>2]=h;if(h>>>0<i>>>0)Yt(St(1)|0,48,0);t=(o[t>>2]|0)+(i<<2)|0;if(!t){c=r;return i|0}a=a<<3|l<<2;o[t>>2]=o[t>>2]&-32|a;a=o[n>>2]<<5|a;o[t>>2]=a;if((o[n>>2]|0)>0){a=o[e>>2]|0;e=0;do{o[t+(e<<2)+4>>2]=o[a+(e<<2)>>2];e=e+1|0}while((e|0)<(o[n>>2]|0));a=o[t>>2]|0}if(!(a&8)){c=r;return i|0}n=a>>>5;if(a&4){u[t+(n<<2)+4>>2]=0.0;c=r;return i|0}if(!n){n=0;a=0}else{a=0;e=0;do{a=1<<((o[t+(e<<2)+4>>2]|0)>>>1&31)|a;e=e+1|0}while((e|0)<(n|0))}o[t+(n<<2)+4>>2]=a;c=r;return i|0}function hi(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0;i=c;r=t+4|0;n=o[r>>2]|0;s=t+8|0;a=o[s>>2]|0;if((n|0)==(a|0)&(a|0)<(n+1|0)){a=(n>>1)+2&-2;a=(a|0)<2?2:a;if((a|0)>(2147483647-n|0)){a=St(1)|0;Yt(a|0,48,0)}l=o[t>>2]|0;n=a+n|0;o[s>>2]=n;n=Ur(l,n<<3)|0;o[t>>2]=n;if((n|0)==0?(o[(Wt()|0)>>2]|0)==12:0){l=St(1)|0;Yt(l|0,48,0)}}else n=o[t>>2]|0;l=o[r>>2]|0;o[r>>2]=l+1;r=n+(l<<3)|0;if(!r){c=i;return}s=e;a=o[s+4>>2]|0;l=r;o[l>>2]=o[s>>2];o[l+4>>2]=a;c=i;return}function ci(t){t=t|0;var e=0,i=0,r=0,n=0,s=0,a=0,l=0,u=0,f=0,d=0,m=0,p=0,g=0.0,_=0.0,v=0;e=c;i=o[t>>2]|0;n=o[i>>2]|0;l=t+4|0;m=o[i+((o[l>>2]|0)+-1<<2)>>2]|0;o[i>>2]=m;r=o[t+12>>2]|0;o[r+(m<<2)>>2]=0;o[r+(n<<2)>>2]=-1;m=(o[l>>2]|0)+-1|0;o[l>>2]=m;if((m|0)<=1){c=e;return n|0}s=o[i>>2]|0;u=t+28|0;t=0;f=1;while(1){d=(t<<1)+2|0;if((d|0)<(m|0)){p=o[i+(d<<2)>>2]|0;v=o[i+(f<<2)>>2]|0;m=o[o[u>>2]>>2]|0;g=+h[m+(p<<3)>>3];_=+h[m+(v<<3)>>3];if(!(g>_)){p=v;g=_;a=6}}else{m=o[o[u>>2]>>2]|0;a=o[i+(f<<2)>>2]|0;p=a;g=+h[m+(a<<3)>>3];a=6}if((a|0)==6){a=0;d=f}if(!(g>+h[m+(s<<3)>>3]))break;o[i+(t<<2)>>2]=p;o[r+(p<<2)>>2]=t;f=d<<1|1;m=o[l>>2]|0;if((f|0)>=(m|0)){t=d;break}else t=d}o[i+(t<<2)>>2]=s;o[r+(s<<2)>>2]=t;c=e;return n|0}function fi(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,a=0,l=0,u=0,h=0,f=0;n=c;u=o[e>>2]|0;e=u+1|0;s=t+4|0;if((o[s>>2]|0)>=(e|0)){c=n;return}l=t+8|0;a=o[l>>2]|0;if((a|0)<(e|0)){h=u+2-a&-2;u=(a>>1)+2&-2;u=(h|0)>(u|0)?h:u;if((u|0)>(2147483647-a|0)){h=St(1)|0;Yt(h|0,48,0)}f=o[t>>2]|0;h=u+a|0;o[l>>2]=h;h=Ur(f,h)|0;o[t>>2]=h;if((h|0)==0?(o[(Wt()|0)>>2]|0)==12:0){f=St(1)|0;Yt(f|0,48,0)}}a=o[s>>2]|0;if((a|0)<(e|0))do{r[(o[t>>2]|0)+a>>0]=i;a=a+1|0}while((a|0)!=(e|0));o[s>>2]=e;c=n;return}function di(t,e,i){t=t|0;e=e|0;i=i|0;var r=0,n=0,s=0,a=0,l=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0;r=c;c=c+16|0;s=r+8|0;n=r+4|0;a=r;if((e|0)<16){n=e+-1|0;if((n|0)<=0){c=r;return}s=o[i>>2]|0;i=0;do{a=i;i=i+1|0;if((i|0)<(e|0)){l=o[s>>2]|0;f=a;h=i;do{d=l+(o[t+(h<<2)>>2]<<2)|0;y=o[d>>2]|0;g=y>>>5;if(y>>>0>95){m=l+(o[t+(f<<2)>>2]<<2)|0;p=(o[m>>2]|0)>>>5;if((p|0)==2)f=h;else f=+u[d+(g<<2)+4>>2]<+u[m+(p<<2)+4>>2]?h:f}h=h+1|0}while((h|0)!=(e|0))}else f=a;v=t+(a<<2)|0;b=o[v>>2]|0;y=t+(f<<2)|0;o[v>>2]=o[y>>2];o[y>>2]=b}while((i|0)!=(n|0));c=r;return}l=o[t+(((e|0)/2|0)<<2)>>2]|0;g=-1;m=e;while(1){b=g+1|0;p=t+(b<<2)|0;y=o[p>>2]|0;h=o[i>>2]|0;f=o[h>>2]|0;v=f+(y<<2)|0;_=o[v>>2]|0;g=f+(l<<2)|0;d=o[g>>2]|0;t:do{if(_>>>0>95)while(1){w=d>>>5;if((w|0)!=2?!(+u[v+(_>>>5<<2)+4>>2]<+u[g+(w<<2)+4>>2]):0){g=b;break t}b=b+1|0;p=t+(b<<2)|0;y=o[p>>2]|0;v=f+(y<<2)|0;_=o[v>>2]|0;if(_>>>0<=95){g=b;break}}else g=b}while(0);m=m+-1|0;v=t+(m<<2)|0;_=f+(l<<2)|0;t:do{if(d>>>0>95)while(1){b=f+(o[v>>2]<<2)|0;w=(o[b>>2]|0)>>>5;if((w|0)!=2?!(+u[_+(d>>>5<<2)+4>>2]<+u[b+(w<<2)+4>>2]):0)break t;w=m+-1|0;v=t+(w<<2)|0;m=w}}while(0);if((g|0)>=(m|0))break;o[p>>2]=o[v>>2];o[v>>2]=y}o[n>>2]=h;o[s+0>>2]=o[n+0>>2];di(t,g,s);w=e-g|0;o[a>>2]=h;o[s+0>>2]=o[a+0>>2];di(p,w,s);c=r;return}function mi(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,f=0,d=0,m=0,p=0,g=0.0,_=0.0,v=0;r=c;n=t+4|0;a=o[n>>2]|0;s=o[t>>2]|0;if((a|0)>0){u=o[t+12>>2]|0;l=0;do{o[u+(o[s+(l<<2)>>2]<<2)>>2]=-1;l=l+1|0;a=o[n>>2]|0}while((l|0)<(a|0))}if(s){o[n>>2]=0;a=0}s=e+4|0;if((o[s>>2]|0)>0){l=t+12|0;a=0;do{v=(o[e>>2]|0)+(a<<2)|0;o[(o[l>>2]|0)+(o[v>>2]<<2)>>2]=a;ai(t,v);a=a+1|0}while((a|0)<(o[s>>2]|0));a=o[n>>2]|0}if((a|0)<=1){c=r;return}s=o[t>>2]|0;e=t+28|0;t=t+12|0;m=a;l=(a|0)/2|0;while(1){l=l+-1|0;a=o[s+(l<<2)>>2]|0;f=l<<1|1;t:do{if((f|0)<(m|0)){u=l;while(1){d=(u<<1)+2|0;if((d|0)<(m|0)){p=o[s+(d<<2)>>2]|0;v=o[s+(f<<2)>>2]|0;m=o[o[e>>2]>>2]|0;g=+h[m+(p<<3)>>3];_=+h[m+(v<<3)>>3];if(!(g>_)){p=v;g=_;i=16}}else{m=o[o[e>>2]>>2]|0;i=o[s+(f<<2)>>2]|0;p=i;g=+h[m+(i<<3)>>3];i=16}if((i|0)==16){i=0;d=f}if(!(g>+h[m+(a<<3)>>3]))break t;o[s+(u<<2)>>2]=p;o[(o[t>>2]|0)+(p<<2)>>2]=u;f=d<<1|1;m=o[n>>2]|0;if((f|0)>=(m|0)){u=d;break}else u=d}}else u=l}while(0);o[s+(u<<2)>>2]=a;o[(o[t>>2]|0)+(a<<2)>>2]=u;if((l|0)<=0)break;m=o[n>>2]|0}c=r;return}function pi(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0;i=c;e=t+36|0;h=o[e>>2]|0;n=t+32|0;d=o[n>>2]|0;if((h|0)>0){a=t+16|0;s=t+44|0;l=0;do{u=d+(l<<2)|0;f=o[u>>2]|0;if(r[(o[a>>2]|0)+f>>0]|0){d=o[t>>2]|0;h=d+(f*12|0)+4|0;p=o[h>>2]|0;if((p|0)>0){f=d+(f*12|0)|0;d=0;m=0;do{g=o[f>>2]|0;_=g+(d<<3)|0;if((o[(o[o[s>>2]>>2]|0)+(o[_>>2]<<2)>>2]&3|0)!=1){v=_;_=o[v+4>>2]|0;p=g+(m<<3)|0;o[p>>2]=o[v>>2];o[p+4>>2]=_;p=o[h>>2]|0;m=m+1|0}d=d+1|0}while((d|0)<(p|0))}else{d=0;m=0}f=d-m|0;if((f|0)>0)o[h>>2]=p-f;r[(o[a>>2]|0)+(o[u>>2]|0)>>0]=0;h=o[e>>2]|0;d=o[n>>2]|0}l=l+1|0}while((l|0)<(h|0))}if(!d){c=i;return}o[e>>2]=0;c=i;return}function gi(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,a=0,l=0;r=c;a=o[e>>2]|0;n=a>>>2&1|(s[t+16>>0]|0);a=((n+(a>>>5)<<2)+4|0)>>>2;l=t+4|0;ti(t,a+(o[l>>2]|0)|0);i=o[l>>2]|0;a=a+i|0;o[l>>2]=a;if(a>>>0<i>>>0)Yt(St(1)|0,48,0);t=(o[t>>2]|0)+(i<<2)|0;if(!t){c=r;return i|0}n=o[e>>2]&-9|n<<3;o[t>>2]=n;if((o[e>>2]|0)>>>0>31){n=0;do{o[t+(n<<2)+4>>2]=o[e+(n<<2)+4>>2];n=n+1|0}while((n|0)<((o[e>>2]|0)>>>5|0));n=o[t>>2]|0}if(!(n&8)){c=r;return i|0}a=n>>>5;e=e+(a<<2)+4|0;if(!(n&4)){o[t+(a<<2)+4>>2]=o[e>>2];c=r;return i|0}else{u[t+(a<<2)+4>>2]=+u[e>>2];c=r;return i|0}return 0}function _i(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0;e=c;c=c+16|0;s=e;Ae(t);o[t>>2]=3424;o[t+684>>2]=o[719];o[t+688>>2]=o[747];o[t+692>>2]=o[785];h[t+696>>3]=+h[411];r[t+704>>0]=r[2652]|0;r[t+705>>0]=r[2724]|0;r[t+706>>0]=r[2804]|0;r[t+707>>0]=1;o[t+708>>2]=0;o[t+712>>2]=0;o[t+716>>2]=0;o[t+720>>2]=1;r[t+724>>0]=1;i=t+732|0;l=t+544|0;o[t+760>>2]=0;o[t+764>>2]=0;o[t+768>>2]=0;o[t+776>>2]=0;o[t+780>>2]=0;o[t+784>>2]=0;o[t+792>>2]=0;o[t+796>>2]=0;o[t+800>>2]=0;a=t+804|0;o[i+0>>2]=0;o[i+4>>2]=0;o[i+8>>2]=0;o[i+12>>2]=0;o[i+16>>2]=0;o[i+20>>2]=0;o[a>>2]=l;a=t+808|0;o[a>>2]=0;o[t+812>>2]=0;o[t+816>>2]=0;i=t+824|0;o[i+0>>2]=0;o[i+4>>2]=0;o[i+8>>2]=0;o[i+12>>2]=0;o[i+16>>2]=0;o[i+20>>2]=0;o[t+852>>2]=a;Fi(t+856|0,1);a=t+868|0;i=t+892|0;o[t+920>>2]=0;o[t+924>>2]=0;o[a+0>>2]=0;o[a+4>>2]=0;o[a+8>>2]=0;o[a+12>>2]=0;o[a+16>>2]=0;o[i+0>>2]=0;o[i+4>>2]=0;o[i+8>>2]=0;o[i+12>>2]=0;o[i+16>>2]=0;o[i+20>>2]=0;i=s+4|0;o[i>>2]=0;a=s+8|0;o[a>>2]=2;n=Ur(0,8)|0;o[s>>2]=n;if((n|0)==0?(o[(Wt()|0)>>2]|0)==12:0)Yt(St(1)|0,48,0);o[n>>2]=-2;o[i>>2]=1;r[t+560>>0]=1;o[t+928>>2]=ui(l,s,0)|0;r[t+536>>0]=0;if(!n){c=e;return}o[i>>2]=0;Br(n);o[s>>2]=0;o[a>>2]=0;c=e;return}function vi(t){t=t|0;var e=0;e=c;bi(t);ur(t);c=e;return}function bi(t){t=t|0;var e=0,i=0,r=0;e=c;o[t>>2]=3424;i=t+904|0;r=o[i>>2]|0;if(r){o[t+908>>2]=0;Br(r);o[i>>2]=0;o[t+912>>2]=0}i=t+892|0;r=o[i>>2]|0;if(r){o[t+896>>2]=0;Br(r);o[i>>2]=0;o[t+900>>2]=0}i=t+876|0;r=o[i>>2]|0;if(r){o[t+880>>2]=0;Br(r);o[i>>2]=0;o[t+884>>2]=0}i=t+856|0;r=o[i>>2]|0;if(r){o[t+860>>2]=0;Br(r);o[i>>2]=0;o[t+864>>2]=0}r=t+836|0;i=o[r>>2]|0;if(i){o[t+840>>2]=0;Br(i);o[r>>2]=0;o[t+844>>2]=0}i=t+824|0;r=o[i>>2]|0;if(r){o[t+828>>2]=0;Br(r);o[i>>2]=0;o[t+832>>2]=0}i=t+808|0;r=o[i>>2]|0;if(r){o[t+812>>2]=0;Br(r);o[i>>2]=0;o[t+816>>2]=0}Di(t+760|0);i=t+744|0;r=o[i>>2]|0;if(r){o[t+748>>2]=0;Br(r);o[i>>2]=0;o[t+752>>2]=0}i=t+732|0;r=o[i>>2]|0;if(!r){Ce(t);c=e;return}o[t+736>>2]=0;Br(r);o[i>>2]=0;o[t+740>>2]=0;Ce(t);c=e;return}function yi(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,a=0,l=0,u=0,h=0;n=c;c=c+32|0;a=n+12|0;u=n+8|0;h=n+16|0;s=n+4|0;l=n;r[h>>0]=r[e>>0]|0;r[a+0>>0]=r[h+0>>0]|0;i=xe(t,a,i)|0;o[u>>2]=i;ni(t+876|0,i,0);ni(t+904|0,i,0);if(!(r[t+724>>0]|0)){c=n;return i|0}h=t+808|0;e=i<<1;o[s>>2]=e;o[a+0>>2]=o[s+0>>2];Vi(h,a,0);o[l>>2]=e|1;o[a+0>>2]=o[l+0>>2];Vi(h,a,0);Bi(t+760|0,u);ni(t+744|0,i,0);Ui(t+824|0,i);c=n;return i|0}function wi(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0,k=0;u=c;c=c+32|0;a=u+4|0;_=u;p=u+16|0;o[a>>2]=0;l=a+4|0;o[l>>2]=0;h=a+8|0;o[h>>2]=0;v=r[2608]|0;r[t>>0]=v;f=e+724|0;i=(s[f>>0]&(i&1)|0)!=0;if(i){y=e+308|0;k=o[y>>2]|0;if((k|0)>0){b=e+304|0;v=e+876|0;w=0;do{E=o[(o[b>>2]|0)+(w<<2)>>2]>>1;o[_>>2]=E;E=(o[v>>2]|0)+E|0;if(!(r[E>>0]|0)){r[E>>0]=1;ai(a,_);k=o[y>>2]|0}w=w+1|0}while((w|0)<(k|0))}_=(Ei(e,n)|0)&1^1;r[t>>0]=_;n=r[2608]|0}else{n=v;_=v}k=n&255;if(!((k>>>1^1)&_<<24>>24==n<<24>>24|k&2&(_&255))){if((o[e+44>>2]|0)>0)Bt(3760)|0}else{Xe(p,e);_=r[p>>0]|0;r[t>>0]=_}E=r[2608]|0;k=E&255;if((((k>>>1^1)&_<<24>>24==E<<24>>24|k&2&(_&255)|0)!=0?(r[e+707>>0]|0)!=0:0)?(g=(o[e+736>>2]|0)+-1|0,(g|0)>0):0){t=e+732|0;p=e+4|0;do{n=o[t>>2]|0;y=o[n+(g<<2)>>2]|0;w=g+-1|0;E=o[n+(w<<2)>>2]|0;g=o[p>>2]|0;t:do{if((y|0)>1){v=r[2616]|0;_=v&255;b=_&2;_=_>>>1^1;k=w;while(1){E=s[g+(E>>1)>>0]^E&1;w=y+-1|0;if(!((E&255)<<24>>24==v<<24>>24&_|b&E))break t;y=k+-1|0;E=o[n+(y<<2)>>2]|0;if((w|0)>1){k=y;y=w}else{k=y;y=w;m=20;break}}}else{k=w;m=20}}while(0);if((m|0)==20){m=0;r[g+(E>>1)>>0]=(E&1^1)&255^1}g=k-y|0}while((g|0)>0)}if(i?(d=o[l>>2]|0,(d|0)>0):0){m=o[a>>2]|0;i=e+876|0;p=0;do{t=o[m+(p<<2)>>2]|0;r[(o[i>>2]|0)+t>>0]=0;if(r[f>>0]|0)Ki(e,t);p=p+1|0}while((p|0)<(d|0))}e=o[a>>2]|0;if(!e){c=u;return}o[l>>2]=0;Br(e);o[a>>2]=0;o[h>>2]=0;c=u;return}function Ei(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,f=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0,k=0,S=0,M=0,A=0,T=0,C=0,x=0,R=0,O=0,L=0,P=0,N=0,I=0;u=c;c=c+16|0;a=u;if(!(qe(t)|0)){P=0;c=u;return P|0}l=t+724|0;if(!(r[l>>0]|0)){P=1;c=u;return P|0}k=t+924|0;w=t+872|0;E=t+868|0;y=t+860|0;_=t+680|0;S=t+824|0;s=t+828|0;m=t+836|0;M=t+904|0;A=t+332|0;i=t+44|0;T=t+704|0;x=t+706|0;R=t+696|0;p=t+556|0;g=t+548|0;C=t+876|0;v=t+920|0;b=t+284|0;t:while(1){if(((o[k>>2]|0)<=0?(o[v>>2]|0)>=(o[b>>2]|0):0)?(o[s>>2]|0)<=0:0)break;Ci(t);L=o[w>>2]|0;P=o[E>>2]|0;O=L-P|0;if((L|0)<(P|0))O=(o[y>>2]|0)+O|0;if(!((O|0)<=0?(o[v>>2]|0)>=(o[b>>2]|0):0))f=11;if((f|0)==11?(f=0,!(xi(t,1)|0)):0){f=12;break}P=o[s>>2]|0;if(r[_>>0]|0){f=15;break}if(!P)continue;else O=0;while(1){I=o[S>>2]|0;L=o[I>>2]|0;N=o[I+(P+-1<<2)>>2]|0;o[I>>2]=N;P=o[m>>2]|0;o[P+(N<<2)>>2]=0;o[P+(L<<2)>>2]=-1;P=(o[s>>2]|0)+-1|0;o[s>>2]=P;if((P|0)>1)Hi(S,0);if(r[_>>0]|0)continue t;if((r[(o[M>>2]|0)+L>>0]|0)==0?(N=r[(o[A>>2]|0)+L>>0]|0,P=r[2624]|0,I=P&255,((I>>>1^1)&N<<24>>24==P<<24>>24|N&2&I|0)!=0):0){if((o[i>>2]|0)>1&((O|0)%100|0|0)==0){o[a>>2]=o[s>>2];Ut(3504,a|0)|0}if(r[T>>0]|0){I=(o[C>>2]|0)+L|0;P=r[I>>0]|0;r[I>>0]=1;if(!(Oi(t,L)|0)){f=29;break t}r[(o[C>>2]|0)+L>>0]=P<<24>>24!=0&1}if((((r[x>>0]|0)!=0?(N=r[(o[A>>2]|0)+L>>0]|0,P=r[2624]|0,I=P&255,((I>>>1^1)&N<<24>>24==P<<24>>24|N&2&I|0)!=0):0)?(r[(o[C>>2]|0)+L>>0]|0)==0:0)?!(Li(t,L)|0):0){f=35;break t}if(+((o[p>>2]|0)>>>0)>+h[R>>3]*+((o[g>>2]|0)>>>0))Hn[o[(o[t>>2]|0)+8>>2]&31](t)}P=o[s>>2]|0;if(!P)continue t;else O=O+1|0}}do{if((f|0)==12)r[t+492>>0]=0;else if((f|0)==15){_=o[t+824>>2]|0;if((P|0)<=0){if(!_)break}else{b=o[m>>2]|0;v=0;do{o[b+(o[_+(v<<2)>>2]<<2)>>2]=-1;v=v+1|0}while((v|0)<(o[s>>2]|0))}o[s>>2]=0}else if((f|0)==29)r[t+492>>0]=0;else if((f|0)==35)r[t+492>>0]=0}while(0);if(!e){if(+((o[p>>2]|0)>>>0)>+h[t+96>>3]*+((o[g>>2]|0)>>>0))Hn[o[(o[t>>2]|0)+8>>2]&31](t)}else{e=t+744|0;p=o[e>>2]|0;if(p){o[t+748>>2]=0;Br(p);o[e>>2]=0;o[t+752>>2]=0}Wi(t+760|0,1);e=t+808|0;p=o[e>>2]|0;if(p){o[t+812>>2]=0;Br(p);o[e>>2]=0;o[t+816>>2]=0}p=t+824|0;e=o[p>>2]|0;if((o[s>>2]|0)<=0){if(e)f=48}else{f=o[m>>2]|0;m=0;do{o[f+(o[e+(m<<2)>>2]<<2)>>2]=-1;m=m+1|0}while((m|0)<(o[s>>2]|0));f=48}if((f|0)==48){o[s>>2]=0;Br(e);o[p>>2]=0;o[t+832>>2]=0}zi(t+856|0,1);r[l>>0]=0;r[t+536>>0]=1;r[t+560>>0]=0;o[t+728>>2]=o[t+540>>2];ze(t);Hn[o[(o[t>>2]|0)+8>>2]&31](t)}if((o[i>>2]|0)>0?(n=o[t+736>>2]|0,(n|0)>0):0){h[d>>3]=+(n<<2>>>0)*9.5367431640625e-7;o[a>>2]=o[d>>2];o[a+4>>2]=o[d+4>>2];Ut(3528,a|0)|0}I=(r[t+492>>0]|0)!=0;c=u;return I|0}function ki(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0;i=c;c=c+16|0;s=i;l=t+256|0;u=t+260|0;a=o[u>>2]|0;if((r[t+705>>0]|0)!=0?Si(t,e)|0:0){p=1;c=i;return p|0}if(!(Re(t,e)|0)){p=0;c=i;return p|0}if(!(r[t+724>>0]|0)){p=1;c=i;return p|0}e=o[u>>2]|0;if((e|0)!=(a+1|0)){p=1;c=i;return p|0}p=o[(o[l>>2]|0)+(e+-1<<2)>>2]|0;o[s>>2]=p;f=(o[t+544>>2]|0)+(p<<2)|0;qi(t+856|0,p);if((o[f>>2]|0)>>>0<=31){p=1;c=i;return p|0}h=t+760|0;u=t+808|0;l=t+744|0;a=t+924|0;e=t+824|0;d=t+840|0;t=t+836|0;m=0;do{p=f+(m<<2)+4|0;ji((o[h>>2]|0)+((o[p>>2]>>1)*12|0)|0,s);g=(o[u>>2]|0)+(o[p>>2]<<2)|0;o[g>>2]=(o[g>>2]|0)+1;r[(o[l>>2]|0)+(o[p>>2]>>1)>>0]=1;o[a>>2]=(o[a>>2]|0)+1;p=o[p>>2]>>1;if((o[d>>2]|0)>(p|0)?(n=o[(o[t>>2]|0)+(p<<2)>>2]|0,(n|0)>-1):0)Hi(e,n);m=m+1|0}while((m|0)<((o[f>>2]|0)>>>5|0));n=1;c=i;return n|0}function Si(t,e){t=t|0;e=e|0;var i=0,n=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0;u=c;c=c+16|0;a=u+8|0;l=u+4|0;n=u;o[l>>2]=o[t+284>>2];ai(t+292|0,l);l=e+4|0;f=o[l>>2]|0;t:do{if((f|0)>0){i=t+332|0;h=0;while(1){d=o[(o[e>>2]|0)+(h<<2)>>2]|0;p=s[(o[i>>2]|0)+(d>>1)>>0]|0;g=p^d&1;m=g&255;v=r[2608]|0;_=v&255;if(m<<24>>24==v<<24>>24&(_>>>1^1)|_&2&g)break;_=r[2616]|0;v=_&255;if(!((v>>>1^1)&m<<24>>24==_<<24>>24|p&2&v)){o[n>>2]=d^1;o[a+0>>2]=o[n+0>>2];Oe(t,a,-1);f=o[l>>2]|0}h=h+1|0;if((h|0)>=(f|0))break t}De(t,0);v=1;c=u;return v|0}}while(0);v=(Le(t)|0)!=-1;De(t,0);c=u;return v|0}function Mi(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0;i=c;c=c+16|0;s=i;n=(o[t+544>>2]|0)+(e<<2)|0;if(!(r[t+724>>0]|0)){Ie(t,e);c=i;return}if((o[n>>2]|0)>>>0<=31){Ie(t,e);c=i;return}l=t+808|0;u=t+776|0;a=t+792|0;h=0;do{f=n+(h<<2)+4|0;d=(o[l>>2]|0)+(o[f>>2]<<2)|0;o[d>>2]=(o[d>>2]|0)+-1;Ki(t,o[f>>2]>>1);f=o[f>>2]>>1;o[s>>2]=f;f=(o[u>>2]|0)+f|0;if(!(r[f>>0]|0)){r[f>>0]=1;ai(a,s)}h=h+1|0}while((h|0)<((o[n>>2]|0)>>>5|0));Ie(t,e);c=i;return}function Ai(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0;n=c;c=c+16|0;l=n+4|0;a=n;h=o[t+544>>2]|0;u=h+(e<<2)|0;qi(t+856|0,e);if((o[u>>2]&-32|0)==64){Mi(t,e);p=o[i>>2]|0;i=o[u>>2]|0;t:do{if(i>>>0>31){f=i>>>5;d=0;while(1){m=d+1|0;if((o[u+(d<<2)+4>>2]|0)==(p|0)){m=d;break t}if((m|0)<(f|0))d=m;else break}}else{f=0;m=0}}while(0);d=f+-1|0;if((m|0)<(d|0))do{i=m;m=m+1|0;o[u+(i<<2)+4>>2]=o[u+(m<<2)+4>>2];i=o[u>>2]|0;f=i>>>5;d=f+-1|0}while((m|0)<(d|0));if(i&8){o[u+(d<<2)+4>>2]=o[u+(f<<2)+4>>2];i=o[u>>2]|0}f=i+-32|0;o[u>>2]=f;f=f>>>5;if(!f){f=0;i=0}else{i=0;d=0;do{i=1<<((o[u+(d<<2)+4>>2]|0)>>>1&31)|i;d=d+1|0}while((d|0)<(f|0))}o[u+(f<<2)+4>>2]=i}else{Ne(t,e,1);i=o[i>>2]|0;d=o[u>>2]|0;t:do{if(d>>>0>31){f=d>>>5;m=0;while(1){p=m+1|0;if((o[u+(m<<2)+4>>2]|0)==(i|0)){p=m;break t}if((p|0)<(f|0))m=p;else break}}else{f=0;p=0}}while(0);m=f+-1|0;if((p|0)<(m|0))do{d=p;p=p+1|0;o[u+(d<<2)+4>>2]=o[u+(p<<2)+4>>2];d=o[u>>2]|0;f=d>>>5;m=f+-1|0}while((p|0)<(m|0));if(d&8){o[u+(m<<2)+4>>2]=o[u+(f<<2)+4>>2];d=o[u>>2]|0}m=d+-32|0;o[u>>2]=m;m=m>>>5;if(!m){m=0;f=0}else{f=0;d=0;do{f=1<<((o[u+(d<<2)+4>>2]|0)>>>1&31)|f;d=d+1|0}while((d|0)<(m|0))}o[u+(m<<2)+4>>2]=f;Pe(t,e);f=i>>1;d=o[t+760>>2]|0;m=d+(f*12|0)|0;d=d+(f*12|0)+4|0;p=o[d>>2]|0;t:do{if((p|0)>0){v=o[m>>2]|0;g=0;while(1){_=g+1|0;if((o[v+(g<<2)>>2]|0)==(e|0))break t;if((_|0)<(p|0))g=_;else{g=_;break}}}else g=0}while(0);p=p+-1|0;if((g|0)<(p|0)){m=o[m>>2]|0;do{p=g;g=g+1|0;o[m+(p<<2)>>2]=o[m+(g<<2)>>2];p=(o[d>>2]|0)+-1|0}while((g|0)<(p|0))}o[d>>2]=p;v=(o[t+808>>2]|0)+(i<<2)|0;o[v>>2]=(o[v>>2]|0)+-1;Ki(t,f)}if((o[u>>2]&-32|0)!=32){v=1;c=n;return v|0}h=o[h+(e+1<<2)>>2]|0;u=s[(o[t+332>>2]|0)+(h>>1)>>0]|0;v=u^h&1;e=v&255;g=r[2624]|0;_=g&255;if(!(e<<24>>24==g<<24>>24&(_>>>1^1)|_&2&v)){_=r[2616]|0;v=_&255;if((v>>>1^1)&e<<24>>24==_<<24>>24|u&2&v){v=0;c=n;return v|0}}else{o[a>>2]=h;o[l+0>>2]=o[a+0>>2];Oe(t,l,-1)}v=(Le(t)|0)==-1;c=n;return v|0}function Ti(t,e,i,r,n){t=t|0;e=e|0;i=i|0;r=r|0;n=n|0;var s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0;s=c;c=c+16|0;l=s+4|0;a=s;m=t+708|0;o[m>>2]=(o[m>>2]|0)+1;if(o[n>>2]|0)o[n+4>>2]=0;u=(o[e>>2]|0)>>>5>>>0<(o[i>>2]|0)>>>5>>>0;t=u?i:e;e=u?e:i;u=o[e>>2]|0;t:do{if(u>>>0>31){i=0;e:while(1){h=o[e+(i<<2)+4>>2]|0;i:do{if((h>>1|0)!=(r|0)){f=o[t>>2]|0;r:do{if(f>>>0>31){d=0;while(1){m=o[t+(d<<2)+4>>2]|0;d=d+1|0;if((h^m)>>>0<2)break;if((d|0)>=(f>>>5|0))break r}if((m|0)==(h^1|0)){n=0;break e}else break i}}while(0);o[l>>2]=h;si(n,l);u=o[e>>2]|0}}while(0);i=i+1|0;if((i|0)>=(u>>>5|0))break t}c=s;return n|0}}while(0);i=o[t>>2]|0;if(i>>>0<=31){m=1;c=s;return m|0}l=0;do{e=o[t+(l<<2)+4>>2]|0;if((e>>1|0)!=(r|0)){o[a>>2]=e;si(n,a);i=o[t>>2]|0}l=l+1|0}while((l|0)<(i>>>5|0));n=1;c=s;return n|0}function Ci(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0;e=c;u=t+924|0;if(!(o[u>>2]|0)){c=e;return}a=t+856|0;i=t+872|0;n=t+868|0;l=t+860|0;s=t+544|0;h=0;while(1){E=o[i>>2]|0;f=o[n>>2]|0;d=E-f|0;if((E|0)<(f|0))d=(o[l>>2]|0)+d|0;if((h|0)>=(d|0))break;d=(o[s>>2]|0)+(o[(o[a>>2]|0)+(((f+h|0)%(o[l>>2]|0)|0)<<2)>>2]<<2)|0;f=o[d>>2]|0;if(!(f&3))o[d>>2]=f&-4|2;h=h+1|0}h=t+540|0;g=o[h>>2]|0;if((g|0)>0){d=t+744|0;m=t+776|0;f=t+760|0;t=t+804|0;p=0;do{if(r[(o[d>>2]|0)+p>>0]|0){_=(o[m>>2]|0)+p|0;if(r[_>>0]|0){v=o[f>>2]|0;g=v+(p*12|0)+4|0;y=o[g>>2]|0;if((y|0)>0){v=o[v+(p*12|0)>>2]|0;w=0;b=0;do{E=o[v+(w<<2)>>2]|0;if((o[(o[o[t>>2]>>2]|0)+(E<<2)>>2]&3|0)!=1){o[v+(b<<2)>>2]=E;y=o[g>>2]|0;b=b+1|0}w=w+1|0}while((w|0)<(y|0))}else{w=0;b=0}v=w-b|0;if((v|0)>0)o[g>>2]=y-v;r[_>>0]=0}_=o[f>>2]|0;g=_+(p*12|0)+4|0;b=o[g>>2]|0;if((b|0)>0){_=_+(p*12|0)|0;v=0;do{y=o[(o[_>>2]|0)+(v<<2)>>2]|0;if(!(o[(o[s>>2]|0)+(y<<2)>>2]&3)){qi(a,y);b=(o[s>>2]|0)+(o[(o[_>>2]|0)+(v<<2)>>2]<<2)|0;o[b>>2]=o[b>>2]&-4|2;b=o[g>>2]|0}v=v+1|0}while((v|0)<(b|0))}r[(o[d>>2]|0)+p>>0]=0;g=o[h>>2]|0}p=p+1|0}while((p|0)<(g|0));h=0}else h=0;while(1){E=o[i>>2]|0;f=o[n>>2]|0;d=E-f|0;if((E|0)<(f|0))d=(o[l>>2]|0)+d|0;if((h|0)>=(d|0))break;f=(o[s>>2]|0)+(o[(o[a>>2]|0)+(((f+h|0)%(o[l>>2]|0)|0)<<2)>>2]<<2)|0;d=o[f>>2]|0;if((d&3|0)==2)o[f>>2]=d&-4;h=h+1|0}o[u>>2]=0;c=e;return}function xi(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0,k=0,S=0,M=0,A=0,T=0,C=0,x=0,R=0,O=0,L=0,P=0,N=0,I=0,F=0,D=0,V=0,B=0,U=0,K=0;i=c;c=c+16|0;f=i;k=i+12|0;s=t+856|0;h=t+872|0;g=t+868|0;l=t+860|0;y=t+680|0;n=t+920|0;a=t+284|0;b=t+280|0;_=t+544|0;v=t+928|0;m=t+44|0;d=t+776|0;w=t+692|0;p=t+804|0;u=t+760|0;C=0;O=0;x=0;t:while(1){R=o[g>>2]|0;do{A=o[h>>2]|0;T=(A|0)<(R|0);A=A-R|0;if(T)L=(o[l>>2]|0)+A|0;else L=A;if((L|0)<=0?(o[n>>2]|0)>=(o[a>>2]|0):0){n=1;l=53;break t}if(r[y>>0]|0){l=8;break t}if(T)A=(o[l>>2]|0)+A|0;if((A|0)==0?(M=o[n>>2]|0,(M|0)<(o[a>>2]|0)):0){o[n>>2]=M+1;o[(o[_>>2]|0)+((o[v>>2]|0)+1<<2)>>2]=o[(o[b>>2]|0)+(M<<2)>>2];A=(o[_>>2]|0)+(o[v>>2]<<2)|0;T=(o[A>>2]|0)>>>5;if(!T){T=0;L=0}else{L=0;R=0;do{L=1<<((o[A+(R<<2)+4>>2]|0)>>>1&31)|L;R=R+1|0}while((R|0)<(T|0))}o[A+(T<<2)+4>>2]=L;qi(s,o[v>>2]|0);R=o[g>>2]|0}A=o[(o[s>>2]|0)+(R<<2)>>2]|0;R=R+1|0;I=o[l>>2]|0;R=(R|0)==(I|0)?0:R;o[g>>2]=R;L=o[_>>2]|0;T=L+(A<<2)|0;N=o[T>>2]|0}while((N&3|0)!=0);if(e?(o[m>>2]|0)>1:0){P=C+1|0;if(!((C|0)%1e3|0)){N=o[h>>2]|0;o[f>>2]=N-R+((N|0)<(R|0)?I:0);o[f+4>>2]=x;o[f+8>>2]=O;Ut(3440,f|0)|0;N=o[T>>2]|0;C=P}else C=P}R=L+(A+1<<2)|0;L=o[R>>2]>>1;if(N>>>0>63){P=o[u>>2]|0;N=N>>>5;I=1;do{K=o[T+(I<<2)+4>>2]>>1;L=(o[P+(K*12|0)+4>>2]|0)<(o[P+(L*12|0)+4>>2]|0)?K:L;I=I+1|0}while((I|0)<(N|0))}N=(o[d>>2]|0)+L|0;if(r[N>>0]|0){I=o[u>>2]|0;P=I+(L*12|0)+4|0;V=o[P>>2]|0;if((V|0)>0){I=o[I+(L*12|0)>>2]|0;D=0;F=0;do{B=o[I+(D<<2)>>2]|0;if((o[(o[o[p>>2]>>2]|0)+(B<<2)>>2]&3|0)!=1){o[I+(F<<2)>>2]=B;V=o[P>>2]|0;F=F+1|0}D=D+1|0}while((D|0)<(V|0))}else{D=0;F=0}I=D-F|0;if((I|0)>0)o[P>>2]=V-I;r[N>>0]=0}N=o[u>>2]|0;P=o[N+(L*12|0)>>2]|0;N=N+(L*12|0)+4|0;if((o[N>>2]|0)>0)I=0;else continue;while(1){B=o[T>>2]|0;if(B&3)continue t;F=o[P+(I<<2)>>2]|0;D=o[_>>2]|0;U=D+(F<<2)|0;V=o[U>>2]|0;e:do{if(((!((V&3|0)!=0|(F|0)==(A|0))?(K=o[w>>2]|0,S=V>>>5,(K|0)==-1|(S|0)<(K|0)):0)?(E=B>>>5,S>>>0>=E>>>0):0)?(o[T+(E<<2)+4>>2]&~o[U+(S<<2)+4>>2]|0)==0:0){D=D+(F+1<<2)|0;do{if(B>>>0>31){if(V>>>0>31){U=-2;V=0}else break e;while(1){B=o[R+(V<<2)>>2]|0;i:do{if((U|0)==-2){K=0;while(1){U=o[D+(K<<2)>>2]|0;if((B|0)==(U|0)){B=-2;break i}K=K+1|0;if((B|0)==(U^1|0))break i;if(K>>>0>=S>>>0)break e}}else{K=0;while(1){if((B|0)==(o[D+(K<<2)>>2]|0)){B=U;break i}K=K+1|0;if(K>>>0>=S>>>0)break e}}}while(0);V=V+1|0;if(V>>>0>=E>>>0)break;else U=B}if((B|0)==-2)break;else if((B|0)==-1)break e;o[k>>2]=B^1;o[f+0>>2]=o[k+0>>2];if(!(Ai(t,F,f)|0)){n=0;l=53;break t}O=O+1|0;I=(((B>>1|0)==(L|0))<<31>>31)+I|0;break e}}while(0);Mi(t,F);x=x+1|0}}while(0);I=I+1|0;if((I|0)>=(o[N>>2]|0))continue t}}if((l|0)==8){zi(s,0);o[n>>2]=o[a>>2];K=1;c=i;return K|0}else if((l|0)==53){c=i;return n|0}return 0}function Ri(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0;a=c;c=c+16|0;n=a+12|0;f=a+8|0;u=a+4|0;l=a;h=(o[t+544>>2]|0)+(i<<2)|0;if(o[h>>2]&3){_=1;c=a;return _|0}if(Fe(t,h)|0){_=1;c=a;return _|0}o[f>>2]=o[t+284>>2];ai(t+292|0,f);p=o[h>>2]|0;if(p>>>0>31){f=t+332|0;d=0;m=-2;do{g=o[h+(d<<2)+4>>2]|0;_=g>>1;if((_|0)!=(e|0)?(_=(s[(o[f>>2]|0)+_>>0]|0)^g&1,b=r[2616]|0,v=b&255,((_&255)<<24>>24==b<<24>>24&(v>>>1^1)|v&2&_|0)==0):0){o[u>>2]=g^1;o[n+0>>2]=o[u+0>>2];Oe(t,n,-1);p=o[h>>2]|0}else m=g;d=d+1|0}while((d|0)<(p>>>5|0))}else m=-2;b=(Le(t)|0)==-1;De(t,0);if(!b){b=t+712|0;o[b>>2]=(o[b>>2]|0)+1;o[l>>2]=m;o[n+0>>2]=o[l+0>>2];if(!(Ai(t,i,n)|0)){b=0;c=a;return b|0}}b=1;c=a;return b|0}function Oi(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0;i=c;a=(o[t+776>>2]|0)+e|0;n=t+760|0;if(r[a>>0]|0){u=o[n>>2]|0;s=u+(e*12|0)+4|0;d=o[s>>2]|0;if((d|0)>0){l=t+804|0;u=o[u+(e*12|0)>>2]|0;f=0;h=0;do{m=o[u+(f<<2)>>2]|0;if((o[(o[o[l>>2]>>2]|0)+(m<<2)>>2]&3|0)!=1){o[u+(h<<2)>>2]=m;d=o[s>>2]|0;h=h+1|0}f=f+1|0}while((f|0)<(d|0))}else{f=0;h=0}l=f-h|0;if((l|0)>0)o[s>>2]=d-l;r[a>>0]=0}s=o[n>>2]|0;d=r[(o[t+332>>2]|0)+e>>0]|0;f=r[2624]|0;m=f&255;if(!((m>>>1^1)&d<<24>>24==f<<24>>24|d&2&m)){m=1;c=i;return m|0}n=s+(e*12|0)+4|0;a=o[n>>2]|0;if(!a){m=1;c=i;return m|0}t:do{if((a|0)>0){s=s+(e*12|0)|0;a=0;while(1){if(!(Ri(t,e,o[(o[s>>2]|0)+(a<<2)>>2]|0)|0)){t=0;break}a=a+1|0;if((a|0)>=(o[n>>2]|0))break t}c=i;return t|0}}while(0);m=xi(t,0)|0;c=i;return m|0}function Li(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0,k=0,S=0,M=0,A=0,T=0,C=0,x=0,R=0,O=0,L=0,P=0,I=0,F=0,D=0,V=0,B=0,U=0,K=0,H=0,W=0,z=0,q=0,j=0,X=0,Y=0,$=0,G=0,Z=0;i=c;c=c+48|0;v=i+36|0;_=i+32|0;b=i+28|0;y=i+24|0;n=i+12|0;s=i;d=(o[t+776>>2]|0)+e|0;f=t+760|0;if(r[d>>0]|0){g=o[f>>2]|0;m=g+(e*12|0)+4|0;S=o[m>>2]|0;if((S|0)>0){p=t+804|0;g=o[g+(e*12|0)>>2]|0;E=0;w=0;do{M=o[g+(E<<2)>>2]|0;if((o[(o[o[p>>2]>>2]|0)+(M<<2)>>2]&3|0)!=1){o[g+(w<<2)>>2]=M;S=o[m>>2]|0;w=w+1|0}E=E+1|0}while((E|0)<(S|0))}else{E=0;w=0}p=E-w|0;if((p|0)>0)o[m>>2]=S-p;r[d>>0]=0}w=o[f>>2]|0;E=w+(e*12|0)|0;o[n>>2]=0;d=n+4|0;o[d>>2]=0;m=n+8|0;o[m>>2]=0;o[s>>2]=0;g=s+4|0;o[g>>2]=0;p=s+8|0;o[p>>2]=0;w=w+(e*12|0)+4|0;t:do{if((o[w>>2]|0)>0){S=t+544|0;T=e<<1;A=0;do{C=(o[E>>2]|0)+(A<<2)|0;R=(o[S>>2]|0)+(o[C>>2]<<2)|0;Z=o[R>>2]|0;M=Z>>>5;e:do{if(Z>>>0>31){O=0;while(1){x=O+1|0;if((o[R+(O<<2)+4>>2]|0)==(T|0)){x=O;break e}if((x|0)<(M|0))O=x;else break}}else x=0}while(0);ji((x|0)<(M|0)?n:s,C);A=A+1|0;M=o[w>>2]|0}while((A|0)<(M|0));S=o[d>>2]|0;T=(S|0)>0;if(T){C=o[g>>2]|0;F=(C|0)>0;I=t+544|0;x=o[n>>2]|0;A=o[s>>2]|0;R=t+708|0;P=t+684|0;L=t+688|0;K=0;O=0;while(1){if(F){V=x+(O<<2)|0;D=o[I>>2]|0;B=o[R>>2]|0;U=0;do{z=D+(o[V>>2]<<2)|0;j=D+(o[A+(U<<2)>>2]<<2)|0;B=B+1|0;o[R>>2]=B;H=(o[z>>2]|0)>>>5>>>0<(o[j>>2]|0)>>>5>>>0;W=H?j:z;j=H?z:j;z=W+4|0;H=j+4|0;W=o[W>>2]|0;q=W>>>5;Y=q+-1|0;j=o[j>>2]|0;e:do{if(j>>>0>31){X=0;while(1){Z=o[H+(X<<2)>>2]|0;i:do{if((Z>>1|0)!=(e|0)){r:do{if(W>>>0>31){G=0;while(1){$=o[z+(G<<2)>>2]|0;G=G+1|0;if(($^Z)>>>0<2)break;if((G|0)>=(q|0))break r}if(($|0)==(Z^1|0))break e;else break i}}while(0);Y=Y+1|0}}while(0);X=X+1|0;if((X|0)>=(j>>>5|0)){k=28;break}}}else k=28}while(0);if((k|0)==28){k=0;if((K|0)>=((o[P>>2]|0)+M|0)){t=1;break t}Z=o[L>>2]|0;if((Z|0)!=-1&(Y|0)>(Z|0)){t=1;break t}else K=K+1|0}U=U+1|0}while((U|0)<(C|0))}O=O+1|0;if((O|0)>=(S|0)){k=32;break}}}else{T=0;k=32}}else{S=0;T=0;k=32}}while(0);t:do{if((k|0)==32){r[(o[t+904>>2]|0)+e>>0]=1;M=t+380|0;A=(o[M>>2]|0)+e|0;if(r[A>>0]|0){Z=t+200|0;G=Z;G=ln(o[G>>2]|0,o[G+4>>2]|0,-1,-1)|0;o[Z>>2]=G;o[Z+4>>2]=N}r[A>>0]=0;A=t+460|0;if(!((o[t+476>>2]|0)>(e|0)?(o[(o[t+472>>2]|0)+(e<<2)>>2]|0)>-1:0))k=36;if((k|0)==36?(r[(o[M>>2]|0)+e>>0]|0)!=0:0)oi(A,e);k=t+716|0;o[k>>2]=(o[k>>2]|0)+1;k=o[g>>2]|0;if((S|0)>(k|0)){A=t+732|0;if((k|0)>0){y=t+544|0;b=o[s>>2]|0;R=t+736|0;x=0;do{C=(o[y>>2]|0)+(o[b+(x<<2)>>2]<<2)|0;M=o[R>>2]|0;if((o[C>>2]|0)>>>0>31){O=0;L=-1;do{Z=C+(O<<2)+4|0;o[v>>2]=o[Z>>2];ji(A,v);L=(o[Z>>2]>>1|0)==(e|0)?O+M|0:L;O=O+1|0}while((O|0)<((o[C>>2]|0)>>>5|0))}else L=-1;Z=o[A>>2]|0;$=Z+(L<<2)|0;G=o[$>>2]|0;Z=Z+(M<<2)|0;o[$>>2]=o[Z>>2];o[Z>>2]=G;o[_>>2]=(o[C>>2]|0)>>>5;ji(A,_);x=x+1|0}while((x|0)<(k|0))}o[v>>2]=e<<1;ji(A,v);o[_>>2]=1;ji(A,_)}else{x=t+732|0;if(T){O=t+544|0;R=o[n>>2]|0;M=t+736|0;L=0;do{C=(o[O>>2]|0)+(o[R+(L<<2)>>2]<<2)|0;A=o[M>>2]|0;if((o[C>>2]|0)>>>0>31){P=0;I=-1;do{Z=C+(P<<2)+4|0;o[v>>2]=o[Z>>2];ji(x,v);I=(o[Z>>2]>>1|0)==(e|0)?P+A|0:I;P=P+1|0}while((P|0)<((o[C>>2]|0)>>>5|0))}else I=-1;Z=o[x>>2]|0;$=Z+(I<<2)|0;G=o[$>>2]|0;Z=Z+(A<<2)|0;o[$>>2]=o[Z>>2];o[Z>>2]=G;o[_>>2]=(o[C>>2]|0)>>>5;ji(x,_);L=L+1|0}while((L|0)<(S|0))}o[b>>2]=e<<1|1;ji(x,b);o[y>>2]=1;ji(x,y)}if((o[w>>2]|0)>0){_=0;do{Mi(t,o[(o[E>>2]|0)+(_<<2)>>2]|0);_=_+1|0}while((_|0)<(o[w>>2]|0))}_=t+628|0;e:do{if(T){v=t+544|0;E=o[n>>2]|0;A=o[s>>2]|0;if((k|0)>0)w=0;else{_=0;while(1){_=_+1|0;if((_|0)>=(S|0))break e}}do{y=E+(w<<2)|0;b=0;do{Z=o[v>>2]|0;if(Ti(t,Z+(o[y>>2]<<2)|0,Z+(o[A+(b<<2)>>2]<<2)|0,e,_)|0?!(ki(t,_)|0):0){t=0;break t}b=b+1|0}while((b|0)<(k|0));w=w+1|0}while((w|0)<(S|0))}}while(0);_=o[f>>2]|0;f=_+(e*12|0)|0;v=o[f>>2]|0;if(v){o[_+(e*12|0)+4>>2]=0;Br(v);o[f>>2]=0;o[_+(e*12|0)+8>>2]=0}f=t+412|0;e=e<<1;v=o[f>>2]|0;_=v+(e*12|0)+4|0;if((o[_>>2]|0)==0?(h=v+(e*12|0)|0,u=o[h>>2]|0,(u|0)!=0):0){o[_>>2]=0;Br(u);o[h>>2]=0;o[v+(e*12|0)+8>>2]=0;v=o[f>>2]|0}u=e|1;h=v+(u*12|0)+4|0;if((o[h>>2]|0)==0?(l=v+(u*12|0)|0,a=o[l>>2]|0,(a|0)!=0):0){o[h>>2]=0;Br(a);o[l>>2]=0;o[v+(u*12|0)+8>>2]=0}t=xi(t,0)|0;A=o[s>>2]|0}}while(0);if(A){o[g>>2]=0;Br(A);o[s>>2]=0;o[p>>2]=0}s=o[n>>2]|0;if(!s){c=i;return t|0}o[d>>2]=0;Br(s);o[n>>2]=0;o[m>>2]=0;c=i;return t|0}function Pi(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0;i=c;if(!(r[t+724>>0]|0)){c=i;return}h=t+540|0;if((o[h>>2]|0)>0){l=t+760|0;n=t+804|0;s=t+776|0;u=t+544|0;a=0;do{d=o[l>>2]|0;f=d+(a*12|0)+4|0;p=o[f>>2]|0;if((p|0)>0){d=o[d+(a*12|0)>>2]|0;g=0;m=0;do{_=o[d+(g<<2)>>2]|0;if((o[(o[o[n>>2]>>2]|0)+(_<<2)>>2]&3|0)!=1){o[d+(m<<2)>>2]=_;p=o[f>>2]|0;m=m+1|0}g=g+1|0}while((g|0)<(p|0))}else{g=0;m=0}d=g-m|0;if((d|0)>0)o[f>>2]=p-d;r[(o[s>>2]|0)+a>>0]=0;d=o[l>>2]|0;f=d+(a*12|0)+4|0;if((o[f>>2]|0)>0){_=d+(a*12|0)|0;p=0;do{d=(o[_>>2]|0)+(p<<2)|0;m=o[d>>2]|0;g=o[u>>2]|0;v=g+(m<<2)|0;if(!(o[v>>2]&16)){b=gi(e,v)|0;o[d>>2]=b;o[v>>2]=o[v>>2]|16;o[g+(m+1<<2)>>2]=b}else o[d>>2]=o[g+(m+1<<2)>>2];p=p+1|0}while((p|0)<(o[f>>2]|0))}a=a+1|0}while((a|0)<(o[h>>2]|0))}n=t+856|0;b=o[t+872>>2]|0;s=t+868|0;f=o[s>>2]|0;u=b-f|0;if((b|0)<(f|0))u=(o[t+860>>2]|0)+u|0;t:do{if((u|0)>0){a=t+860|0;l=t+544|0;while(1){h=o[(o[n>>2]|0)+(f<<2)>>2]|0;d=f+1|0;o[s>>2]=(d|0)==(o[a>>2]|0)?0:d;d=o[l>>2]|0;m=d+(h<<2)|0;f=o[m>>2]|0;if(!(f&3)){if(!(f&16)){b=gi(e,m)|0;o[m>>2]=o[m>>2]|16;o[d+(h+1<<2)>>2]=b;h=b}else h=o[d+(h+1<<2)>>2]|0;qi(n,h)}u=u+-1|0;if((u|0)<=0)break t;f=o[s>>2]|0}}else l=t+544|0}while(0);t=t+928|0;n=o[t>>2]|0;a=o[l>>2]|0;s=a+(n<<2)|0;if(!(o[s>>2]&16)){b=gi(e,s)|0;o[t>>2]=b;o[s>>2]=o[s>>2]|16;o[a+(n+1<<2)>>2]=b;c=i;return}else{o[t>>2]=o[a+(n+1<<2)>>2];c=i;return}}function Ni(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0;a=c;c=c+32|0;h=a;e=a+8|0;i=t+544|0;n=t+548|0;s=t+556|0;l=(o[n>>2]|0)-(o[s>>2]|0)|0;o[e+0>>2]=0;o[e+4>>2]=0;o[e+8>>2]=0;o[e+12>>2]=0;ti(e,l);l=e+16|0;u=t+560|0;r[l>>0]=r[u>>0]|0;Pi(t,e);Ye(t,e);if((o[t+44>>2]|0)>1){f=o[e+4>>2]<<2;o[h>>2]=o[n>>2]<<2;o[h+4>>2]=f;Ut(3608,h|0)|0}r[u>>0]=r[l>>0]|0;l=o[i>>2]|0;if(l)Br(l);o[i>>2]=o[e>>2];o[n>>2]=o[e+4>>2];o[t+552>>2]=o[e+8>>2];o[s>>2]=o[e+12>>2];c=a;return}function Ii(){var t=0,e=0,i=0;t=c;c=c+16|0;e=t;r[2608]=0;r[2616]=1;r[2624]=2;_e(2632,2656,2664,3744,3752);o[658]=160;r[2652]=0;_e(2704,2728,2736,3744,3752);o[676]=160;r[2724]=0;_e(2784,2808,2816,3744,3752);o[696]=160;r[2804]=1;_e(2848,2880,2888,3744,3736);o[712]=280;i=2868|0;o[i>>2]=-2147483648;o[i+4>>2]=2147483647;o[719]=0;_e(2960,2992,3e3,3744,3736);o[740]=280;i=2980|0;o[i>>2]=-1;o[i+4>>2]=2147483647;o[747]=20;_e(3112,3144,3152,3744,3736);o[778]=280;i=3132|0;o[i>>2]=-1;o[i+4>>2]=2147483647;o[785]=1e3;_e(3240,3296,3312,3744,3720);o[810]=2168;h[408]=0.0;h[409]=S;r[3280]=0;r[3281]=0;n[1641]=n[e+0>>1]|0;n[1642]=n[e+2>>1]|0;n[1643]=n[e+4>>1]|0;h[411]=.5;c=t;return}function Fi(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0;i=c;o[t>>2]=0;r=t+4|0;o[r>>2]=0;n=t+8|0;o[n>>2]=0;if((e|0)<=0){c=i;return}s=e+1&-2;s=(s|0)>2?s:2;o[n>>2]=s;n=Ur(0,s<<2)|0;o[t>>2]=n;if((n|0)==0?(o[(Wt()|0)>>2]|0)==12:0)Yt(St(1)|0,48,0);t=o[r>>2]|0;if((t|0)<(e|0))do{s=n+(t<<2)|0;if(s)o[s>>2]=0;t=t+1|0}while((t|0)!=(e|0));o[r>>2]=e;c=i;return}function Di(t){t=t|0;var e=0,i=0,r=0,n=0,s=0,a=0,l=0;e=c;r=t+32|0;i=o[r>>2]|0;if(i){o[t+36>>2]=0;Br(i);o[r>>2]=0;o[t+40>>2]=0}r=t+16|0;i=o[r>>2]|0;if(i){o[t+20>>2]=0;Br(i);o[r>>2]=0;o[t+24>>2]=0}r=o[t>>2]|0;if(!r){c=e;return}i=t+4|0;s=o[i>>2]|0;if((s|0)>0){n=0;do{l=r+(n*12|0)|0;a=o[l>>2]|0;if(a){o[r+(n*12|0)+4>>2]=0;Br(a);o[l>>2]=0;o[r+(n*12|0)+8>>2]=0;r=o[t>>2]|0;s=o[i>>2]|0}n=n+1|0}while((n|0)<(s|0))}o[i>>2]=0;Br(r);o[t>>2]=0;o[t+8>>2]=0;c=e;return}function Vi(t,e,i){t=t|0;e=e|0;i=i|0;var r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0;r=c;e=o[e>>2]|0;s=e+1|0;n=t+4|0;if((o[n>>2]|0)>=(s|0)){u=o[t>>2]|0;u=u+(e<<2)|0;o[u>>2]=i;c=r;return}a=t+8|0;u=o[a>>2]|0;if((u|0)<(s|0)){h=e+2-u&-2;l=(u>>1)+2&-2;l=(h|0)>(l|0)?h:l;if((l|0)>(2147483647-u|0)){h=St(1)|0;Yt(h|0,48,0)}f=o[t>>2]|0;h=l+u|0;o[a>>2]=h;h=Ur(f,h<<2)|0;o[t>>2]=h;if((h|0)==0?(o[(Wt()|0)>>2]|0)==12:0){f=St(1)|0;Yt(f|0,48,0)}}u=o[n>>2]|0;if((u|0)<(s|0)){a=o[t>>2]|0;do{l=a+(u<<2)|0;if(l)o[l>>2]=0;u=u+1|0}while((u|0)!=(s|0))}o[n>>2]=s;f=o[t>>2]|0;f=f+(e<<2)|0;o[f>>2]=i;c=r;return}function Bi(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0;i=c;u=o[e>>2]|0;s=u+1|0;n=t+4|0;if((o[n>>2]|0)<(s|0)){l=t+8|0;a=o[l>>2]|0;if((a|0)<(s|0)){h=u+2-a&-2;u=(a>>1)+2&-2;u=(h|0)>(u|0)?h:u;if((u|0)>(2147483647-a|0)){h=St(1)|0;Yt(h|0,48,0)}f=o[t>>2]|0;h=u+a|0;o[l>>2]=h;h=Ur(f,h*12|0)|0;o[t>>2]=h;if((h|0)==0?(o[(Wt()|0)>>2]|0)==12:0){f=St(1)|0;Yt(f|0,48,0)}}l=o[n>>2]|0;if((l|0)<(s|0)){a=o[t>>2]|0;do{u=a+(l*12|0)|0;if(u){o[u>>2]=0;o[a+(l*12|0)+4>>2]=0;o[a+(l*12|0)+8>>2]=0}l=l+1|0}while((l|0)!=(s|0))}o[n>>2]=s;a=o[e>>2]|0}else a=u;n=o[t>>2]|0;if(o[n+(a*12|0)>>2]|0){o[n+(a*12|0)+4>>2]=0;a=o[e>>2]|0}e=t+16|0;n=a+1|0;s=t+20|0;if((o[s>>2]|0)>=(n|0)){c=i;return}l=t+24|0;t=o[l>>2]|0;if((t|0)<(n|0)){f=a+2-t&-2;a=(t>>1)+2&-2;a=(f|0)>(a|0)?f:a;if((a|0)>(2147483647-t|0)){f=St(1)|0;Yt(f|0,48,0)}h=o[e>>2]|0;f=a+t|0;o[l>>2]=f;f=Ur(h,f)|0;o[e>>2]=f;if((f|0)==0?(o[(Wt()|0)>>2]|0)==12:0){f=St(1)|0;Yt(f|0,48,0)}}t=o[s>>2]|0;if((t|0)<(n|0))do{r[(o[e>>2]|0)+t>>0]=0;t=t+1|0}while((t|0)!=(n|0));o[s>>2]=n;c=i;return}function Ui(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0;i=c;c=c+16|0;s=i;o[s>>2]=e;n=t+12|0;r=e+1|0;a=t+16|0;if((o[a>>2]|0)<(r|0)){u=t+20|0;l=o[u>>2]|0;if((l|0)<(r|0)){f=e+2-l&-2;h=(l>>1)+2&-2;h=(f|0)>(h|0)?f:h;if((h|0)>(2147483647-l|0)){f=St(1)|0;Yt(f|0,48,0)}d=o[n>>2]|0;f=h+l|0;o[u>>2]=f;f=Ur(d,f<<2)|0;o[n>>2]=f;if((f|0)==0?(o[(Wt()|0)>>2]|0)==12:0){d=St(1)|0;Yt(d|0,48,0)}}l=o[a>>2]|0;if((r|0)>(l|0))on((o[n>>2]|0)+(l<<2)|0,-1,r-l<<2|0)|0;o[a>>2]=r}o[(o[n>>2]|0)+(e<<2)>>2]=o[t+4>>2];ai(t,s);r=o[n>>2]|0;l=o[r+(e<<2)>>2]|0;e=o[t>>2]|0;n=o[e+(l<<2)>>2]|0;if(!l){f=0;d=e+(f<<2)|0;o[d>>2]=n;d=r+(n<<2)|0;o[d>>2]=f;c=i;return}t=t+28|0;s=n<<1;a=s|1;while(1){f=l;l=l+-1>>1;h=e+(l<<2)|0;u=o[h>>2]|0;_=o[o[t>>2]>>2]|0;m=o[_+(s<<2)>>2]|0;g=o[_+(a<<2)>>2]|0;m=_n(g|0,((g|0)<0)<<31>>31|0,m|0,((m|0)<0)<<31>>31|0)|0;g=N;p=u<<1;d=o[_+(p<<2)>>2]|0;p=o[_+((p|1)<<2)>>2]|0;d=_n(p|0,((p|0)<0)<<31>>31|0,d|0,((d|0)<0)<<31>>31|0)|0;p=N;if(!(g>>>0<p>>>0|(g|0)==(p|0)&m>>>0<d>>>0)){t=14;break}o[e+(f<<2)>>2]=u;o[r+(o[h>>2]<<2)>>2]=f;if(!l){f=0;t=14;break}}if((t|0)==14){_=e+(f<<2)|0;o[_>>2]=n;_=r+(n<<2)|0;o[_>>2]=f;c=i;return}}function Ki(t,e){t=t|0;e=e|0;var i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0;i=c;a=t+824|0;h=(o[t+840>>2]|0)>(e|0);if(h?(o[(o[t+836>>2]|0)+(e<<2)>>2]|0)>-1:0)l=7;else l=3;do{if((l|0)==3){if(r[(o[t+876>>2]|0)+e>>0]|0){c=i;return}if(r[(o[t+904>>2]|0)+e>>0]|0){c=i;return}m=r[(o[t+332>>2]|0)+e>>0]|0;d=r[2624]|0;p=d&255;if((p>>>1^1)&m<<24>>24==d<<24>>24|m&2&p)if(h){l=7;break}else break;else{c=i;return}}}while(0);if((l|0)==7?(n=o[t+836>>2]|0,s=n+(e<<2)|0,u=o[s>>2]|0,(u|0)>-1):0){e=o[a>>2]|0;l=o[e+(u<<2)>>2]|0;t:do{if(!u)m=0;else{h=t+852|0;f=l<<1;t=f|1;while(1){m=u;u=u+-1>>1;p=e+(u<<2)|0;d=o[p>>2]|0;y=o[o[h>>2]>>2]|0;_=o[y+(f<<2)>>2]|0;b=o[y+(t<<2)>>2]|0;_=_n(b|0,((b|0)<0)<<31>>31|0,_|0,((_|0)<0)<<31>>31|0)|0;b=N;v=d<<1;g=o[y+(v<<2)>>2]|0;v=o[y+((v|1)<<2)>>2]|0;g=_n(v|0,((v|0)<0)<<31>>31|0,g|0,((g|0)<0)<<31>>31|0)|0;v=N;if(!(b>>>0<v>>>0|(b|0)==(v|0)&_>>>0<g>>>0))break t;o[e+(m<<2)>>2]=d;o[n+(o[p>>2]<<2)>>2]=m;if(!u){m=0;break}}}}while(0);o[e+(m<<2)>>2]=l;o[n+(l<<2)>>2]=m;Hi(a,o[s>>2]|0);c=i;return}Ui(a,e);c=i;return}function Hi(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0;i=c;r=o[t>>2]|0;n=o[r+(e<<2)>>2]|0;f=e<<1|1;h=t+4|0;m=o[h>>2]|0;if((f|0)>=(m|0)){p=e;g=t+12|0;m=r+(p<<2)|0;o[m>>2]=n;g=o[g>>2]|0;g=g+(n<<2)|0;o[g>>2]=p;c=i;return}a=t+28|0;u=n<<1;l=u|1;t=t+12|0;while(1){d=(e<<1)+2|0;if((d|0)<(m|0)){p=o[r+(d<<2)>>2]|0;g=o[r+(f<<2)>>2]|0;y=p<<1;m=o[o[a>>2]>>2]|0;v=o[m+(y<<2)>>2]|0;y=o[m+((y|1)<<2)>>2]|0;v=_n(y|0,((y|0)<0)<<31>>31|0,v|0,((v|0)<0)<<31>>31|0)|0;y=N;b=g<<1;_=o[m+(b<<2)>>2]|0;b=o[m+((b|1)<<2)>>2]|0;_=_n(b|0,((b|0)<0)<<31>>31|0,_|0,((_|0)<0)<<31>>31|0)|0;b=N;if(!(y>>>0<b>>>0|(y|0)==(b|0)&v>>>0<_>>>0)){p=g;s=7}}else{p=o[r+(f<<2)>>2]|0;m=o[o[a>>2]>>2]|0;s=7}if((s|0)==7){s=0;d=f}_=p<<1;b=o[m+(_<<2)>>2]|0;_=o[m+((_|1)<<2)>>2]|0;b=_n(_|0,((_|0)<0)<<31>>31|0,b|0,((b|0)<0)<<31>>31|0)|0;_=N;y=o[m+(u<<2)>>2]|0;v=o[m+(l<<2)>>2]|0;y=_n(v|0,((v|0)<0)<<31>>31|0,y|0,((y|0)<0)<<31>>31|0)|0;v=N;if(!(_>>>0<v>>>0|(_|0)==(v|0)&b>>>0<y>>>0)){s=10;break}o[r+(e<<2)>>2]=p;o[(o[t>>2]|0)+(p<<2)>>2]=e;f=d<<1|1;m=o[h>>2]|0;if((f|0)>=(m|0)){e=d;s=10;break}else e=d}if((s|0)==10){y=r+(e<<2)|0;o[y>>2]=n;y=o[t>>2]|0;y=y+(n<<2)|0;o[y>>2]=e;c=i;return}}function Wi(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0;i=c;a=o[t>>2]|0;if(a){r=t+4|0;n=o[r>>2]|0;t:do{if((n|0)>0){s=0;while(1){l=a+(s*12|0)|0;u=o[l>>2]|0;if(u){o[a+(s*12|0)+4>>2]=0;Br(u);o[l>>2]=0;o[a+(s*12|0)+8>>2]=0;n=o[r>>2]|0}s=s+1|0;if((s|0)>=(n|0))break t;a=o[t>>2]|0}}}while(0);o[r>>2]=0;if(e){Br(o[t>>2]|0);o[t>>2]=0;o[t+8>>2]=0}}r=t+16|0;n=o[r>>2]|0;if((n|0)!=0?(o[t+20>>2]=0,e):0){Br(n);o[r>>2]=0;o[t+24>>2]=0}n=t+32|0;r=o[n>>2]|0;if(!r){c=i;return}o[t+36>>2]=0;if(!e){c=i;return}Br(r);o[n>>2]=0;o[t+40>>2]=0;c=i;return}function zi(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0;r=c;n=o[t>>2]|0;i=t+4|0;if(n){o[i>>2]=0;if(e){Br(n);o[t>>2]=0;o[t+8>>2]=0;n=0}}else n=0;if((o[i>>2]|0)>=1){a=t+16|0;o[a>>2]=0;a=t+12|0;o[a>>2]=0;c=r;return}a=t+8|0;s=o[a>>2]|0;if((s|0)<1){l=2-s&-2;e=(s>>1)+2&-2;e=(l|0)>(e|0)?l:e;if((e|0)>(2147483647-s|0)){l=St(1)|0;Yt(l|0,48,0)}l=e+s|0;o[a>>2]=l;n=Ur(n,l<<2)|0;o[t>>2]=n;if((n|0)==0?(o[(Wt()|0)>>2]|0)==12:0){l=St(1)|0;Yt(l|0,48,0)}}e=o[i>>2]|0;if((e|0)<1)while(1){s=n+(e<<2)|0;if(s)o[s>>2]=0;if(!e)break;else e=e+1|0}o[i>>2]=1;l=t+16|0;o[l>>2]=0;l=t+12|0;o[l>>2]=0;c=r;return}function qi(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0;r=c;c=c+16|0;i=r;n=t+16|0;l=o[n>>2]|0;o[n>>2]=l+1;o[(o[t>>2]|0)+(l<<2)>>2]=e;l=o[n>>2]|0;e=t+4|0;a=o[e>>2]|0;if((l|0)==(a|0)){o[n>>2]=0;l=0}s=t+12|0;if((o[s>>2]|0)!=(l|0)){c=r;return}Fi(i,(a*3|0)+1>>1);h=o[s>>2]|0;f=o[e>>2]|0;if((h|0)<(f|0)){l=o[t>>2]|0;u=o[i>>2]|0;f=0;while(1){a=f+1|0;o[u+(f<<2)>>2]=o[l+(h<<2)>>2];h=h+1|0;f=o[e>>2]|0;if((h|0)>=(f|0)){u=a;break}else f=a}}else u=0;a=o[t>>2]|0;if((o[n>>2]|0)>0){l=o[i>>2]|0;h=0;while(1){o[l+(u<<2)>>2]=o[a+(h<<2)>>2];h=h+1|0;if((h|0)>=(o[n>>2]|0))break;else u=u+1|0}f=o[e>>2]|0}o[s>>2]=0;o[n>>2]=f;if(!a)n=t+8|0;else{o[e>>2]=0;Br(a);o[t>>2]=0;n=t+8|0;o[n>>2]=0}o[t>>2]=o[i>>2];h=i+4|0;o[e>>2]=o[h>>2];f=i+8|0;o[n>>2]=o[f>>2];o[i>>2]=0;o[h>>2]=0;o[f>>2]=0;c=r;return}function ji(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0;i=c;r=t+4|0;n=o[r>>2]|0;s=t+8|0;a=o[s>>2]|0;if((n|0)==(a|0)&(a|0)<(n+1|0)){a=(n>>1)+2&-2;a=(a|0)<2?2:a;if((a|0)>(2147483647-n|0)){a=St(1)|0;Yt(a|0,48,0)}l=o[t>>2]|0;n=a+n|0;o[s>>2]=n;n=Ur(l,n<<2)|0;o[t>>2]=n;if((n|0)==0?(o[(Wt()|0)>>2]|0)==12:0){l=St(1)|0;Yt(l|0,48,0)}}else n=o[t>>2]|0;l=o[r>>2]|0;o[r>>2]=l+1;r=n+(l<<2)|0;if(!r){c=i;return}o[r>>2]=o[e>>2];c=i;return}function Xi(){var t=0,e=0;e=c;Bt(3864)|0;t=lr(936)|0;_i(t);c=e;return t|0}function Yi(t){t=t|0;var e=0;e=c;if(!t){c=e;return}Hn[o[(o[t>>2]|0)+4>>2]&31](t);c=e;return}function $i(){var t=0,e=0,i=0;t=c;c=c+16|0;e=t;i=lr(936)|0;_i(i);o[964]=i;Ei(i,1)|0;i=o[964]|0;r[e+0>>0]=r[3840]|0;yi(i,e,1)|0;c=t;return}function Gi(t){t=t|0;var e=0,i=0,n=0;e=c;c=c+16|0;i=e;if((o[962]|0)>=(t|0)){c=e;return}do{n=o[964]|0;r[i+0>>0]=r[3840]|0;yi(n,i,1)|0;n=(o[962]|0)+1|0;o[962]=n}while((n|0)<(t|0));c=e;return}function Zi(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0;s=c;c=c+32|0;a=s+16|0;i=s+4|0;l=s;o[i>>2]=0;n=i+4|0;o[n>>2]=0;e=i+8|0;o[e>>2]=0;u=o[t>>2]|0;if(u)do{h=(u|0)<0?0-u|0:u;if((o[962]|0)<(h|0))do{f=o[964]|0;r[a+0>>0]=r[3840]|0;yi(f,a,1)|0;f=(o[962]|0)+1|0;o[962]=f}while((f|0)<(h|0));o[l>>2]=h<<1|u>>>31;si(i,l);t=t+4|0;u=o[t>>2]|0}while((u|0)!=0);l=o[964]|0;a=l+628|0;or(i,a);a=ki(l,a)|0;l=o[i>>2]|0;if(!l){c=s;return a|0}o[n>>2]=0;Br(l);o[i>>2]=0;o[e>>2]=0;c=s;return a|0}function Ji(){var t=0,e=0,i=0,n=0;e=c;c=c+16|0;t=e;i=o[964]|0;n=i+664|0;o[n+0>>2]=-1;o[n+4>>2]=-1;o[n+8>>2]=-1;o[n+12>>2]=-1;if(o[i+304>>2]|0)o[i+308>>2]=0;wi(t,i,1,0);c=e;return(r[t>>0]|0)==0|0}function Qi(){return(o[(o[964]|0)+4>>2]|0)+1|0}function tr(){return o[962]|0}function er(t){t=t|0;var e=0,i=0,n=0,s=0,a=0,l=0;e=c;c=c+32|0;a=e+16|0;n=e+4|0;l=e;o[n>>2]=0;i=n+4|0;o[i>>2]=0;s=n+8|0;o[s>>2]=0;o[l>>2]=t<<1;si(n,l);t=o[964]|0;l=t+664|0;o[l+0>>2]=-1;o[l+4>>2]=-1;o[l+8>>2]=-1;o[l+12>>2]=-1;or(n,t+304|0);wi(a,t,1,0);t=(r[a>>0]|0)==0;a=o[n>>2]|0;if(!a){c=e;return t|0}o[i>>2]=0;Br(a);o[n>>2]=0;o[s>>2]=0;c=e;return t|0}function ir(t){t=t|0;var e=0,i=0,r=0;e=c;c=c+16|0;r=e;i=o[964]|0;o[r>>2]=t<<1|1;t=i+628|0;if(o[t>>2]|0)o[i+632>>2]=0;si(t,r);ki(i,t)|0;c=e;return}function rr(){return o[(o[964]|0)+36>>2]|0}function nr(){return o[(o[964]|0)+32>>2]|0}function or(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0;i=c;a=o[e>>2]|0;r=e+4|0;if(!a)l=o[r>>2]|0;else{o[r>>2]=0;l=0}r=t+4|0;n=o[r>>2]|0;s=e+4|0;if((l|0)<(n|0)){u=e+8|0;l=o[u>>2]|0;if((l|0)<(n|0)){f=n+1-l&-2;h=(l>>1)+2&-2;h=(f|0)>(h|0)?f:h;if((h|0)>(2147483647-l|0)){f=St(1)|0;Yt(f|0,48,0)}f=h+l|0;o[u>>2]=f;a=Ur(a,f<<2)|0;o[e>>2]=a;if((a|0)==0?(o[(Wt()|0)>>2]|0)==12:0){f=St(1)|0;Yt(f|0,48,0)}}l=o[s>>2]|0;t:do{if((l|0)<(n|0))while(1){a=a+(l<<2)|0;if(a)o[a>>2]=0;l=l+1|0;if((l|0)==(n|0))break t;a=o[e>>2]|0}}while(0);o[s>>2]=n;n=o[r>>2]|0}if((n|0)<=0){c=i;return}e=o[e>>2]|0;t=o[t>>2]|0;n=0;do{o[e+(n<<2)>>2]=o[t+(n<<2)>>2];n=n+1|0}while((n|0)<(o[r>>2]|0));c=i;return}function sr(t,e){t=t|0;e=e|0;var i=0;i=c;c=c+16|0;o[i>>2]=e;e=o[v>>2]|0;kt(e|0,t|0,i|0)|0;Xt(10,e|0)|0;Zt()}function ar(){var t=0,e=0;t=c;c=c+16|0;if(!(Vt(4064,3)|0)){e=Ft(o[1014]|0)|0;c=t;return e|0}else sr(4072,t);return 0}function lr(t){t=t|0;var e=0,i=0;e=c;t=(t|0)==0?1:t;i=Vr(t)|0;if(i){c=e;return i|0}while(1){i=pr()|0;if(!i){t=4;break}qn[i&3]();i=Vr(t)|0;if(i){t=5;break}}if((t|0)==4){i=St(4)|0;o[i>>2]=4248;Yt(i|0,4296,12)}else if((t|0)==5){c=e;return i|0}return 0}function ur(t){t=t|0;var e=0;e=c;Br(t);c=e;return}function hr(t){t=t|0;var e=0;e=c;ur(t);c=e;return}function cr(t){t=t|0;return}function fr(t){t=t|0;return 4264}function dr(t){t=t|0;var e=0;e=c;c=c+16|0;qn[t&3]();sr(4312,e)}function mr(){var t=0,e=0;e=ar()|0;if(((e|0)!=0?(t=o[e>>2]|0,(t|0)!=0):0)?(e=t+48|0,(o[e>>2]&-256|0)==1126902528?(o[e+4>>2]|0)==1129074247:0):0)dr(o[t+12>>2]|0);e=o[968]|0;o[968]=e+0;dr(e)}function pr(){var t=0;t=o[1102]|0;o[1102]=t+0;return t|0}function gr(t){t=t|0;return}function _r(t){t=t|0;return}function vr(t){t=t|0;return}function br(t){t=t|0;return}function yr(t){t=t|0;return}function wr(t){t=t|0;var e=0;e=c;ur(t);c=e;return}function Er(t){t=t|0;var e=0;e=c;ur(t);c=e;return}function kr(t,e,i){t=t|0;e=e|0;i=i|0;var r=0,n=0,s=0,a=0;r=c;c=c+64|0;n=r;if((t|0)==(e|0)){a=1;c=r;return a|0}if(!e){a=0;c=r;return a|0}e=Tr(e,4504,4560,0)|0;if(!e){a=0;c=r;return a|0}a=n+0|0;s=a+56|0;do{o[a>>2]=0;a=a+4|0}while((a|0)<(s|0));o[n>>2]=e;o[n+8>>2]=t;o[n+12>>2]=-1;o[n+48>>2]=1;Yn[o[(o[e>>2]|0)+28>>2]&3](e,n,o[i>>2]|0,1);if((o[n+24>>2]|0)!=1){a=0;c=r;return a|0}o[i>>2]=o[n+16>>2];a=1;c=r;return a|0}function Sr(t,e,i,n){t=t|0;e=e|0;i=i|0;n=n|0;var s=0,a=0;t=c;s=e+16|0;a=o[s>>2]|0;if(!a){o[s>>2]=i;o[e+24>>2]=n;o[e+36>>2]=1;c=t;return}if((a|0)!=(i|0)){a=e+36|0;o[a>>2]=(o[a>>2]|0)+1;o[e+24>>2]=2;r[e+54>>0]=1;c=t;return}i=e+24|0;if((o[i>>2]|0)!=2){c=t;return}o[i>>2]=n;c=t;return}function Mr(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;var n=0;n=c;if((o[e+8>>2]|0)!=(t|0)){c=n;return}Sr(0,e,i,r);c=n;return}function Ar(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;var n=0;n=c;if((t|0)==(o[e+8>>2]|0)){Sr(0,e,i,r);c=n;return}else{t=o[t+8>>2]|0;Yn[o[(o[t>>2]|0)+28>>2]&3](t,e,i,r);c=n;return}}function Tr(t,e,i,s){t=t|0;e=e|0;i=i|0;s=s|0;var a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0;a=c;c=c+64|0;l=a;u=o[t>>2]|0;h=t+(o[u+-8>>2]|0)|0;u=o[u+-4>>2]|0;o[l>>2]=i;o[l+4>>2]=t;o[l+8>>2]=e;o[l+12>>2]=s;d=l+16|0;m=l+20|0;e=l+24|0;f=l+28|0;s=l+32|0;t=l+40|0;p=(u|0)==(i|0);g=d+0|0;i=g+36|0;do{o[g>>2]=0;g=g+4|0}while((g|0)<(i|0));n[d+36>>1]=0;r[d+38>>0]=0;if(p){o[l+48>>2]=1;jn[o[(o[u>>2]|0)+20>>2]&3](u,l,h,h,1,0);g=(o[e>>2]|0)==1?h:0;c=a;return g|0}Kn[o[(o[u>>2]|0)+24>>2]&3](u,l,h,1,0);l=o[l+36>>2]|0;if(!l){g=(o[t>>2]|0)==1&(o[f>>2]|0)==1&(o[s>>2]|0)==1?o[m>>2]|0:0;c=a;return g|0}else if((l|0)==1){if((o[e>>2]|0)!=1?!((o[t>>2]|0)==0&(o[f>>2]|0)==1&(o[s>>2]|0)==1):0){g=0;c=a;return g|0}g=o[d>>2]|0;c=a;return g|0}else{g=0;c=a;return g|0}return 0}function Cr(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var a=0;t=c;r[e+53>>0]=1;if((o[e+4>>2]|0)!=(n|0)){c=t;return}r[e+52>>0]=1;n=e+16|0;a=o[n>>2]|0;if(!a){o[n>>2]=i;o[e+24>>2]=s;o[e+36>>2]=1;if(!((s|0)==1?(o[e+48>>2]|0)==1:0)){c=t;return}r[e+54>>0]=1;c=t;return}if((a|0)!=(i|0)){a=e+36|0;o[a>>2]=(o[a>>2]|0)+1;r[e+54>>0]=1;c=t;return}i=e+24|0;n=o[i>>2]|0;if((n|0)==2)o[i>>2]=s;else s=n;if(!((s|0)==1?(o[e+48>>2]|0)==1:0)){c=t;return}r[e+54>>0]=1;c=t;return}function xr(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var a=0,l=0,u=0,h=0,f=0;a=c;if((t|0)==(o[e+8>>2]|0)){if((o[e+4>>2]|0)!=(i|0)){c=a;return}l=e+28|0;if((o[l>>2]|0)==1){c=a;return}o[l>>2]=n;c=a;return}if((t|0)!=(o[e>>2]|0)){h=o[t+8>>2]|0;Kn[o[(o[h>>2]|0)+24>>2]&3](h,e,i,n,s);c=a;return}if((o[e+16>>2]|0)!=(i|0)?(u=e+20|0,(o[u>>2]|0)!=(i|0)):0){o[e+32>>2]=n;n=e+44|0;if((o[n>>2]|0)==4){c=a;return}h=e+52|0;r[h>>0]=0;f=e+53|0;r[f>>0]=0;t=o[t+8>>2]|0;jn[o[(o[t>>2]|0)+20>>2]&3](t,e,i,i,1,s);if(r[f>>0]|0){if(!(r[h>>0]|0)){t=1;l=13}}else{t=0;l=13}do{if((l|0)==13){o[u>>2]=i;f=e+40|0;o[f>>2]=(o[f>>2]|0)+1;if((o[e+36>>2]|0)==1?(o[e+24>>2]|0)==2:0){r[e+54>>0]=1;if(t)break}else l=16;if((l|0)==16?t:0)break;o[n>>2]=4;c=a;return}}while(0);o[n>>2]=3;c=a;return}if((n|0)!=1){c=a;return}o[e+32>>2]=1;c=a;return}function Rr(t,e,i,n,s){t=t|0;e=e|0;i=i|0;n=n|0;s=s|0;var a=0;s=c;if((o[e+8>>2]|0)==(t|0)){if((o[e+4>>2]|0)!=(i|0)){c=s;return}e=e+28|0;if((o[e>>2]|0)==1){c=s;return}o[e>>2]=n;c=s;return}if((o[e>>2]|0)!=(t|0)){c=s;return}if((o[e+16>>2]|0)!=(i|0)?(a=e+20|0,(o[a>>2]|0)!=(i|0)):0){o[e+32>>2]=n;o[a>>2]=i;t=e+40|0;o[t>>2]=(o[t>>2]|0)+1;if((o[e+36>>2]|0)==1?(o[e+24>>2]|0)==2:0)r[e+54>>0]=1;o[e+44>>2]=4;c=s;return}if((n|0)!=1){c=s;return}o[e+32>>2]=1;c=s;return}function Or(t,e,i,r,n,s){t=t|0;e=e|0;i=i|0;r=r|0;n=n|0;s=s|0;var a=0;a=c;if((t|0)==(o[e+8>>2]|0)){Cr(0,e,i,r,n);c=a;return}else{t=o[t+8>>2]|0;jn[o[(o[t>>2]|0)+20>>2]&3](t,e,i,r,n,s);c=a;return}}function Lr(t,e,i,r,n,s){t=t|0;e=e|0;i=i|0;r=r|0;n=n|0;s=s|0;s=c;if((o[e+8>>2]|0)!=(t|0)){c=s;return}Cr(0,e,i,r,n);c=s;return}function Pr(t,e,i){t=t|0;e=e|0;i=i|0;var r=0,n=0;r=c;c=c+16|0;n=r;o[n>>2]=o[i>>2];t=Un[o[(o[t>>2]|0)+16>>2]&1](t,e,n)|0;e=t&1;if(!t){c=r;return e|0}o[i>>2]=o[n>>2];c=r;return e|0}function Nr(t){t=t|0;var e=0;e=c;if(!t)t=0;else t=(Tr(t,4504,4672,0)|0)!=0;c=e;return t&1|0}function Ir(){var t=0,e=0,i=0,r=0,n=0;t=c;c=c+16|0;e=t;t=t+12|0;i=ar()|0;if(!i)sr(4040,e);i=o[i>>2]|0;if(!i)sr(4040,e);n=i+48|0;r=o[n>>2]|0;n=o[n+4>>2]|0;if(!((r&-256|0)==1126902528&(n|0)==1129074247)){o[e>>2]=o[970];sr(4e3,e)}if((r|0)==1126902529&(n|0)==1129074247)r=o[i+44>>2]|0;else r=i+80|0;o[t>>2]=r;n=o[i>>2]|0;i=o[n+4>>2]|0;if(Un[o[(o[4432>>2]|0)+16>>2]&1](4432,n,t)|0){n=o[t>>2]|0;r=o[970]|0;n=zn[o[(o[n>>2]|0)+8>>2]&1](n)|0;o[e>>2]=r;o[e+4>>2]=i;o[e+8>>2]=n;sr(3904,e)}else{o[e>>2]=o[970];o[e+4>>2]=i;sr(3952,e)}}function Fr(){var t=0;t=c;c=c+16|0;if(!(Kt(4056,20)|0)){c=t;return}else sr(4128,t)}function Dr(t){t=t|0;var e=0;e=c;c=c+16|0;Br(t);if(!(zt(o[1014]|0,0)|0)){c=e;return}else sr(4184,e)}function Vr(t){t=t|0;var e=0,i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0,k=0,S=0,M=0,A=0,T=0,C=0,x=0,R=0,O=0,L=0,P=0;e=c;do{if(t>>>0<245){if(t>>>0<11)t=16;else t=t+11&-8;k=t>>>3;p=o[1206]|0;E=p>>>k;if(E&3){s=(E&1^1)+k|0;n=s<<1;i=4864+(n<<2)|0;n=4864+(n+2<<2)|0;a=o[n>>2]|0;l=a+8|0;r=o[l>>2]|0;do{if((i|0)!=(r|0)){if(r>>>0<(o[1210]|0)>>>0)Zt();u=r+12|0;if((o[u>>2]|0)==(a|0)){o[u>>2]=i;o[n>>2]=r;break}else Zt()}else o[1206]=p&~(1<<s)}while(0);P=s<<3;o[a+4>>2]=P|3;P=a+(P|4)|0;o[P>>2]=o[P>>2]|1;P=l;c=e;return P|0}w=o[1208]|0;if(t>>>0>w>>>0){if(E){a=2<<k;a=E<<k&(a|0-a);a=(a&0-a)+-1|0;i=a>>>12&16;a=a>>>i;l=a>>>5&8;a=a>>>l;n=a>>>2&4;a=a>>>n;s=a>>>1&2;a=a>>>s;r=a>>>1&1;r=(l|i|n|s|r)+(a>>>r)|0;a=r<<1;s=4864+(a<<2)|0;a=4864+(a+2<<2)|0;n=o[a>>2]|0;i=n+8|0;l=o[i>>2]|0;do{if((s|0)!=(l|0)){if(l>>>0<(o[1210]|0)>>>0)Zt();u=l+12|0;if((o[u>>2]|0)==(n|0)){o[u>>2]=s;o[a>>2]=l;R=o[1208]|0;break}else Zt()}else{o[1206]=p&~(1<<r);R=w}}while(0);P=r<<3;r=P-t|0;o[n+4>>2]=t|3;s=n+t|0;o[n+(t|4)>>2]=r|1;o[n+P>>2]=r;if(R){n=o[1211]|0;h=R>>>3;l=h<<1;a=4864+(l<<2)|0;u=o[1206]|0;h=1<<h;if(u&h){l=4864+(l+2<<2)|0;u=o[l>>2]|0;if(u>>>0<(o[1210]|0)>>>0)Zt();else{x=l;C=u}}else{o[1206]=u|h;x=4864+(l+2<<2)|0;C=a}o[x>>2]=n;o[C+12>>2]=n;o[n+8>>2]=C;o[n+12>>2]=a}o[1208]=r;o[1211]=s;P=i;c=e;return P|0}p=o[1207]|0;if(p){i=(p&0-p)+-1|0;L=i>>>12&16;i=i>>>L;O=i>>>5&8;i=i>>>O;P=i>>>2&4;i=i>>>P;n=i>>>1&2;i=i>>>n;r=i>>>1&1;r=o[5128+((O|L|P|n|r)+(i>>>r)<<2)>>2]|0;i=(o[r+4>>2]&-8)-t|0;n=r;while(1){s=o[n+16>>2]|0;if(!s){s=o[n+20>>2]|0;if(!s)break}n=(o[s+4>>2]&-8)-t|0;P=n>>>0<i>>>0;i=P?n:i;n=s;r=P?s:r}a=o[1210]|0;if(r>>>0<a>>>0)Zt();n=r+t|0;if(r>>>0>=n>>>0)Zt();s=o[r+24>>2]|0;u=o[r+12>>2]|0;do{if((u|0)==(r|0)){u=r+20|0;l=o[u>>2]|0;if(!l){u=r+16|0;l=o[u>>2]|0;if(!l){T=0;break}}while(1){h=l+20|0;f=o[h>>2]|0;if(f){l=f;u=h;continue}h=l+16|0;f=o[h>>2]|0;if(!f)break;else{l=f;u=h}}if(u>>>0<a>>>0)Zt();else{o[u>>2]=0;T=l;break}}else{l=o[r+8>>2]|0;if(l>>>0<a>>>0)Zt();a=l+12|0;if((o[a>>2]|0)!=(r|0))Zt();h=u+8|0;if((o[h>>2]|0)==(r|0)){o[a>>2]=u;o[h>>2]=l;T=u;break}else Zt()}}while(0);do{if(s){l=o[r+28>>2]|0;a=5128+(l<<2)|0;if((r|0)==(o[a>>2]|0)){o[a>>2]=T;if(!T){o[1207]=o[1207]&~(1<<l);break}}else{if(s>>>0<(o[1210]|0)>>>0)Zt();a=s+16|0;if((o[a>>2]|0)==(r|0))o[a>>2]=T;else o[s+20>>2]=T;if(!T)break}a=o[1210]|0;if(T>>>0<a>>>0)Zt();o[T+24>>2]=s;s=o[r+16>>2]|0;do{if(s)if(s>>>0<a>>>0)Zt();else{o[T+16>>2]=s;o[s+24>>2]=T;break}}while(0);s=o[r+20>>2]|0;if(s)if(s>>>0<(o[1210]|0)>>>0)Zt();else{o[T+20>>2]=s;o[s+24>>2]=T;break}}}while(0);if(i>>>0<16){P=i+t|0;o[r+4>>2]=P|3;P=r+(P+4)|0;o[P>>2]=o[P>>2]|1}else{o[r+4>>2]=t|3;o[r+(t|4)>>2]=i|1;o[r+(i+t)>>2]=i;a=o[1208]|0;if(a){s=o[1211]|0;u=a>>>3;h=u<<1;a=4864+(h<<2)|0;l=o[1206]|0;u=1<<u;if(l&u){l=4864+(h+2<<2)|0;u=o[l>>2]|0;if(u>>>0<(o[1210]|0)>>>0)Zt();else{A=l;M=u}}else{o[1206]=l|u;A=4864+(h+2<<2)|0;M=a}o[A>>2]=s;o[M+12>>2]=s;o[s+8>>2]=M;o[s+12>>2]=a}o[1208]=i;o[1211]=n}P=r+8|0;c=e;return P|0}}}else if(t>>>0<=4294967231){M=t+11|0;t=M&-8;T=o[1207]|0;if(T){A=0-t|0;M=M>>>8;if(M)if(t>>>0>16777215)C=31;else{L=(M+1048320|0)>>>16&8;P=M<<L;O=(P+520192|0)>>>16&4;P=P<<O;C=(P+245760|0)>>>16&2;C=14-(O|L|C)+(P<<C>>>15)|0;C=t>>>(C+7|0)&1|C<<1}else C=0;x=o[5128+(C<<2)>>2]|0;t:do{if(!x){O=0;M=0}else{if((C|0)==31)M=0;else M=25-(C>>>1)|0;O=0;R=t<<M;M=0;while(1){L=o[x+4>>2]&-8;P=L-t|0;if(P>>>0<A>>>0)if((L|0)==(t|0)){A=P;O=x;M=x;break t}else{A=P;M=x}P=o[x+20>>2]|0;x=o[x+(R>>>31<<2)+16>>2]|0;O=(P|0)==0|(P|0)==(x|0)?O:P;if(!x)break;else R=R<<1}}}while(0);if((O|0)==0&(M|0)==0){P=2<<C;T=T&(P|0-P);if(!T)break;P=(T&0-T)+-1|0;x=P>>>12&16;P=P>>>x;C=P>>>5&8;P=P>>>C;R=P>>>2&4;P=P>>>R;L=P>>>1&2;P=P>>>L;O=P>>>1&1;O=o[5128+((C|x|R|L|O)+(P>>>O)<<2)>>2]|0}if(O)while(1){P=(o[O+4>>2]&-8)-t|0;T=P>>>0<A>>>0;A=T?P:A;M=T?O:M;T=o[O+16>>2]|0;if(T){O=T;continue}O=o[O+20>>2]|0;if(!O)break}if((M|0)!=0?A>>>0<((o[1208]|0)-t|0)>>>0:0){n=o[1210]|0;if(M>>>0<n>>>0)Zt();i=M+t|0;if(M>>>0>=i>>>0)Zt();r=o[M+24>>2]|0;s=o[M+12>>2]|0;do{if((s|0)==(M|0)){a=M+20|0;s=o[a>>2]|0;if(!s){a=M+16|0;s=o[a>>2]|0;if(!s){k=0;break}}while(1){l=s+20|0;u=o[l>>2]|0;if(u){s=u;a=l;continue}l=s+16|0;u=o[l>>2]|0;if(!u)break;else{s=u;a=l}}if(a>>>0<n>>>0)Zt();else{o[a>>2]=0;k=s;break}}else{a=o[M+8>>2]|0;if(a>>>0<n>>>0)Zt();l=a+12|0;if((o[l>>2]|0)!=(M|0))Zt();n=s+8|0;if((o[n>>2]|0)==(M|0)){o[l>>2]=s;o[n>>2]=a;k=s;break}else Zt()}}while(0);do{if(r){n=o[M+28>>2]|0;s=5128+(n<<2)|0;if((M|0)==(o[s>>2]|0)){o[s>>2]=k;if(!k){o[1207]=o[1207]&~(1<<n);break}}else{if(r>>>0<(o[1210]|0)>>>0)Zt();n=r+16|0;if((o[n>>2]|0)==(M|0))o[n>>2]=k;else o[r+20>>2]=k;if(!k)break}n=o[1210]|0;if(k>>>0<n>>>0)Zt();o[k+24>>2]=r;r=o[M+16>>2]|0;do{if(r)if(r>>>0<n>>>0)Zt();else{o[k+16>>2]=r;o[r+24>>2]=k;break}}while(0);r=o[M+20>>2]|0;if(r)if(r>>>0<(o[1210]|0)>>>0)Zt();else{o[k+20>>2]=r;o[r+24>>2]=k;break}}}while(0);t:do{if(A>>>0>=16){o[M+4>>2]=t|3;o[M+(t|4)>>2]=A|1;o[M+(A+t)>>2]=A;n=A>>>3;if(A>>>0<256){a=n<<1;r=4864+(a<<2)|0;s=o[1206]|0;n=1<<n;do{if(!(s&n)){o[1206]=s|n;E=4864+(a+2<<2)|0;w=r}else{n=4864+(a+2<<2)|0;s=o[n>>2]|0;if(s>>>0>=(o[1210]|0)>>>0){E=n;w=s;break}Zt()}}while(0);o[E>>2]=i;o[w+12>>2]=i;o[M+(t+8)>>2]=w;o[M+(t+12)>>2]=r;break}r=A>>>8;if(r)if(A>>>0>16777215)r=31;else{L=(r+1048320|0)>>>16&8;P=r<<L;O=(P+520192|0)>>>16&4;P=P<<O;r=(P+245760|0)>>>16&2;r=14-(O|L|r)+(P<<r>>>15)|0;r=A>>>(r+7|0)&1|r<<1}else r=0;n=5128+(r<<2)|0;o[M+(t+28)>>2]=r;o[M+(t+20)>>2]=0;o[M+(t+16)>>2]=0;s=o[1207]|0;a=1<<r;if(!(s&a)){o[1207]=s|a;o[n>>2]=i;o[M+(t+24)>>2]=n;o[M+(t+12)>>2]=i;o[M+(t+8)>>2]=i;break}a=o[n>>2]|0;if((r|0)==31)r=0;else r=25-(r>>>1)|0;e:do{if((o[a+4>>2]&-8|0)!=(A|0)){r=A<<r;while(1){s=a+(r>>>31<<2)+16|0;n=o[s>>2]|0;if(!n)break;if((o[n+4>>2]&-8|0)==(A|0)){p=n;break e}else{r=r<<1;a=n}}if(s>>>0<(o[1210]|0)>>>0)Zt();else{o[s>>2]=i;o[M+(t+24)>>2]=a;o[M+(t+12)>>2]=i;o[M+(t+8)>>2]=i;break t}}else p=a}while(0);n=p+8|0;r=o[n>>2]|0;P=o[1210]|0;if(p>>>0>=P>>>0&r>>>0>=P>>>0){o[r+12>>2]=i;o[n>>2]=i;o[M+(t+8)>>2]=r;o[M+(t+12)>>2]=p;o[M+(t+24)>>2]=0;break}else Zt()}else{P=A+t|0;o[M+4>>2]=P|3;P=M+(P+4)|0;o[P>>2]=o[P>>2]|1}}while(0);P=M+8|0;c=e;return P|0}}}else t=-1}while(0);p=o[1208]|0;if(p>>>0>=t>>>0){r=p-t|0;i=o[1211]|0;if(r>>>0>15){o[1211]=i+t;o[1208]=r;o[i+(t+4)>>2]=r|1;o[i+p>>2]=r;o[i+4>>2]=t|3}else{o[1208]=0;o[1211]=0;o[i+4>>2]=p|3;P=i+(p+4)|0;o[P>>2]=o[P>>2]|1}P=i+8|0;c=e;return P|0}p=o[1209]|0;if(p>>>0>t>>>0){L=p-t|0;o[1209]=L;P=o[1212]|0;o[1212]=P+t;o[P+(t+4)>>2]=L|1;o[P+4>>2]=t|3;P=P+8|0;c=e;return P|0}do{if(!(o[1324]|0)){p=It(30)|0;if(!(p+-1&p)){o[1326]=p;o[1325]=p;o[1327]=-1;o[1328]=-1;o[1329]=0;o[1317]=0;o[1324]=(Qt(0)|0)&-16^1431655768;break}else Zt()}}while(0);k=t+48|0;p=o[1326]|0;E=t+47|0;A=p+E|0;p=0-p|0;w=A&p;if(w>>>0<=t>>>0){P=0;c=e;return P|0}M=o[1316]|0;if((M|0)!=0?(L=o[1314]|0,P=L+w|0,P>>>0<=L>>>0|P>>>0>M>>>0):0){P=0;c=e;return P|0}t:do{if(!(o[1317]&4)){T=o[1212]|0;e:do{if(T){M=5272|0;while(1){C=o[M>>2]|0;if(C>>>0<=T>>>0?(S=M+4|0,(C+(o[S>>2]|0)|0)>>>0>T>>>0):0)break;M=o[M+8>>2]|0;if(!M){m=181;break e}}if(M){A=A-(o[1209]|0)&p;if(A>>>0<2147483647){p=xt(A|0)|0;if((p|0)==((o[M>>2]|0)+(o[S>>2]|0)|0)){M=A;m=190}else{M=A;m=191}}else M=0}else m=181}else m=181}while(0);do{if((m|0)==181){S=xt(0)|0;if((S|0)!=(-1|0)){A=S;M=o[1325]|0;p=M+-1|0;if(!(p&A))M=w;else M=w-A+(p+A&0-M)|0;p=o[1314]|0;A=p+M|0;if(M>>>0>t>>>0&M>>>0<2147483647){P=o[1316]|0;if((P|0)!=0?A>>>0<=p>>>0|A>>>0>P>>>0:0){M=0;break}p=xt(M|0)|0;if((p|0)==(S|0)){p=S;m=190}else m=191}else M=0}else M=0}}while(0);e:do{if((m|0)==190){if((p|0)!=(-1|0)){g=M;m=201;break t}}else if((m|0)==191){m=0-M|0;do{if((p|0)!=(-1|0)&M>>>0<2147483647&k>>>0>M>>>0?(y=o[1326]|0,y=E-M+y&0-y,y>>>0<2147483647):0)if((xt(y|0)|0)==(-1|0)){xt(m|0)|0;M=0;break e}else{M=y+M|0;break}}while(0);if((p|0)==(-1|0))M=0;else{g=M;m=201;break t}}}while(0);o[1317]=o[1317]|4;m=198}else{M=0;m=198}}while(0);if((((m|0)==198?w>>>0<2147483647:0)?(b=xt(w|0)|0,v=xt(0)|0,(b|0)!=(-1|0)&(v|0)!=(-1|0)&b>>>0<v>>>0):0)?(_=v-b|0,g=_>>>0>(t+40|0)>>>0,g):0){p=b;g=g?_:M;m=201}if((m|0)==201){_=(o[1314]|0)+g|0;o[1314]=_;if(_>>>0>(o[1315]|0)>>>0)o[1315]=_;_=o[1212]|0;t:do{if(_){b=5272|0;while(1){v=o[b>>2]|0;w=b+4|0;E=o[w>>2]|0;if((p|0)==(v+E|0)){m=213;break}y=o[b+8>>2]|0;if(!y)break;else b=y}if(((m|0)==213?(o[b+12>>2]&8|0)==0:0)?_>>>0>=v>>>0&_>>>0<p>>>0:0){o[w>>2]=E+g;i=(o[1209]|0)+g|0;r=_+8|0;if(!(r&7))r=0;else r=0-r&7;P=i-r|0;o[1212]=_+r;o[1209]=P;o[_+(r+4)>>2]=P|1;o[_+(i+4)>>2]=40;o[1213]=o[1328];break}v=o[1210]|0;if(p>>>0<v>>>0){o[1210]=p;v=p}w=p+g|0;b=5272|0;while(1){if((o[b>>2]|0)==(w|0)){m=223;break}y=o[b+8>>2]|0;if(!y)break;else b=y}if((m|0)==223?(o[b+12>>2]&8|0)==0:0){o[b>>2]=p;a=b+4|0;o[a>>2]=(o[a>>2]|0)+g;a=p+8|0;if(!(a&7))a=0;else a=0-a&7;l=p+(g+8)|0;if(!(l&7))d=0;else d=0-l&7;m=p+(d+g)|0;u=a+t|0;l=p+u|0;f=m-(p+a)-t|0;o[p+(a+4)>>2]=t|3;e:do{if((m|0)!=(_|0)){if((m|0)==(o[1211]|0)){P=(o[1208]|0)+f|0;o[1208]=P;o[1211]=l;o[p+(u+4)>>2]=P|1;o[p+(P+u)>>2]=P;break}_=g+4|0;y=o[p+(_+d)>>2]|0;if((y&3|0)==1){t=y&-8;b=y>>>3;i:do{if(y>>>0>=256){h=o[p+((d|24)+g)>>2]|0;b=o[p+(g+12+d)>>2]|0;do{if((b|0)==(m|0)){w=d|16;y=p+(_+w)|0;b=o[y>>2]|0;if(!b){y=p+(w+g)|0;b=o[y>>2]|0;if(!b){s=0;break}}while(1){E=b+20|0;w=o[E>>2]|0;if(w){b=w;y=E;continue}E=b+16|0;w=o[E>>2]|0;if(!w)break;else{b=w;y=E}}if(y>>>0<v>>>0)Zt();else{o[y>>2]=0;s=b;break}}else{y=o[p+((d|8)+g)>>2]|0;if(y>>>0<v>>>0)Zt();w=y+12|0;if((o[w>>2]|0)!=(m|0))Zt();v=b+8|0;if((o[v>>2]|0)==(m|0)){o[w>>2]=b;o[v>>2]=y;s=b;break}else Zt()}}while(0);if(!h)break;v=o[p+(g+28+d)>>2]|0;b=5128+(v<<2)|0;do{if((m|0)!=(o[b>>2]|0)){if(h>>>0<(o[1210]|0)>>>0)Zt();v=h+16|0;if((o[v>>2]|0)==(m|0))o[v>>2]=s;else o[h+20>>2]=s;if(!s)break i}else{o[b>>2]=s;if(s)break;o[1207]=o[1207]&~(1<<v);break i}}while(0);m=o[1210]|0;if(s>>>0<m>>>0)Zt();o[s+24>>2]=h;v=d|16;h=o[p+(v+g)>>2]|0;do{if(h)if(h>>>0<m>>>0)Zt();else{o[s+16>>2]=h;o[h+24>>2]=s;break}}while(0);h=o[p+(_+v)>>2]|0;if(!h)break;if(h>>>0<(o[1210]|0)>>>0)Zt();else{o[s+20>>2]=h;o[h+24>>2]=s;break}}else{s=o[p+((d|8)+g)>>2]|0;_=o[p+(g+12+d)>>2]|0;y=4864+(b<<1<<2)|0;do{if((s|0)!=(y|0)){if(s>>>0<v>>>0)Zt();if((o[s+12>>2]|0)==(m|0))break;Zt()}}while(0);if((_|0)==(s|0)){o[1206]=o[1206]&~(1<<b);break}do{if((_|0)==(y|0))h=_+8|0;else{if(_>>>0<v>>>0)Zt();v=_+8|0;if((o[v>>2]|0)==(m|0)){h=v;break}Zt()}}while(0);o[s+12>>2]=_;o[h>>2]=s}}while(0);m=p+((t|d)+g)|0;f=t+f|0}s=m+4|0;o[s>>2]=o[s>>2]&-2;o[p+(u+4)>>2]=f|1;o[p+(f+u)>>2]=f;s=f>>>3;if(f>>>0<256){h=s<<1;i=4864+(h<<2)|0;f=o[1206]|0;s=1<<s;do{if(!(f&s)){o[1206]=f|s;n=4864+(h+2<<2)|0;r=i}else{h=4864+(h+2<<2)|0;s=o[h>>2]|0;if(s>>>0>=(o[1210]|0)>>>0){n=h;r=s;break}Zt()}}while(0);o[n>>2]=l;o[r+12>>2]=l;o[p+(u+8)>>2]=r;o[p+(u+12)>>2]=i;break}r=f>>>8;do{if(!r)r=0;else{if(f>>>0>16777215){r=31;break}L=(r+1048320|0)>>>16&8;P=r<<L;O=(P+520192|0)>>>16&4;P=P<<O;r=(P+245760|0)>>>16&2;r=14-(O|L|r)+(P<<r>>>15)|0;r=f>>>(r+7|0)&1|r<<1}}while(0);h=5128+(r<<2)|0;o[p+(u+28)>>2]=r;o[p+(u+20)>>2]=0;o[p+(u+16)>>2]=0;s=o[1207]|0;n=1<<r;if(!(s&n)){o[1207]=s|n;o[h>>2]=l;o[p+(u+24)>>2]=h;o[p+(u+12)>>2]=l;o[p+(u+8)>>2]=l;break}n=o[h>>2]|0;if((r|0)==31)r=0;else r=25-(r>>>1)|0;i:do{if((o[n+4>>2]&-8|0)!=(f|0)){r=f<<r;while(1){s=n+(r>>>31<<2)+16|0;h=o[s>>2]|0;if(!h)break;if((o[h+4>>2]&-8|0)==(f|0)){i=h;break i}else{r=r<<1;n=h}}if(s>>>0<(o[1210]|0)>>>0)Zt();else{o[s>>2]=l;o[p+(u+24)>>2]=n;o[p+(u+12)>>2]=l;o[p+(u+8)>>2]=l;break e}}else i=n}while(0);r=i+8|0;n=o[r>>2]|0;P=o[1210]|0;if(i>>>0>=P>>>0&n>>>0>=P>>>0){o[n+12>>2]=l;o[r>>2]=l;o[p+(u+8)>>2]=n;o[p+(u+12)>>2]=i;o[p+(u+24)>>2]=0;break}else Zt()}else{P=(o[1209]|0)+f|0;o[1209]=P;o[1212]=l;o[p+(u+4)>>2]=P|1}}while(0);P=p+(a|8)|0;c=e;return P|0}r=5272|0;while(1){i=o[r>>2]|0;if(i>>>0<=_>>>0?(d=o[r+4>>2]|0,f=i+d|0,f>>>0>_>>>0):0)break;r=o[r+8>>2]|0}r=i+(d+-39)|0;if(!(r&7))r=0;else r=0-r&7;i=i+(d+-47+r)|0;i=i>>>0<(_+16|0)>>>0?_:i;r=i+8|0;n=p+8|0;if(!(n&7))n=0;else n=0-n&7;P=g+-40-n|0;o[1212]=p+n;o[1209]=P;o[p+(n+4)>>2]=P|1;o[p+(g+-36)>>2]=40;o[1213]=o[1328];o[i+4>>2]=27;o[r+0>>2]=o[1318];o[r+4>>2]=o[1319];o[r+8>>2]=o[1320];o[r+12>>2]=o[1321];o[1318]=p;o[1319]=g;o[1321]=0;o[1320]=r;r=i+28|0;o[r>>2]=7;if((i+32|0)>>>0<f>>>0)do{P=r;r=r+4|0;o[r>>2]=7}while((P+8|0)>>>0<f>>>0);if((i|0)!=(_|0)){i=i-_|0;r=_+(i+4)|0;o[r>>2]=o[r>>2]&-2;o[_+4>>2]=i|1;o[_+i>>2]=i;r=i>>>3;if(i>>>0<256){n=r<<1;i=4864+(n<<2)|0;s=o[1206]|0;r=1<<r;do{if(!(s&r)){o[1206]=s|r;u=4864+(n+2<<2)|0;l=i}else{n=4864+(n+2<<2)|0;r=o[n>>2]|0;if(r>>>0>=(o[1210]|0)>>>0){u=n;l=r;break}Zt()}}while(0);o[u>>2]=_;o[l+12>>2]=_;o[_+8>>2]=l;o[_+12>>2]=i;break}r=i>>>8;if(r)if(i>>>0>16777215)r=31;else{L=(r+1048320|0)>>>16&8;P=r<<L;O=(P+520192|0)>>>16&4;P=P<<O;r=(P+245760|0)>>>16&2;r=14-(O|L|r)+(P<<r>>>15)|0;r=i>>>(r+7|0)&1|r<<1}else r=0;l=5128+(r<<2)|0;o[_+28>>2]=r;o[_+20>>2]=0;o[_+16>>2]=0;n=o[1207]|0;s=1<<r;if(!(n&s)){o[1207]=n|s;o[l>>2]=_;o[_+24>>2]=l;o[_+12>>2]=_;o[_+8>>2]=_;break}n=o[l>>2]|0;if((r|0)==31)r=0;else r=25-(r>>>1)|0;e:do{if((o[n+4>>2]&-8|0)!=(i|0)){r=i<<r;l=n;while(1){n=l+(r>>>31<<2)+16|0;s=o[n>>2]|0;if(!s)break;if((o[s+4>>2]&-8|0)==(i|0)){a=s;break e}else{r=r<<1;l=s}}if(n>>>0<(o[1210]|0)>>>0)Zt();else{o[n>>2]=_;o[_+24>>2]=l;o[_+12>>2]=_;o[_+8>>2]=_;break t}}else a=n}while(0);r=a+8|0;i=o[r>>2]|0;P=o[1210]|0;if(a>>>0>=P>>>0&i>>>0>=P>>>0){o[i+12>>2]=_;o[r>>2]=_;o[_+8>>2]=i;o[_+12>>2]=a;o[_+24>>2]=0;break}else Zt()}}else{P=o[1210]|0;if((P|0)==0|p>>>0<P>>>0)o[1210]=p;o[1318]=p;o[1319]=g;o[1321]=0;o[1215]=o[1324];o[1214]=-1;i=0;do{P=i<<1;L=4864+(P<<2)|0;o[4864+(P+3<<2)>>2]=L;o[4864+(P+2<<2)>>2]=L;i=i+1|0}while((i|0)!=32);i=p+8|0;if(!(i&7))i=0;else i=0-i&7;P=g+-40-i|0;o[1212]=p+i;o[1209]=P;o[p+(i+4)>>2]=P|1;o[p+(g+-36)>>2]=40;o[1213]=o[1328]}}while(0);i=o[1209]|0;if(i>>>0>t>>>0){L=i-t|0;o[1209]=L;P=o[1212]|0;o[1212]=P+t;o[P+(t+4)>>2]=L|1;o[P+4>>2]=t|3;P=P+8|0;c=e;return P|0}}o[(Wt()|0)>>2]=12;P=0;c=e;return P|0}function Br(t){t=t|0;var e=0,i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0,E=0;e=c;if(!t){c=e;return}g=t+-8|0;_=o[1210]|0;if(g>>>0<_>>>0)Zt();d=o[t+-4>>2]|0;f=d&3;if((f|0)==1)Zt();l=d&-8;a=t+(l+-8)|0;do{if(!(d&1)){y=o[g>>2]|0;if(!f){c=e;return}g=-8-y|0;d=t+g|0;f=y+l|0;if(d>>>0<_>>>0)Zt();if((d|0)==(o[1211]|0)){r=t+(l+-4)|0;m=o[r>>2]|0;if((m&3|0)!=3){r=d;m=f;break}o[1208]=f;o[r>>2]=m&-2;o[t+(g+4)>>2]=f|1;o[a>>2]=f;c=e;return}b=y>>>3;if(y>>>0<256){r=o[t+(g+8)>>2]|0;m=o[t+(g+12)>>2]|0;p=4864+(b<<1<<2)|0;if((r|0)!=(p|0)){if(r>>>0<_>>>0)Zt();if((o[r+12>>2]|0)!=(d|0))Zt()}if((m|0)==(r|0)){o[1206]=o[1206]&~(1<<b);r=d;m=f;break}if((m|0)!=(p|0)){if(m>>>0<_>>>0)Zt();p=m+8|0;if((o[p>>2]|0)==(d|0))v=p;else Zt()}else v=m+8|0;o[r+12>>2]=m;o[v>>2]=r;r=d;m=f;break}v=o[t+(g+24)>>2]|0;b=o[t+(g+12)>>2]|0;do{if((b|0)==(d|0)){y=t+(g+20)|0;b=o[y>>2]|0;if(!b){y=t+(g+16)|0;b=o[y>>2]|0;if(!b){p=0;break}}while(1){w=b+20|0;E=o[w>>2]|0;if(E){b=E;y=w;continue}w=b+16|0;E=o[w>>2]|0;if(!E)break;else{b=E;y=w}}if(y>>>0<_>>>0)Zt();else{o[y>>2]=0;p=b;break}}else{y=o[t+(g+8)>>2]|0;if(y>>>0<_>>>0)Zt();_=y+12|0;if((o[_>>2]|0)!=(d|0))Zt();w=b+8|0;if((o[w>>2]|0)==(d|0)){o[_>>2]=b;o[w>>2]=y;p=b;break}else Zt()}}while(0);if(v){_=o[t+(g+28)>>2]|0;b=5128+(_<<2)|0;if((d|0)==(o[b>>2]|0)){o[b>>2]=p;if(!p){o[1207]=o[1207]&~(1<<_);r=d;m=f;break}}else{if(v>>>0<(o[1210]|0)>>>0)Zt();_=v+16|0;if((o[_>>2]|0)==(d|0))o[_>>2]=p;else o[v+20>>2]=p;if(!p){r=d;m=f;break}}_=o[1210]|0;if(p>>>0<_>>>0)Zt();o[p+24>>2]=v;v=o[t+(g+16)>>2]|0;do{if(v)if(v>>>0<_>>>0)Zt();else{o[p+16>>2]=v;o[v+24>>2]=p;break}}while(0);g=o[t+(g+20)>>2]|0;if(g)if(g>>>0<(o[1210]|0)>>>0)Zt();else{o[p+20>>2]=g;o[g+24>>2]=p;r=d;m=f;break}else{r=d;m=f}}else{r=d;m=f}}else{r=g;m=l}}while(0);if(r>>>0>=a>>>0)Zt();f=t+(l+-4)|0;d=o[f>>2]|0;if(!(d&1))Zt();if(!(d&2)){if((a|0)==(o[1212]|0)){E=(o[1209]|0)+m|0;o[1209]=E;o[1212]=r;o[r+4>>2]=E|1;if((r|0)!=(o[1211]|0)){c=e;return}o[1211]=0;o[1208]=0;c=e;return}if((a|0)==(o[1211]|0)){E=(o[1208]|0)+m|0;o[1208]=E;o[1211]=r;o[r+4>>2]=E|1;o[r+E>>2]=E;c=e;return}m=(d&-8)+m|0;f=d>>>3;do{if(d>>>0>=256){h=o[t+(l+16)>>2]|0;f=o[t+(l|4)>>2]|0;do{if((f|0)==(a|0)){d=t+(l+12)|0;f=o[d>>2]|0;if(!f){d=t+(l+8)|0;f=o[d>>2]|0;if(!f){u=0;break}}while(1){g=f+20|0;p=o[g>>2]|0;if(p){f=p;d=g;continue}p=f+16|0;g=o[p>>2]|0;if(!g)break;else{f=g;d=p}}if(d>>>0<(o[1210]|0)>>>0)Zt();else{o[d>>2]=0;u=f;break}}else{d=o[t+l>>2]|0;if(d>>>0<(o[1210]|0)>>>0)Zt();p=d+12|0;if((o[p>>2]|0)!=(a|0))Zt();g=f+8|0;if((o[g>>2]|0)==(a|0)){o[p>>2]=f;o[g>>2]=d;u=f;break}else Zt()}}while(0);if(h){f=o[t+(l+20)>>2]|0;d=5128+(f<<2)|0;if((a|0)==(o[d>>2]|0)){o[d>>2]=u;if(!u){o[1207]=o[1207]&~(1<<f);break}}else{if(h>>>0<(o[1210]|0)>>>0)Zt();f=h+16|0;if((o[f>>2]|0)==(a|0))o[f>>2]=u;else o[h+20>>2]=u;if(!u)break}a=o[1210]|0;if(u>>>0<a>>>0)Zt();o[u+24>>2]=h;h=o[t+(l+8)>>2]|0;do{if(h)if(h>>>0<a>>>0)Zt();else{o[u+16>>2]=h;o[h+24>>2]=u;break}}while(0);a=o[t+(l+12)>>2]|0;if(a)if(a>>>0<(o[1210]|0)>>>0)Zt();else{o[u+20>>2]=a;o[a+24>>2]=u;break}}}else{u=o[t+l>>2]|0;l=o[t+(l|4)>>2]|0;t=4864+(f<<1<<2)|0;if((u|0)!=(t|0)){if(u>>>0<(o[1210]|0)>>>0)Zt();if((o[u+12>>2]|0)!=(a|0))Zt()}if((l|0)==(u|0)){o[1206]=o[1206]&~(1<<f);break}if((l|0)!=(t|0)){if(l>>>0<(o[1210]|0)>>>0)Zt();t=l+8|0;if((o[t>>2]|0)==(a|0))h=t;else Zt()}else h=l+8|0;o[u+12>>2]=l;o[h>>2]=u}}while(0);o[r+4>>2]=m|1;o[r+m>>2]=m;if((r|0)==(o[1211]|0)){o[1208]=m;c=e;return}}else{o[f>>2]=d&-2;o[r+4>>2]=m|1;o[r+m>>2]=m}a=m>>>3;if(m>>>0<256){l=a<<1;i=4864+(l<<2)|0;u=o[1206]|0;a=1<<a;if(u&a){l=4864+(l+2<<2)|0;a=o[l>>2]|0;if(a>>>0<(o[1210]|0)>>>0)Zt();else{n=l;s=a}}else{o[1206]=u|a;n=4864+(l+2<<2)|0;s=i}o[n>>2]=r;o[s+12>>2]=r;o[r+8>>2]=s;o[r+12>>2]=i;c=e;return}n=m>>>8;if(n)if(m>>>0>16777215)n=31;else{w=(n+1048320|0)>>>16&8;E=n<<w;y=(E+520192|0)>>>16&4;E=E<<y;n=(E+245760|0)>>>16&2;n=14-(y|w|n)+(E<<n>>>15)|0;n=m>>>(n+7|0)&1|n<<1}else n=0;s=5128+(n<<2)|0;o[r+28>>2]=n;o[r+20>>2]=0;o[r+16>>2]=0;l=o[1207]|0;a=1<<n;t:do{if(l&a){s=o[s>>2]|0;if((n|0)==31)n=0;else n=25-(n>>>1)|0;e:do{if((o[s+4>>2]&-8|0)!=(m|0)){n=m<<n;while(1){l=s+(n>>>31<<2)+16|0;a=o[l>>2]|0;if(!a)break;if((o[a+4>>2]&-8|0)==(m|0)){i=a;break e}else{n=n<<1;s=a}}if(l>>>0<(o[1210]|0)>>>0)Zt();else{o[l>>2]=r;o[r+24>>2]=s;o[r+12>>2]=r;o[r+8>>2]=r;break t}}else i=s}while(0);s=i+8|0;n=o[s>>2]|0;E=o[1210]|0;if(i>>>0>=E>>>0&n>>>0>=E>>>0){o[n+12>>2]=r;o[s>>2]=r;o[r+8>>2]=n;o[r+12>>2]=i;o[r+24>>2]=0;break}else Zt()}else{o[1207]=l|a;o[s>>2]=r;o[r+24>>2]=s;o[r+12>>2]=r;o[r+8>>2]=r}}while(0);E=(o[1214]|0)+-1|0;o[1214]=E;if(!E)i=5280|0;else{c=e;return}while(1){i=o[i>>2]|0;if(!i)break;else i=i+8|0}o[1214]=-1;c=e;return}function Ur(t,e){t=t|0;e=e|0;var i=0,r=0,n=0;i=c;do{if(t){if(e>>>0>4294967231){o[(Wt()|0)>>2]=12;r=0;break}if(e>>>0<11)r=16;else r=e+11&-8;r=Qr(t+-8|0,r)|0;if(r){r=r+8|0;break}r=Vr(e)|0;if(!r)r=0;else{n=o[t+-4>>2]|0;n=(n&-8)-((n&3|0)==0?8:4)|0;hn(r|0,t|0,(n>>>0<e>>>0?n:e)|0)|0;Br(t)}}else r=Vr(e)|0}while(0);c=i;return r|0}function Kr(t){t=t|0;if((t|0)==32)t=1;else t=(t+-9|0)>>>0<5;return t&1|0}function Hr(t,e,i,n,a){t=t|0;e=e|0;i=i|0;n=n|0;a=a|0;var l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0;l=c;if(e>>>0>36){o[(Wt()|0)>>2]=22;v=0;b=0;N=v;c=l;return b|0}u=t+4|0;h=t+100|0;do{f=o[u>>2]|0;if(f>>>0<(o[h>>2]|0)>>>0){o[u>>2]=f+1;m=s[f>>0]|0}else m=qr(t)|0}while((Kr(m)|0)!=0);do{if((m|0)==43|(m|0)==45){f=((m|0)==45)<<31>>31;d=o[u>>2]|0;if(d>>>0<(o[h>>2]|0)>>>0){o[u>>2]=d+1;m=s[d>>0]|0;break}else{m=qr(t)|0;break}}else f=0}while(0);d=(e|0)==0;do{if((e&-17|0)==0&(m|0)==48){m=o[u>>2]|0;if(m>>>0<(o[h>>2]|0)>>>0){o[u>>2]=m+1;m=s[m>>0]|0}else m=qr(t)|0;if((m|32|0)!=120)if(d){e=8;i=46;break}else{i=32;break}e=o[u>>2]|0;if(e>>>0<(o[h>>2]|0)>>>0){o[u>>2]=e+1;m=s[e>>0]|0}else m=qr(t)|0;if((s[m+5321>>0]|0)>15){n=(o[h>>2]|0)==0;if(!n)o[u>>2]=(o[u>>2]|0)+-1;if(!i){zr(t,0);v=0;b=0;N=v;c=l;return b|0}if(n){v=0;b=0;N=v;c=l;return b|0}o[u>>2]=(o[u>>2]|0)+-1;v=0;b=0;N=v;c=l;return b|0}else{e=16;i=46}}else{e=d?10:e;if((s[m+5321>>0]|0)>>>0<e>>>0)i=32;else{if(o[h>>2]|0)o[u>>2]=(o[u>>2]|0)+-1;zr(t,0);o[(Wt()|0)>>2]=22;v=0;b=0;N=v;c=l;return b|0}}}while(0);if((i|0)==32)if((e|0)==10){e=m+-48|0;if(e>>>0<10){d=0;do{d=(d*10|0)+e|0;e=o[u>>2]|0;if(e>>>0<(o[h>>2]|0)>>>0){o[u>>2]=e+1;m=s[e>>0]|0}else m=qr(t)|0;e=m+-48|0}while(e>>>0<10&d>>>0<429496729);p=0}else{d=0;p=0}e=m+-48|0;if(e>>>0<10){do{g=_n(d|0,p|0,10,0)|0;_=N;v=((e|0)<0)<<31>>31;b=~v;if(_>>>0>b>>>0|(_|0)==(b|0)&g>>>0>~e>>>0)break;d=ln(g|0,_|0,e|0,v|0)|0;p=N;e=o[u>>2]|0;if(e>>>0<(o[h>>2]|0)>>>0){o[u>>2]=e+1;m=s[e>>0]|0}else m=qr(t)|0;e=m+-48|0}while(e>>>0<10&(p>>>0<429496729|(p|0)==429496729&d>>>0<2576980378));if(e>>>0<=9){e=10;i=72}}}else i=46;t:do{if((i|0)==46){if(!(e+-1&e)){i=r[5584+((e*23|0)>>>5&7)>>0]|0;_=r[m+5321>>0]|0;d=_&255;if(d>>>0<e>>>0){m=d;d=0;do{d=m|d<<i;m=o[u>>2]|0;if(m>>>0<(o[h>>2]|0)>>>0){o[u>>2]=m+1;v=s[m>>0]|0}else v=qr(t)|0;_=r[v+5321>>0]|0;m=_&255}while(m>>>0<e>>>0&d>>>0<134217728);p=0}else{p=0;d=0;v=m}m=un(-1,-1,i|0)|0;g=N;if((_&255)>>>0>=e>>>0|(p>>>0>g>>>0|(p|0)==(g|0)&d>>>0>m>>>0)){m=v;i=72;break}while(1){d=sn(d|0,p|0,i|0)|0;p=N;d=_&255|d;_=o[u>>2]|0;if(_>>>0<(o[h>>2]|0)>>>0){o[u>>2]=_+1;v=s[_>>0]|0}else v=qr(t)|0;_=r[v+5321>>0]|0;if((_&255)>>>0>=e>>>0|(p>>>0>g>>>0|(p|0)==(g|0)&d>>>0>m>>>0)){m=v;i=72;break t}}}_=r[m+5321>>0]|0;i=_&255;if(i>>>0<e>>>0){d=0;do{d=i+(nt(d,e)|0)|0;i=o[u>>2]|0;if(i>>>0<(o[h>>2]|0)>>>0){o[u>>2]=i+1;g=s[i>>0]|0}else g=qr(t)|0;_=r[g+5321>>0]|0;i=_&255}while(i>>>0<e>>>0&d>>>0<119304647);p=0}else{d=0;p=0;g=m}if((_&255)>>>0<e>>>0){i=vn(-1,-1,e|0,0)|0;m=N;while(1){if(p>>>0>m>>>0|(p|0)==(m|0)&d>>>0>i>>>0){m=g;i=72;break t}v=_n(d|0,p|0,e|0,0)|0;b=N;_=_&255;if(b>>>0>4294967295|(b|0)==-1&v>>>0>~_>>>0){m=g;i=72;break t}d=ln(_|0,0,v|0,b|0)|0;p=N;g=o[u>>2]|0;if(g>>>0<(o[h>>2]|0)>>>0){o[u>>2]=g+1;g=s[g>>0]|0}else g=qr(t)|0;_=r[g+5321>>0]|0;if((_&255)>>>0>=e>>>0){m=g;i=72;break}}}else{m=g;i=72}}}while(0);if((i|0)==72)if((s[m+5321>>0]|0)>>>0<e>>>0){do{i=o[u>>2]|0;if(i>>>0<(o[h>>2]|0)>>>0){o[u>>2]=i+1;i=s[i>>0]|0}else i=qr(t)|0}while((s[i+5321>>0]|0)>>>0<e>>>0);o[(Wt()|0)>>2]=34;p=a;d=n}if(o[h>>2]|0)o[u>>2]=(o[u>>2]|0)+-1;if(!(p>>>0<a>>>0|(p|0)==(a|0)&d>>>0<n>>>0)){if(!((n&1|0)!=0|0!=0|(f|0)!=0)){o[(Wt()|0)>>2]=34;b=ln(n|0,a|0,-1,-1)|0;v=N;N=v;c=l;return b|0}if(p>>>0>a>>>0|(p|0)==(a|0)&d>>>0>n>>>0){o[(Wt()|0)>>2]=34;v=a;b=n;N=v;c=l;return b|0}}b=((f|0)<0)<<31>>31;b=nn(d^f|0,p^b|0,f|0,b|0)|0;v=N;N=v;c=l;return b|0}function Wr(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0.0,_=0,v=0,b=0,y=0,w=0,E=0,M=0,A=0,T=0,C=0,x=0,R=0,O=0.0,L=0,P=0.0,I=0.0,F=0.0,D=0.0;n=c;c=c+512|0;u=n;if(!e){e=24;l=-149}else if((e|0)==2){e=53;l=-1074}else if((e|0)==1){e=53;l=-1074}else{I=0.0;c=n;return+I}d=t+4|0;m=t+100|0;do{a=o[d>>2]|0;if(a>>>0<(o[m>>2]|0)>>>0){o[d>>2]=a+1;y=s[a>>0]|0}else y=qr(t)|0}while((Kr(y)|0)!=0);do{if((y|0)==43|(y|0)==45){a=1-(((y|0)==45&1)<<1)|0;f=o[d>>2]|0;if(f>>>0<(o[m>>2]|0)>>>0){o[d>>2]=f+1;y=s[f>>0]|0;break}else{y=qr(t)|0;break}}else a=1}while(0);_=0;do{if((y|32|0)!=(r[5600+_>>0]|0))break;do{if(_>>>0<7){f=o[d>>2]|0;if(f>>>0<(o[m>>2]|0)>>>0){o[d>>2]=f+1;y=s[f>>0]|0;break}else{y=qr(t)|0;break}}}while(0);_=_+1|0}while(_>>>0<8);do{if((_|0)==3)p=23;else if((_|0)!=8){f=(i|0)!=0;if(_>>>0>3&f)if((_|0)==8)break;else{p=23;break}t:do{if(!_){_=0;do{if((y|32|0)!=(r[5616+_>>0]|0))break t;do{if(_>>>0<2){v=o[d>>2]|0;if(v>>>0<(o[m>>2]|0)>>>0){o[d>>2]=v+1;y=s[v>>0]|0;break}else{y=qr(t)|0;break}}}while(0);_=_+1|0}while(_>>>0<3)}}while(0);if(!_){do{if((y|0)==48){f=o[d>>2]|0;if(f>>>0<(o[m>>2]|0)>>>0){o[d>>2]=f+1;f=s[f>>0]|0}else f=qr(t)|0;if((f|32|0)!=120){if(!(o[m>>2]|0)){y=48;break}o[d>>2]=(o[d>>2]|0)+-1;y=48;break}u=o[d>>2]|0;if(u>>>0<(o[m>>2]|0)>>>0){o[d>>2]=u+1;M=s[u>>0]|0;w=0}else{M=qr(t)|0;w=0}while(1){if((M|0)==46){p=70;break}else if((M|0)!=48){u=0;f=0;v=0;_=0;y=0;E=0;O=1.0;b=0;g=0.0;break}u=o[d>>2]|0;if(u>>>0<(o[m>>2]|0)>>>0){o[d>>2]=u+1;M=s[u>>0]|0;w=1;continue}else{M=qr(t)|0;w=1;continue}}if((p|0)==70){u=o[d>>2]|0;if(u>>>0<(o[m>>2]|0)>>>0){o[d>>2]=u+1;M=s[u>>0]|0}else M=qr(t)|0;if((M|0)==48){v=0;_=0;do{u=o[d>>2]|0;if(u>>>0<(o[m>>2]|0)>>>0){o[d>>2]=u+1;M=s[u>>0]|0}else M=qr(t)|0;v=ln(v|0,_|0,-1,-1)|0;_=N}while((M|0)==48);u=0;f=0;w=1;y=1;E=0;O=1.0;b=0;g=0.0}else{u=0;f=0;v=0;_=0;y=1;E=0;O=1.0;b=0;g=0.0}}t:while(1){T=M+-48|0;do{if(T>>>0>=10){A=M|32;C=(M|0)==46;if(!((A+-97|0)>>>0<6|C))break t;if(C)if(!y){v=f;_=u;y=1;break}else{M=46;break t}else{T=(M|0)>57?A+-87|0:T;p=83;break}}else p=83}while(0);if((p|0)==83){p=0;do{if(!((u|0)<0|(u|0)==0&f>>>0<8)){if((u|0)<0|(u|0)==0&f>>>0<14){I=O*.0625;P=I;g=g+I*+(T|0);break}if((T|0)==0|(E|0)!=0)P=O;else{E=1;P=O;g=g+O*.5}}else{P=O;b=T+(b<<4)|0}}while(0);f=ln(f|0,u|0,1,0)|0;u=N;w=1;O=P}M=o[d>>2]|0;if(M>>>0<(o[m>>2]|0)>>>0){o[d>>2]=M+1;M=s[M>>0]|0;continue}else{M=qr(t)|0;continue}}if(!w){e=(o[m>>2]|0)==0;if(!e)o[d>>2]=(o[d>>2]|0)+-1;if(i){if(!e?(h=o[d>>2]|0,o[d>>2]=h+-1,(y|0)!=0):0)o[d>>2]=h+-2}else zr(t,0);I=+(a|0)*0.0;c=n;return+I}p=(y|0)==0;h=p?f:v;p=p?u:_;if((u|0)<0|(u|0)==0&f>>>0<8)do{b=b<<4;f=ln(f|0,u|0,1,0)|0;u=N}while((u|0)<0|(u|0)==0&f>>>0<8);do{if((M|32|0)==112){f=en(t,i)|0;u=N;if((f|0)==0&(u|0)==-2147483648)if(!i){zr(t,0);I=0.0;c=n;return+I}else{if(!(o[m>>2]|0)){f=0;u=0;break}o[d>>2]=(o[d>>2]|0)+-1;f=0;u=0;break}}else if(!(o[m>>2]|0)){f=0;u=0}else{o[d>>2]=(o[d>>2]|0)+-1;f=0;u=0}}while(0);h=sn(h|0,p|0,2)|0;h=ln(h|0,N|0,-32,-1)|0;u=ln(h|0,N|0,f|0,u|0)|0;h=N;if(!b){I=+(a|0)*0.0;c=n;return+I}if((h|0)>0|(h|0)==0&u>>>0>(0-l|0)>>>0){o[(Wt()|0)>>2]=34;I=+(a|0)*1.7976931348623157e+308*1.7976931348623157e+308;c=n;return+I}L=l+-106|0;R=((L|0)<0)<<31>>31;if((h|0)<(R|0)|(h|0)==(R|0)&u>>>0<L>>>0){o[(Wt()|0)>>2]=34;I=+(a|0)*2.2250738585072014e-308*2.2250738585072014e-308;c=n;return+I}if((b|0)>-1)do{b=b<<1;if(!(g>=.5))O=g;else{O=g+-1.0;b=b|1}g=g+O;u=ln(u|0,h|0,-1,-1)|0;h=N}while((b|0)>-1);l=nn(32,0,l|0,((l|0)<0)<<31>>31|0)|0;l=ln(u|0,h|0,l|0,N|0)|0;L=N;if(0>(L|0)|0==(L|0)&e>>>0>l>>>0)if((l|0)<0){e=0;p=126}else{e=l;p=124}else p=124;if((p|0)==124)if((e|0)<53)p=126;else{l=e;O=+(a|0);P=0.0}if((p|0)==126){P=+(a|0);l=e;O=P;P=+Gt(+ +jr(1.0,84-e|0),+P)}L=(l|0)<32&g!=0.0&(b&1|0)==0;g=O*(L?0.0:g)+(P+O*+(((L&1)+b|0)>>>0))-P;if(!(g!=0.0))o[(Wt()|0)>>2]=34;I=+Xr(g,u);c=n;return+I}}while(0);f=l+e|0;h=0-f|0;T=0;while(1){if((y|0)==46){p=137;break}else if((y|0)!=48){x=0;C=0;A=0;break}_=o[d>>2]|0;if(_>>>0<(o[m>>2]|0)>>>0){o[d>>2]=_+1;y=s[_>>0]|0;T=1;continue}else{y=qr(t)|0;T=1;continue}}if((p|0)==137){p=o[d>>2]|0;if(p>>>0<(o[m>>2]|0)>>>0){o[d>>2]=p+1;y=s[p>>0]|0}else y=qr(t)|0;if((y|0)==48){x=0;C=0;do{x=ln(x|0,C|0,-1,-1)|0;C=N;p=o[d>>2]|0;if(p>>>0<(o[m>>2]|0)>>>0){o[d>>2]=p+1;y=s[p>>0]|0}else y=qr(t)|0}while((y|0)==48);T=1;A=1}else{x=0;C=0;A=1}}o[u>>2]=0;M=y+-48|0;R=(y|0)==46;t:do{if(M>>>0<10|R){p=u+496|0;E=0;w=0;b=0;v=0;_=0;e:while(1){do{if(R)if(!A){x=E;C=w;A=1}else break e;else{R=ln(E|0,w|0,1,0)|0;w=N;L=(y|0)!=48;if((v|0)>=125){if(!L){E=R;break}o[p>>2]=o[p>>2]|1;E=R;break}E=u+(v<<2)|0;if(b)M=y+-48+((o[E>>2]|0)*10|0)|0;o[E>>2]=M;b=b+1|0;M=(b|0)==9;E=R;T=1;b=M?0:b;v=(M&1)+v|0;_=L?R:_}}while(0);y=o[d>>2]|0;if(y>>>0<(o[m>>2]|0)>>>0){o[d>>2]=y+1;y=s[y>>0]|0}else y=qr(t)|0;M=y+-48|0;R=(y|0)==46;if(!(M>>>0<10|R)){p=160;break t}}M=(T|0)!=0;p=168}else{E=0;w=0;b=0;v=0;_=0;p=160}}while(0);do{if((p|0)==160){M=(A|0)==0;x=M?E:x;C=M?w:C;M=(T|0)!=0;if(!(M&(y|32|0)==101))if((y|0)>-1){p=168;break}else{p=170;break}M=en(t,i)|0;y=N;do{if((M|0)==0&(y|0)==-2147483648)if(!i){zr(t,0);I=0.0;c=n;return+I}else{if(!(o[m>>2]|0)){M=0;y=0;break}o[d>>2]=(o[d>>2]|0)+-1;M=0;y=0;break}}while(0);t=ln(M|0,y|0,x|0,C|0)|0;C=N}}while(0);if((p|0)==168)if(o[m>>2]|0){o[d>>2]=(o[d>>2]|0)+-1;if(M)t=x;else p=171}else p=170;if((p|0)==170)if(M)t=x;else p=171;if((p|0)==171){o[(Wt()|0)>>2]=22;zr(t,0);I=0.0;c=n;return+I}d=o[u>>2]|0;if(!d){I=+(a|0)*0.0;c=n;return+I}if((t|0)==(E|0)&(C|0)==(w|0)&((w|0)<0|(w|0)==0&E>>>0<10)?e>>>0>30|(d>>>e|0)==0:0){I=+(a|0)*+(d>>>0);c=n;return+I}L=(l|0)/-2|0;R=((L|0)<0)<<31>>31;if((C|0)>(R|0)|(C|0)==(R|0)&t>>>0>L>>>0){o[(Wt()|0)>>2]=34;I=+(a|0)*1.7976931348623157e+308*1.7976931348623157e+308;c=n;return+I}L=l+-106|0;R=((L|0)<0)<<31>>31;if((C|0)<(R|0)|(C|0)==(R|0)&t>>>0<L>>>0){o[(Wt()|0)>>2]=34;I=+(a|0)*2.2250738585072014e-308*2.2250738585072014e-308;c=n;return+I}if(b){if((b|0)<9){d=u+(v<<2)|0;m=o[d>>2]|0;do{m=m*10|0;b=b+1|0}while((b|0)!=9);o[d>>2]=m}v=v+1|0}if((_|0)<9?(_|0)<=(t|0)&(t|0)<18:0){if((t|0)==9){I=+(a|0)*+((o[u>>2]|0)>>>0);c=n;return+I}if((t|0)<9){I=+(a|0)*+((o[u>>2]|0)>>>0)/+(o[5632+(8-t<<2)>>2]|0);c=n;return+I}L=e+27+(nt(t,-3)|0)|0;d=o[u>>2]|0;if((L|0)>30|(d>>>L|0)==0){I=+(a|0)*+(d>>>0)*+(o[5632+(t+-10<<2)>>2]|0);c=n;return+I}}d=(t|0)%9|0;if(!d){d=0;m=0}else{i=(t|0)>-1?d:d+9|0;p=o[5632+(8-i<<2)>>2]|0;if(v){_=1e9/(p|0)|0;d=0;m=0;b=0;do{x=u+(b<<2)|0;R=o[x>>2]|0;L=((R>>>0)/(p>>>0)|0)+m|0;o[x>>2]=L;m=nt((R>>>0)%(p>>>0)|0,_)|0;R=b;b=b+1|0;if((R|0)==(d|0)&(L|0)==0){d=b&127;t=t+-9|0}}while((b|0)!=(v|0));if(m){o[u+(v<<2)>>2]=m;v=v+1|0}}else{d=0;v=0}m=0;t=9-i+t|0}t:while(1){i=u+(d<<2)|0;if((t|0)<18){do{_=0;i=v+127|0;while(1){i=i&127;p=u+(i<<2)|0;b=sn(o[p>>2]|0,0,29)|0;b=ln(b|0,N|0,_|0,0)|0;_=N;if(_>>>0>0|(_|0)==0&b>>>0>1e9){L=vn(b|0,_|0,1e9,0)|0;b=bn(b|0,_|0,1e9,0)|0;_=L}else _=0;o[p>>2]=b;p=(i|0)==(d|0);if(!((i|0)!=(v+127&127|0)|p))v=(b|0)==0?i:v;if(p)break;else i=i+-1|0}m=m+-29|0}while((_|0)==0)}else{if((t|0)!=18)break;do{if((o[i>>2]|0)>>>0>=9007199){t=18;break t}_=0;p=v+127|0;while(1){p=p&127;b=u+(p<<2)|0;y=sn(o[b>>2]|0,0,29)|0;y=ln(y|0,N|0,_|0,0)|0;_=N;if(_>>>0>0|(_|0)==0&y>>>0>1e9){L=vn(y|0,_|0,1e9,0)|0;y=bn(y|0,_|0,1e9,0)|0;_=L}else _=0;o[b>>2]=y;b=(p|0)==(d|0);if(!((p|0)!=(v+127&127|0)|b))v=(y|0)==0?p:v;if(b)break;else p=p+-1|0}m=m+-29|0}while((_|0)==0)}d=d+127&127;if((d|0)==(v|0)){L=v+127&127;v=u+((v+126&127)<<2)|0;o[v>>2]=o[v>>2]|o[u+(L<<2)>>2];v=L}o[u+(d<<2)>>2]=_;t=t+9|0}t:while(1){i=v+1&127;p=u+((v+127&127)<<2)|0;while(1){b=(t|0)==18;_=(t|0)>27?9:1;while(1){y=0;while(1){w=y+d&127;if((w|0)==(v|0)){y=2;break}E=o[u+(w<<2)>>2]|0;M=o[5624+(y<<2)>>2]|0;if(E>>>0<M>>>0){y=2;break}w=y+1|0;if(E>>>0>M>>>0)break;if((w|0)<2)y=w;else{y=w;break}}if((y|0)==2&b)break t;m=_+m|0;if((d|0)==(v|0))d=v;else break}b=(1<<_)+-1|0;y=1e9>>>_;w=d;E=0;do{x=u+(d<<2)|0;R=o[x>>2]|0;L=(R>>>_)+E|0;o[x>>2]=L;E=nt(R&b,y)|0;L=(d|0)==(w|0)&(L|0)==0;d=d+1&127;t=L?t+-9|0:t;w=L?d:w}while((d|0)!=(v|0));if(!E){d=w;continue}if((i|0)!=(w|0))break;o[p>>2]=o[p>>2]|1;d=w}o[u+(v<<2)>>2]=E;d=w;v=i}t=d&127;if((t|0)==(v|0)){o[u+(i+-1<<2)>>2]=0;v=i}O=+((o[u+(t<<2)>>2]|0)>>>0);t=d+1&127;if((t|0)==(v|0)){v=v+1&127;o[u+(v+-1<<2)>>2]=0}g=+(a|0);P=g*(O*1.0e9+ +((o[u+(t<<2)>>2]|0)>>>0));a=m+53|0;l=a-l|0;if((l|0)<(e|0))if((l|0)<0){e=0;t=1;p=244}else{e=l;t=1;p=243}else{t=0;p=243}if((p|0)==243)if((e|0)<53)p=244;else{O=0.0;I=0.0}if((p|0)==244){D=+Gt(+ +jr(1.0,105-e|0),+P);F=+oe(+P,+ +jr(1.0,53-e|0));O=D;I=F;P=D+(P-F)}i=d+2&127;do{if((i|0)!=(v|0)){u=o[u+(i<<2)>>2]|0;do{if(u>>>0>=5e8){if(u>>>0>5e8){I=g*.75+I;break}if((d+3&127|0)==(v|0)){I=g*.5+I;break}else{I=g*.75+I;break}}else{if((u|0)==0?(d+3&127|0)==(v|0):0)break;I=g*.25+I}}while(0);if((53-e|0)<=1)break;if(+oe(+I,1.0)!=0.0)break;I=I+1.0}}while(0);g=P+I-O;do{if((a&2147483647|0)>(-2-f|0)){if(+q(+g)>=9007199254740992.0){t=(t|0)!=0&(e|0)==(l|0)?0:t;m=m+1|0;g=g*.5}if((m+50|0)<=(h|0)?!((t|0)!=0&I!=0.0):0)break;o[(Wt()|0)>>2]=34}}while(0);D=+Xr(g,m);c=n;return+D}else if((_|0)==3){e=o[d>>2]|0;if(e>>>0<(o[m>>2]|0)>>>0){o[d>>2]=e+1;e=s[e>>0]|0}else e=qr(t)|0;if((e|0)==40)e=1;else{if(!(o[m>>2]|0)){D=k;c=n;return+D}o[d>>2]=(o[d>>2]|0)+-1;D=k;c=n;return+D}while(1){a=o[d>>2]|0;if(a>>>0<(o[m>>2]|0)>>>0){o[d>>2]=a+1;a=s[a>>0]|0}else a=qr(t)|0;if(!((a+-48|0)>>>0<10|(a+-65|0)>>>0<26)?!((a+-97|0)>>>0<26|(a|0)==95):0)break;e=e+1|0}if((a|0)==41){D=k;c=n;return+D}a=(o[m>>2]|0)==0;if(!a)o[d>>2]=(o[d>>2]|0)+-1;if(!f){o[(Wt()|0)>>2]=22;zr(t,0);D=0.0;c=n;return+D}if((e|0)==0|a){D=k;c=n;return+D}do{e=e+-1|0;o[d>>2]=(o[d>>2]|0)+-1}while((e|0)!=0);g=k;c=n;return+g}else{if(o[m>>2]|0)o[d>>2]=(o[d>>2]|0)+-1;o[(Wt()|0)>>2]=22;zr(t,0);D=0.0;c=n;return+D}}}while(0);if((p|0)==23){e=(o[m>>2]|0)==0;if(!e)o[d>>2]=(o[d>>2]|0)+-1;if(!(_>>>0<4|(i|0)==0|e))do{o[d>>2]=(o[d>>2]|0)+-1;_=_+-1|0}while(_>>>0>3)}D=+(a|0)*S;c=n;return+D}function zr(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0;i=c;o[t+104>>2]=e;n=o[t+8>>2]|0;r=o[t+4>>2]|0;s=n-r|0;o[t+108>>2]=s;if((e|0)!=0&(s|0)>(e|0)){o[t+100>>2]=r+e;c=i;return}else{o[t+100>>2]=n;c=i;return}}function qr(t){t=t|0;var e=0,i=0,n=0,a=0,l=0,u=0,h=0;i=c;l=t+104|0;h=o[l>>2]|0;if(!((h|0)!=0?(o[t+108>>2]|0)>=(h|0):0))u=3;if((u|0)==3?(e=$r(t)|0,(e|0)>=0):0){u=o[l>>2]|0;l=o[t+8>>2]|0;if((u|0)!=0?(n=o[t+4>>2]|0,a=u-(o[t+108>>2]|0)+-1|0,(l-n|0)>(a|0)):0)o[t+100>>2]=n+a;else o[t+100>>2]=l;n=o[t+4>>2]|0;if(l){h=t+108|0;o[h>>2]=l+1-n+(o[h>>2]|0)}t=n+-1|0;if((s[t>>0]|0|0)==(e|0)){h=e;c=i;return h|0}r[t>>0]=e;h=e;c=i;return h|0}o[t+100>>2]=0;h=-1;c=i;return h|0}function jr(t,e){t=+t;e=e|0;var i=0,r=0;i=c;if((e|0)>1023){t=t*8.98846567431158e+307;r=e+-1023|0;if((r|0)>1023){e=e+-2046|0;e=(e|0)>1023?1023:e;t=t*8.98846567431158e+307}else e=r}else if((e|0)<-1022){t=t*2.2250738585072014e-308;r=e+1022|0;if((r|0)<-1022){e=e+2044|0;e=(e|0)<-1022?-1022:e;t=t*2.2250738585072014e-308}else e=r}e=sn(e+1023|0,0,52)|0;r=N;o[d>>2]=e;o[d+4>>2]=r;t=t*+h[d>>3];c=i;return+t}function Xr(t,e){t=+t;e=e|0;var i=0;i=c;t=+jr(t,e);c=i;return+t}function Yr(t){t=t|0;var e=0,i=0,n=0;i=c;n=t+74|0;e=r[n>>0]|0;r[n>>0]=e+255|e;n=t+20|0;e=t+44|0;if((o[n>>2]|0)>>>0>(o[e>>2]|0)>>>0)Un[o[t+36>>2]&1](t,0,0)|0;o[t+16>>2]=0;o[t+28>>2]=0;o[n>>2]=0;n=o[t>>2]|0;if(!(n&20)){n=o[e>>2]|0;o[t+8>>2]=n;o[t+4>>2]=n;n=0;c=i;return n|0}if(!(n&4)){n=-1;c=i;return n|0}o[t>>2]=n|32;n=-1;c=i;return n|0}function $r(t){t=t|0;var e=0,i=0;e=c;c=c+16|0;i=e;if((o[t+8>>2]|0)==0?(Yr(t)|0)!=0:0)t=-1;else if((Un[o[t+32>>2]&1](t,i,1)|0)==1)t=s[i>>0]|0;else t=-1;c=e;return t|0}function Gr(t,e){t=t|0;e=e|0;var i=0,r=0,n=0.0,s=0,a=0;i=c;c=c+112|0;r=i;a=r+0|0;s=a+112|0;do{o[a>>2]=0;a=a+4|0}while((a|0)<(s|0));s=r+4|0;o[s>>2]=t;a=r+8|0;o[a>>2]=-1;o[r+44>>2]=t;o[r+76>>2]=-1;zr(r,0);n=+Wr(r,1,1);r=(o[s>>2]|0)-(o[a>>2]|0)+(o[r+108>>2]|0)|0;if(!e){c=i;return+n}if(r)t=t+r|0;o[e>>2]=t;c=i;return+n}function Zr(t,e,i){t=t|0;e=e|0;i=i|0;var r=0,n=0,s=0;r=c;c=c+112|0;s=r;o[s>>2]=0;n=s+4|0;o[n>>2]=t;o[s+44>>2]=t;if((t|0)<0)o[s+8>>2]=-1;else o[s+8>>2]=t+2147483647;o[s+76>>2]=-1;zr(s,0);i=Hr(s,i,1,-2147483648,0)|0;if(!e){c=r;return i|0}o[e>>2]=t+((o[n>>2]|0)+(o[s+108>>2]|0)-(o[s+8>>2]|0));c=r;return i|0}function Jr(t,e){t=t|0;e=e|0;var i=0,n=0,o=0;i=c;o=r[t>>0]|0;n=r[e>>0]|0;if(o<<24>>24==0?1:o<<24>>24!=n<<24>>24)e=o;else{do{t=t+1|0;e=e+1|0;o=r[t>>0]|0;n=r[e>>0]|0}while(!(o<<24>>24==0?1:o<<24>>24!=n<<24>>24));e=o}c=i;return(e&255)-(n&255)|0}function Qr(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0;i=c;n=t+4|0;r=o[n>>2]|0;h=r&-8;l=t+h|0;f=o[1210]|0;a=r&3;if(!((a|0)!=1&t>>>0>=f>>>0&t>>>0<l>>>0))Zt();s=t+(h|4)|0;p=o[s>>2]|0;if(!(p&1))Zt();if(!a){if(e>>>0<256){_=0;c=i;return _|0}if(h>>>0>=(e+4|0)>>>0?(h-e|0)>>>0<=o[1326]<<1>>>0:0){_=t;c=i;return _|0}_=0;c=i;return _|0}if(h>>>0>=e>>>0){a=h-e|0;if(a>>>0<=15){_=t;c=i;return _|0}o[n>>2]=r&1|e|2;o[t+(e+4)>>2]=a|3;o[s>>2]=o[s>>2]|1;tn(t+e|0,a);_=t;c=i;return _|0}if((l|0)==(o[1212]|0)){s=(o[1209]|0)+h|0;if(s>>>0<=e>>>0){_=0;c=i;return _|0}_=s-e|0;o[n>>2]=r&1|e|2;o[t+(e+4)>>2]=_|1;o[1212]=t+e;o[1209]=_;_=t;c=i;return _|0}if((l|0)==(o[1211]|0)){a=(o[1208]|0)+h|0;if(a>>>0<e>>>0){_=0;c=i;return _|0}s=a-e|0;if(s>>>0>15){o[n>>2]=r&1|e|2;o[t+(e+4)>>2]=s|1;o[t+a>>2]=s;r=t+(a+4)|0;o[r>>2]=o[r>>2]&-2;r=t+e|0}else{o[n>>2]=r&1|a|2;r=t+(a+4)|0;o[r>>2]=o[r>>2]|1;r=0;s=0}o[1208]=s;o[1211]=r;_=t;c=i;return _|0}if(p&2){_=0;c=i;return _|0}s=(p&-8)+h|0;if(s>>>0<e>>>0){_=0;c=i;return _|0}a=s-e|0;m=p>>>3;do{if(p>>>0>=256){d=o[t+(h+24)>>2]|0;m=o[t+(h+12)>>2]|0;do{if((m|0)==(l|0)){p=t+(h+20)|0;m=o[p>>2]|0;if(!m){p=t+(h+16)|0;m=o[p>>2]|0;if(!m){u=0;break}}while(1){_=m+20|0;g=o[_>>2]|0;if(g){m=g;p=_;continue}g=m+16|0;_=o[g>>2]|0;if(!_)break;else{m=_;p=g}}if(p>>>0<f>>>0)Zt();else{o[p>>2]=0;u=m;break}}else{p=o[t+(h+8)>>2]|0;if(p>>>0<f>>>0)Zt();f=p+12|0;if((o[f>>2]|0)!=(l|0))Zt();g=m+8|0;if((o[g>>2]|0)==(l|0)){o[f>>2]=m;o[g>>2]=p;u=m;break}else Zt()}}while(0);if(d){f=o[t+(h+28)>>2]|0;m=5128+(f<<2)|0;if((l|0)==(o[m>>2]|0)){o[m>>2]=u;if(!u){o[1207]=o[1207]&~(1<<f);break}}else{if(d>>>0<(o[1210]|0)>>>0)Zt();f=d+16|0;if((o[f>>2]|0)==(l|0))o[f>>2]=u;else o[d+20>>2]=u;if(!u)break}l=o[1210]|0;if(u>>>0<l>>>0)Zt();o[u+24>>2]=d;f=o[t+(h+16)>>2]|0;do{if(f)if(f>>>0<l>>>0)Zt();else{o[u+16>>2]=f;o[f+24>>2]=u;break}}while(0);l=o[t+(h+20)>>2]|0;if(l)if(l>>>0<(o[1210]|0)>>>0)Zt();else{o[u+20>>2]=l;o[l+24>>2]=u;break}}}else{u=o[t+(h+8)>>2]|0;h=o[t+(h+12)>>2]|0;p=4864+(m<<1<<2)|0;if((u|0)!=(p|0)){if(u>>>0<f>>>0)Zt();if((o[u+12>>2]|0)!=(l|0))Zt()}if((h|0)==(u|0)){o[1206]=o[1206]&~(1<<m);break}if((h|0)!=(p|0)){if(h>>>0<f>>>0)Zt();f=h+8|0;if((o[f>>2]|0)==(l|0))d=f;else Zt()}else d=h+8|0;o[u+12>>2]=h;o[d>>2]=u}}while(0);if(a>>>0<16){o[n>>2]=s|r&1|2;_=t+(s|4)|0;o[_>>2]=o[_>>2]|1;_=t;c=i;return _|0}else{o[n>>2]=r&1|e|2;o[t+(e+4)>>2]=a|3;_=t+(s|4)|0;o[_>>2]=o[_>>2]|1;tn(t+e|0,a);_=t;c=i;return _|0}return 0}function tn(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,s=0,a=0,l=0,u=0,h=0,f=0,d=0,m=0,p=0,g=0,_=0,v=0,b=0,y=0,w=0;i=c;a=t+e|0;h=o[t+4>>2]|0;do{if(!(h&1)){p=o[t>>2]|0;if(!(h&3)){c=i;return}h=t+(0-p)|0;f=p+e|0;_=o[1210]|0;if(h>>>0<_>>>0)Zt();if((h|0)==(o[1211]|0)){r=t+(e+4)|0;d=o[r>>2]|0;if((d&3|0)!=3){r=h;d=f;break}o[1208]=f;o[r>>2]=d&-2;o[t+(4-p)>>2]=f|1;o[a>>2]=f;c=i;return}v=p>>>3;if(p>>>0<256){r=o[t+(8-p)>>2]|0;d=o[t+(12-p)>>2]|0;m=4864+(v<<1<<2)|0;if((r|0)!=(m|0)){if(r>>>0<_>>>0)Zt();if((o[r+12>>2]|0)!=(h|0))Zt()}if((d|0)==(r|0)){o[1206]=o[1206]&~(1<<v);r=h;d=f;break}if((d|0)!=(m|0)){if(d>>>0<_>>>0)Zt();m=d+8|0;if((o[m>>2]|0)==(h|0))g=m;else Zt()}else g=d+8|0;o[r+12>>2]=d;o[g>>2]=r;r=h;d=f;break}g=o[t+(24-p)>>2]|0;v=o[t+(12-p)>>2]|0;do{if((v|0)==(h|0)){y=16-p|0;b=t+(y+4)|0;v=o[b>>2]|0;if(!v){b=t+y|0;v=o[b>>2]|0;if(!v){m=0;break}}while(1){w=v+20|0;y=o[w>>2]|0;if(y){v=y;b=w;continue}y=v+16|0;w=o[y>>2]|0;if(!w)break;else{v=w;b=y}}if(b>>>0<_>>>0)Zt();else{o[b>>2]=0;m=v;break}}else{b=o[t+(8-p)>>2]|0;if(b>>>0<_>>>0)Zt();_=b+12|0;if((o[_>>2]|0)!=(h|0))Zt();y=v+8|0;if((o[y>>2]|0)==(h|0)){o[_>>2]=v;o[y>>2]=b;m=v;break}else Zt()}}while(0);if(g){v=o[t+(28-p)>>2]|0;_=5128+(v<<2)|0;if((h|0)==(o[_>>2]|0)){o[_>>2]=m;if(!m){o[1207]=o[1207]&~(1<<v);r=h;d=f;break}}else{if(g>>>0<(o[1210]|0)>>>0)Zt();_=g+16|0;if((o[_>>2]|0)==(h|0))o[_>>2]=m;else o[g+20>>2]=m;if(!m){r=h;d=f;break}}_=o[1210]|0;if(m>>>0<_>>>0)Zt();o[m+24>>2]=g;p=16-p|0;g=o[t+p>>2]|0;do{if(g)if(g>>>0<_>>>0)Zt();else{o[m+16>>2]=g;o[g+24>>2]=m;break}}while(0);p=o[t+(p+4)>>2]|0;if(p)if(p>>>0<(o[1210]|0)>>>0)Zt();else{o[m+20>>2]=p;o[p+24>>2]=m;r=h;d=f;break}else{r=h;d=f}}else{r=h;d=f}}else{r=t;d=e}}while(0);h=o[1210]|0;if(a>>>0<h>>>0)Zt();f=t+(e+4)|0;m=o[f>>2]|0;if(!(m&2)){if((a|0)==(o[1212]|0)){w=(o[1209]|0)+d|0;o[1209]=w;o[1212]=r;o[r+4>>2]=w|1;if((r|0)!=(o[1211]|0)){c=i;return}o[1211]=0;o[1208]=0;c=i;return}if((a|0)==(o[1211]|0)){w=(o[1208]|0)+d|0;o[1208]=w;o[1211]=r;o[r+4>>2]=w|1;o[r+w>>2]=w;c=i;return}d=(m&-8)+d|0;f=m>>>3;do{if(m>>>0>=256){u=o[t+(e+24)>>2]|0;m=o[t+(e+12)>>2]|0;do{if((m|0)==(a|0)){m=t+(e+20)|0;f=o[m>>2]|0;if(!f){m=t+(e+16)|0;f=o[m>>2]|0;if(!f){l=0;break}}while(1){p=f+20|0;g=o[p>>2]|0;if(g){f=g;m=p;continue}g=f+16|0;p=o[g>>2]|0;if(!p)break;else{f=p;m=g}}if(m>>>0<h>>>0)Zt();else{o[m>>2]=0;l=f;break}}else{f=o[t+(e+8)>>2]|0;if(f>>>0<h>>>0)Zt();p=f+12|0;if((o[p>>2]|0)!=(a|0))Zt();h=m+8|0;if((o[h>>2]|0)==(a|0)){o[p>>2]=m;o[h>>2]=f;l=m;break}else Zt()}}while(0);if(u){f=o[t+(e+28)>>2]|0;h=5128+(f<<2)|0;if((a|0)==(o[h>>2]|0)){o[h>>2]=l;if(!l){o[1207]=o[1207]&~(1<<f);break}}else{if(u>>>0<(o[1210]|0)>>>0)Zt();h=u+16|0;if((o[h>>2]|0)==(a|0))o[h>>2]=l;else o[u+20>>2]=l;if(!l)break}a=o[1210]|0;if(l>>>0<a>>>0)Zt();o[l+24>>2]=u;u=o[t+(e+16)>>2]|0;do{if(u)if(u>>>0<a>>>0)Zt();else{o[l+16>>2]=u;o[u+24>>2]=l;break}}while(0);a=o[t+(e+20)>>2]|0;if(a)if(a>>>0<(o[1210]|0)>>>0)Zt();else{o[l+20>>2]=a;o[a+24>>2]=l;break}}}else{l=o[t+(e+8)>>2]|0;t=o[t+(e+12)>>2]|0;e=4864+(f<<1<<2)|0;if((l|0)!=(e|0)){if(l>>>0<h>>>0)Zt();if((o[l+12>>2]|0)!=(a|0))Zt()}if((t|0)==(l|0)){o[1206]=o[1206]&~(1<<f);break}if((t|0)!=(e|0)){if(t>>>0<h>>>0)Zt();e=t+8|0;if((o[e>>2]|0)==(a|0))u=e;else Zt()}else u=t+8|0;o[l+12>>2]=t;o[u>>2]=l}}while(0);o[r+4>>2]=d|1;o[r+d>>2]=d;if((r|0)==(o[1211]|0)){o[1208]=d;c=i;return}}else{o[f>>2]=m&-2;o[r+4>>2]=d|1;o[r+d>>2]=d}e=d>>>3;if(d>>>0<256){t=e<<1;a=4864+(t<<2)|0;l=o[1206]|0;e=1<<e;if(l&e){t=4864+(t+2<<2)|0;l=o[t>>2]|0;if(l>>>0<(o[1210]|0)>>>0)Zt();else{s=t;n=l}}else{o[1206]=l|e;s=4864+(t+2<<2)|0;n=a}o[s>>2]=r;o[n+12>>2]=r;o[r+8>>2]=n;o[r+12>>2]=a;c=i;return}n=d>>>8;if(n)if(d>>>0>16777215)n=31;else{y=(n+1048320|0)>>>16&8;w=n<<y;b=(w+520192|0)>>>16&4;w=w<<b;n=(w+245760|0)>>>16&2;n=14-(b|y|n)+(w<<n>>>15)|0;n=d>>>(n+7|0)&1|n<<1}else n=0;s=5128+(n<<2)|0;o[r+28>>2]=n;o[r+20>>2]=0;o[r+16>>2]=0;t=o[1207]|0;a=1<<n;if(!(t&a)){o[1207]=t|a;o[s>>2]=r;o[r+24>>2]=s;o[r+12>>2]=r;o[r+8>>2]=r;c=i;return}s=o[s>>2]|0;if((n|0)==31)n=0;else n=25-(n>>>1)|0;t:do{if((o[s+4>>2]&-8|0)!=(d|0)){n=d<<n;t=s;while(1){a=t+(n>>>31<<2)+16|0;s=o[a>>2]|0;if(!s)break;if((o[s+4>>2]&-8|0)==(d|0))break t;else{n=n<<1;t=s}}if(a>>>0<(o[1210]|0)>>>0)Zt();o[a>>2]=r;o[r+24>>2]=t;o[r+12>>2]=r;o[r+8>>2]=r;c=i;return}}while(0);n=s+8|0;a=o[n>>2]|0;w=o[1210]|0;if(!(s>>>0>=w>>>0&a>>>0>=w>>>0))Zt();o[a+12>>2]=r;o[n>>2]=r;o[r+8>>2]=a;o[r+12>>2]=s;o[r+24>>2]=0;c=i;return}function en(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,a=0,l=0,u=0;i=c;n=t+4|0;a=o[n>>2]|0;r=t+100|0;if(a>>>0<(o[r>>2]|0)>>>0){o[n>>2]=a+1;l=s[a>>0]|0}else l=qr(t)|0;if((l|0)==43|(l|0)==45){u=o[n>>2]|0;a=(l|0)==45&1;if(u>>>0<(o[r>>2]|0)>>>0){o[n>>2]=u+1;l=s[u>>0]|0}else l=qr(t)|0;if((l+-48|0)>>>0>9&(e|0)!=0?(o[r>>2]|0)!=0:0)o[n>>2]=(o[n>>2]|0)+-1}else a=0;if((l+-48|0)>>>0>9){if(!(o[r>>2]|0)){l=-2147483648;u=0;N=l;c=i;return u|0}o[n>>2]=(o[n>>2]|0)+-1;l=-2147483648;u=0;N=l;c=i;return u|0}else e=0;do{e=l+-48+(e*10|0)|0;l=o[n>>2]|0;if(l>>>0<(o[r>>2]|0)>>>0){o[n>>2]=l+1;l=s[l>>0]|0}else l=qr(t)|0}while((l+-48|0)>>>0<10&(e|0)<214748364);u=((e|0)<0)<<31>>31;if((l+-48|0)>>>0<10)do{u=_n(e|0,u|0,10,0)|0;e=N;l=ln(l|0,((l|0)<0)<<31>>31|0,-48,-1)|0;e=ln(l|0,N|0,u|0,e|0)|0;u=N;l=o[n>>2]|0;if(l>>>0<(o[r>>2]|0)>>>0){o[n>>2]=l+1;l=s[l>>0]|0}else l=qr(t)|0}while((l+-48|0)>>>0<10&((u|0)<21474836|(u|0)==21474836&e>>>0<2061584302));if((l+-48|0)>>>0<10)do{l=o[n>>2]|0;if(l>>>0<(o[r>>2]|0)>>>0){o[n>>2]=l+1;l=s[l>>0]|0}else l=qr(t)|0}while((l+-48|0)>>>0<10);if(o[r>>2]|0)o[n>>2]=(o[n>>2]|0)+-1;n=(a|0)!=0;a=nn(0,0,e|0,u|0)|0;l=n?N:u;u=n?a:e;N=l;c=i;return u|0}function rn(){}function nn(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;e=e-r-(i>>>0>t>>>0|0)>>>0;return(N=e,t-i>>>0|0)|0}function on(t,e,i){t=t|0;e=e|0;i=i|0;var n=0,s=0,a=0,l=0;n=t+i|0;if((i|0)>=20){e=e&255;l=t&3;a=e|e<<8|e<<16|e<<24;s=n&~3;if(l){l=t+4-l|0;while((t|0)<(l|0)){r[t>>0]=e;t=t+1|0}}while((t|0)<(s|0)){o[t>>2]=a;t=t+4|0}}while((t|0)<(n|0)){r[t>>0]=e;t=t+1|0}return t-i|0}function sn(t,e,i){t=t|0;e=e|0;i=i|0;if((i|0)<32){N=e<<i|(t&(1<<i)-1<<32-i)>>>32-i;return t<<i}N=t<<i-32;return 0}function an(t){t=t|0;var e=0;e=t;while(r[e>>0]|0)e=e+1|0;return e-t|0}function ln(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;i=t+i>>>0;return(N=e+r+(i>>>0<t>>>0|0)>>>0,i|0)|0}function un(t,e,i){t=t|0;e=e|0;i=i|0;if((i|0)<32){N=e>>>i;return t>>>i|(e&(1<<i)-1)<<32-i}N=0;return e>>>i-32|0}function hn(t,e,i){t=t|0;e=e|0;i=i|0;var n=0;if((i|0)>=4096)return Ot(t|0,e|0,i|0)|0;n=t|0;if((t&3)==(e&3)){while(t&3){if(!i)return n|0;r[t>>0]=r[e>>0]|0;t=t+1|0;e=e+1|0;i=i-1|0}while((i|0)>=4){o[t>>2]=o[e>>2];t=t+4|0;e=e+4|0;i=i-4|0}}while((i|0)>0){r[t>>0]=r[e>>0]|0;t=t+1|0;e=e+1|0;i=i-1|0}return n|0}function cn(t,e,i){t=t|0;e=e|0;i=i|0;if((i|0)<32){N=e>>i;return t>>>i|(e&(1<<i)-1)<<32-i}N=(e|0)<0?-1:0;return e>>i-32|0}function fn(t){t=t|0;var e=0;e=r[g+(t>>>24)>>0]|0;if((e|0)<8)return e|0;e=r[g+(t>>16&255)>>0]|0;if((e|0)<8)return e+8|0;e=r[g+(t>>8&255)>>0]|0;if((e|0)<8)return e+16|0;return(r[g+(t&255)>>0]|0)+24|0}function dn(t){t=t|0;var e=0;e=r[p+(t&255)>>0]|0;if((e|0)<8)return e|0;e=r[p+(t>>8&255)>>0]|0;if((e|0)<8)return e+8|0;e=r[p+(t>>16&255)>>0]|0;if((e|0)<8)return e+16|0;return(r[p+(t>>>24)>>0]|0)+24|0}function mn(t,e){t=t|0;e=e|0;var i=0,r=0,n=0,o=0;o=t&65535;r=e&65535;i=nt(r,o)|0;n=t>>>16;r=(i>>>16)+(nt(r,n)|0)|0;e=e>>>16;t=nt(e,o)|0;return(N=(r>>>16)+(nt(e,n)|0)+(((r&65535)+t|0)>>>16)|0,r+t<<16|i&65535|0)|0}function pn(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;var n=0,o=0,s=0,a=0,l=0,u=0;u=e>>31|((e|0)<0?-1:0)<<1;l=((e|0)<0?-1:0)>>31|((e|0)<0?-1:0)<<1;o=r>>31|((r|0)<0?-1:0)<<1;n=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1;a=nn(u^t,l^e,u,l)|0;s=N;e=o^u;t=n^l;t=nn((yn(a,s,nn(o^i,n^r,o,n)|0,N,0)|0)^e,N^t,e,t)|0;return t|0}function gn(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;var n=0,s=0,a=0,l=0,u=0,h=0;n=c;c=c+8|0;l=n|0;a=e>>31|((e|0)<0?-1:0)<<1;s=((e|0)<0?-1:0)>>31|((e|0)<0?-1:0)<<1;h=r>>31|((r|0)<0?-1:0)<<1;u=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1;e=nn(a^t,s^e,a,s)|0;t=N;yn(e,t,nn(h^i,u^r,h,u)|0,N,l)|0;t=nn(o[l>>2]^a,o[l+4>>2]^s,a,s)|0;e=N;c=n;return(N=e,t)|0}function _n(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;var n=0,o=0;n=t;o=i;t=mn(n,o)|0;i=N;return(N=(nt(e,o)|0)+(nt(r,n)|0)+i|i&0,t|0|0)|0}function vn(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;t=yn(t,e,i,r,0)|0;return t|0}function bn(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;var n=0,s=0;s=c;c=c+8|0;n=s|0;yn(t,e,i,r,n)|0;c=s;return(N=o[n+4>>2]|0,o[n>>2]|0)|0}function yn(t,e,i,r,n){t=t|0;e=e|0;i=i|0;r=r|0;n=n|0;var s=0,a=0,l=0,u=0,h=0,c=0,f=0,d=0,m=0,p=0;a=t;u=e;l=u;c=i;s=r;h=s;if(!l){s=(n|0)!=0;if(!h){if(s){o[n>>2]=(a>>>0)%(c>>>0);o[n+4>>2]=0}h=0;f=(a>>>0)/(c>>>0)>>>0;return(N=h,f)|0}else{if(!s){c=0;f=0;return(N=c,f)|0}o[n>>2]=t|0;o[n+4>>2]=e&0;c=0;f=0;return(N=c,f)|0}}f=(h|0)==0;do{if(c){if(!f){h=(fn(h|0)|0)-(fn(l|0)|0)|0;if(h>>>0<=31){f=h+1|0;c=31-h|0;t=h-31>>31;u=f;e=a>>>(f>>>0)&t|l<<c;t=l>>>(f>>>0)&t;h=0;c=a<<c;break}if(!n){c=0;f=0;return(N=c,f)|0}o[n>>2]=t|0;o[n+4>>2]=u|e&0;c=0;f=0;return(N=c,f)|0}h=c-1|0;if(h&c){c=(fn(c|0)|0)+33-(fn(l|0)|0)|0;p=64-c|0;f=32-c|0;d=f>>31;m=c-32|0;t=m>>31;u=c;e=f-1>>31&l>>>(m>>>0)|(l<<f|a>>>(c>>>0))&t;t=t&l>>>(c>>>0);h=a<<p&d;c=(l<<p|a>>>(m>>>0))&d|a<<f&c-33>>31;break}if(n){o[n>>2]=h&a;o[n+4>>2]=0}if((c|0)==1){m=u|e&0;p=t|0|0;return(N=m,p)|0}else{p=dn(c|0)|0;m=l>>>(p>>>0)|0;p=l<<32-p|a>>>(p>>>0)|0;return(N=m,p)|0}}else{if(f){if(n){o[n>>2]=(l>>>0)%(c>>>0);o[n+4>>2]=0}m=0;p=(l>>>0)/(c>>>0)>>>0;return(N=m,p)|0}if(!a){if(n){o[n>>2]=0;o[n+4>>2]=(l>>>0)%(h>>>0)}m=0;p=(l>>>0)/(h>>>0)>>>0;return(N=m,p)|0}c=h-1|0;if(!(c&h)){if(n){o[n>>2]=t|0;o[n+4>>2]=c&l|e&0}m=0;p=l>>>((dn(h|0)|0)>>>0);return(N=m,p)|0}h=(fn(h|0)|0)-(fn(l|0)|0)|0;if(h>>>0<=30){t=h+1|0;c=31-h|0;u=t;e=l<<c|a>>>(t>>>0);t=l>>>(t>>>0);h=0;c=a<<c;break}if(!n){m=0;p=0;return(N=m,p)|0}o[n>>2]=t|0;o[n+4>>2]=u|e&0;m=0;p=0;return(N=m,p)|0}}while(0);if(!u){s=c;r=0;l=0}else{a=i|0|0;s=s|r&0;r=ln(a,s,-1,-1)|0;i=N;l=0;do{f=c;c=h>>>31|c<<1;h=l|h<<1;f=e<<1|f>>>31|0;d=e>>>31|t<<1|0;nn(r,i,f,d)|0;p=N;m=p>>31|((p|0)<0?-1:0)<<1;l=m&1;e=nn(f,d,m&a,(((p|0)<0?-1:0)>>31|((p|0)<0?-1:0)<<1)&s)|0;t=N;u=u-1|0}while((u|0)!=0);s=c;r=0}a=0;if(n){o[n>>2]=e;o[n+4>>2]=t}m=(h|0)>>>31|(s|a)<<1|(a<<1|h>>>31)&0|r;p=(h<<1|0>>>31)&-2|l;return(N=m,p)|0}function wn(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;return Un[t&1](e|0,i|0,r|0)|0}function En(t,e,i,r,n,o){t=t|0;e=e|0;i=i|0;r=r|0;n=n|0;o=o|0;Kn[t&3](e|0,i|0,r|0,n|0,o|0)}function kn(t,e){t=t|0;e=e|0;Hn[t&31](e|0)}function Sn(t,e,i){t=t|0;e=e|0;i=i|0;Wn[t&3](e|0,i|0)}function Mn(t,e){t=t|0;e=e|0;return zn[t&1](e|0)|0}function An(t){t=t|0;qn[t&3]()}function Tn(t,e,i,r,n,o,s){t=t|0;e=e|0;i=i|0;r=r|0;n=n|0;o=o|0;s=s|0;jn[t&3](e|0,i|0,r|0,n|0,o|0,s|0)}function Cn(t,e,i){t=t|0;e=e|0;i=i|0;return Xn[t&3](e|0,i|0)|0}function xn(t,e,i,r,n){t=t|0;e=e|0;i=i|0;r=r|0;n=n|0;Yn[t&3](e|0,i|0,r|0,n|0)}function Rn(t,e,i){t=t|0;e=e|0;i=i|0;ot(0);return 0}function On(t,e,i,r,n){t=t|0;e=e|0;i=i|0;r=r|0;n=n|0;ot(1)}function Ln(t){t=t|0;ot(2)}function Pn(t,e){t=t|0;e=e|0;ot(3)}function Nn(t){t=t|0;ot(4);return 0}function In(){ot(5)}function Fn(){ne()}function Dn(t,e,i,r,n,o){t=t|0;e=e|0;i=i|0;r=r|0;n=n|0;o=o|0;ot(6)}function Vn(t,e){t=t|0;e=e|0;ot(7);return 0}function Bn(t,e,i,r){t=t|0;e=e|0;i=i|0;r=r|0;ot(8)}var Un=[Rn,kr];var Kn=[On,Rr,xr,On];var Hn=[Ln,ge,ve,ye,ke,Ce,Te,$e,Ze,bi,vi,Ni,cr,hr,vr,wr,br,yr,Er,be,Dr,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln];var Wn=[Pn,Ee,Me,Qe];var zn=[Nn,fr];var qn=[In,Fn,Ir,Fr];var jn=[Dn,Lr,Or,Dn];var Xn=[Vn,we,Se,Je];var Yn=[Bn,Mr,Ar,Bn];return{_yo:Xi,_strlen:an,_retireVar:ir,_bitshift64Lshr:un,_unyo:Yi,_solve:Ji,_bitshift64Shl:sn,_getSolution:Qi,___cxa_is_pointer_type:Nr,_memset:on,_getNumVars:tr,_memcpy:hn,_getConflictClauseSize:rr,_addClause:Zi,_i64Subtract:nn,_createTheSolver:$i,_realloc:Ur,_i64Add:ln,_solveAssuming:er,___cxa_can_catch:Pr,_ensureVar:Gi,_getConflictClause:nr,_free:Br,_malloc:Vr,__GLOBAL__I_a:Ge,__GLOBAL__I_a127:Ii,runPostSets:rn,stackAlloc:ae,stackSave:le,stackRestore:ue,setThrew:he,setTempRet0:de,getTempRet0:me,dynCall_iiii:wn,dynCall_viiiii:En,dynCall_vi:kn,dynCall_vii:Sn,dynCall_ii:Mn,dynCall_v:An,dynCall_viiiiii:Tn,dynCall_iii:Cn,dynCall_viiii:xn}}(Module.asmGlobalArg,Module.asmLibraryArg,buffer),_yo=Module._yo=asm._yo,_strlen=Module._strlen=asm._strlen,_retireVar=Module._retireVar=asm._retireVar,_bitshift64Lshr=Module._bitshift64Lshr=asm._bitshift64Lshr,_unyo=Module._unyo=asm._unyo,_solve=Module._solve=asm._solve,_bitshift64Shl=Module._bitshift64Shl=asm._bitshift64Shl,_getSolution=Module._getSolution=asm._getSolution,___cxa_is_pointer_type=Module.___cxa_is_pointer_type=asm.___cxa_is_pointer_type,_memset=Module._memset=asm._memset,_getNumVars=Module._getNumVars=asm._getNumVars,_memcpy=Module._memcpy=asm._memcpy,_getConflictClauseSize=Module._getConflictClauseSize=asm._getConflictClauseSize,_addClause=Module._addClause=asm._addClause,_i64Subtract=Module._i64Subtract=asm._i64Subtract,_createTheSolver=Module._createTheSolver=asm._createTheSolver,_realloc=Module._realloc=asm._realloc,_i64Add=Module._i64Add=asm._i64Add,_solveAssuming=Module._solveAssuming=asm._solveAssuming,___cxa_can_catch=Module.___cxa_can_catch=asm.___cxa_can_catch,_ensureVar=Module._ensureVar=asm._ensureVar,_getConflictClause=Module._getConflictClause=asm._getConflictClause,_free=Module._free=asm._free,_malloc=Module._malloc=asm._malloc,__GLOBAL__I_a=Module.__GLOBAL__I_a=asm.__GLOBAL__I_a,__GLOBAL__I_a127=Module.__GLOBAL__I_a127=asm.__GLOBAL__I_a127,runPostSets=Module.runPostSets=asm.runPostSets,dynCall_iiii=Module.dynCall_iiii=asm.dynCall_iiii,dynCall_viiiii=Module.dynCall_viiiii=asm.dynCall_viiiii,dynCall_vi=Module.dynCall_vi=asm.dynCall_vi,dynCall_vii=Module.dynCall_vii=asm.dynCall_vii,dynCall_ii=Module.dynCall_ii=asm.dynCall_ii,dynCall_v=Module.dynCall_v=asm.dynCall_v,dynCall_viiiiii=Module.dynCall_viiiiii=asm.dynCall_viiiiii,dynCall_iii=Module.dynCall_iii=asm.dynCall_iii,dynCall_viiii=Module.dynCall_viiii=asm.dynCall_viiii;Runtime.stackAlloc=asm.stackAlloc,Runtime.stackSave=asm.stackSave,Runtime.stackRestore=asm.stackRestore,Runtime.setTempRet0=asm.setTempRet0,Runtime.getTempRet0=asm.getTempRet0;var i64Math=function(){var t={math:{}};t.math.Long=function(t,e){this.low_=0|t,this.high_=0|e},t.math.Long.IntCache_={},t.math.Long.fromInt=function(e){if(-128<=e&&e<128){var i=t.math.Long.IntCache_[e];if(i)return i}var r=new t.math.Long(0|e,e<0?-1:0);return-128<=e&&e<128&&(t.math.Long.IntCache_[e]=r),r},t.math.Long.fromNumber=function(e){return isNaN(e)||!isFinite(e)?t.math.Long.ZERO:e<=-t.math.Long.TWO_PWR_63_DBL_?t.math.Long.MIN_VALUE:e+1>=t.math.Long.TWO_PWR_63_DBL_?t.math.Long.MAX_VALUE:e<0?t.math.Long.fromNumber(-e).negate():new t.math.Long(e%t.math.Long.TWO_PWR_32_DBL_|0,e/t.math.Long.TWO_PWR_32_DBL_|0)},t.math.Long.fromBits=function(e,i){return new t.math.Long(e,i)},t.math.Long.fromString=function(e,i){if(0==e.length)throw Error("number format error: empty string");var r=i||10;if(r<2||36<r)throw Error("radix out of range: "+r);if("-"==e.charAt(0))return t.math.Long.fromString(e.substring(1),r).negate();if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+e);for(var n=t.math.Long.fromNumber(Math.pow(r,8)),o=t.math.Long.ZERO,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+a),r);if(a<8){var u=t.math.Long.fromNumber(Math.pow(r,a));o=o.multiply(u).add(t.math.Long.fromNumber(l))}else o=(o=o.multiply(n)).add(t.math.Long.fromNumber(l))}return o},t.math.Long.TWO_PWR_16_DBL_=65536,t.math.Long.TWO_PWR_24_DBL_=1<<24,t.math.Long.TWO_PWR_32_DBL_=t.math.Long.TWO_PWR_16_DBL_*t.math.Long.TWO_PWR_16_DBL_,t.math.Long.TWO_PWR_31_DBL_=t.math.Long.TWO_PWR_32_DBL_/2,t.math.Long.TWO_PWR_48_DBL_=t.math.Long.TWO_PWR_32_DBL_*t.math.Long.TWO_PWR_16_DBL_,t.math.Long.TWO_PWR_64_DBL_=t.math.Long.TWO_PWR_32_DBL_*t.math.Long.TWO_PWR_32_DBL_,t.math.Long.TWO_PWR_63_DBL_=t.math.Long.TWO_PWR_64_DBL_/2,t.math.Long.ZERO=t.math.Long.fromInt(0),t.math.Long.ONE=t.math.Long.fromInt(1),t.math.Long.NEG_ONE=t.math.Long.fromInt(-1),t.math.Long.MAX_VALUE=t.math.Long.fromBits(-1,2147483647),t.math.Long.MIN_VALUE=t.math.Long.fromBits(0,-2147483648),t.math.Long.TWO_PWR_24_=t.math.Long.fromInt(1<<24),t.math.Long.prototype.toInt=function(){return this.low_},t.math.Long.prototype.toNumber=function(){return this.high_*t.math.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},t.math.Long.prototype.toString=function(e){var i=e||10;if(i<2||36<i)throw Error("radix out of range: "+i);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(t.math.Long.MIN_VALUE)){var r=t.math.Long.fromNumber(i),n=this.div(r),o=n.multiply(r).subtract(this);return n.toString(i)+o.toInt().toString(i)}return"-"+this.negate().toString(i)}for(var s=t.math.Long.fromNumber(Math.pow(i,6)),a=(o=this,"");;){var l=o.div(s),u=o.subtract(l.multiply(s)).toInt().toString(i);if((o=l).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},t.math.Long.prototype.getHighBits=function(){return this.high_},t.math.Long.prototype.getLowBits=function(){return this.low_},t.math.Long.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:t.math.Long.TWO_PWR_32_DBL_+this.low_},t.math.Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(t.math.Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high_?this.high_:this.low_,i=31;i>0&&0==(e&1<<i);i--);return 0!=this.high_?i+33:i+1},t.math.Long.prototype.isZero=function(){return 0==this.high_&&0==this.low_},t.math.Long.prototype.isNegative=function(){return this.high_<0},t.math.Long.prototype.isOdd=function(){return 1==(1&this.low_)},t.math.Long.prototype.equals=function(t){return this.high_==t.high_&&this.low_==t.low_},t.math.Long.prototype.notEquals=function(t){return this.high_!=t.high_||this.low_!=t.low_},t.math.Long.prototype.lessThan=function(t){return this.compare(t)<0},t.math.Long.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},t.math.Long.prototype.greaterThan=function(t){return this.compare(t)>0},t.math.Long.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},t.math.Long.prototype.compare=function(t){if(this.equals(t))return 0;var e=this.isNegative(),i=t.isNegative();return e&&!i?-1:!e&&i?1:this.subtract(t).isNegative()?-1:1},t.math.Long.prototype.negate=function(){return this.equals(t.math.Long.MIN_VALUE)?t.math.Long.MIN_VALUE:this.not().add(t.math.Long.ONE)},t.math.Long.prototype.add=function(e){var i=this.high_>>>16,r=65535&this.high_,n=this.low_>>>16,o=65535&this.low_,s=e.high_>>>16,a=65535&e.high_,l=e.low_>>>16,u=0,h=0,c=0,f=0;return c+=(f+=o+(65535&e.low_))>>>16,f&=65535,h+=(c+=n+l)>>>16,c&=65535,u+=(h+=r+a)>>>16,h&=65535,u+=i+s,u&=65535,t.math.Long.fromBits(c<<16|f,u<<16|h)},t.math.Long.prototype.subtract=function(t){return this.add(t.negate())},t.math.Long.prototype.multiply=function(e){if(this.isZero())return t.math.Long.ZERO;if(e.isZero())return t.math.Long.ZERO;if(this.equals(t.math.Long.MIN_VALUE))return e.isOdd()?t.math.Long.MIN_VALUE:t.math.Long.ZERO;if(e.equals(t.math.Long.MIN_VALUE))return this.isOdd()?t.math.Long.MIN_VALUE:t.math.Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(t.math.Long.TWO_PWR_24_)&&e.lessThan(t.math.Long.TWO_PWR_24_))return t.math.Long.fromNumber(this.toNumber()*e.toNumber());var i=this.high_>>>16,r=65535&this.high_,n=this.low_>>>16,o=65535&this.low_,s=e.high_>>>16,a=65535&e.high_,l=e.low_>>>16,u=65535&e.low_,h=0,c=0,f=0,d=0;return f+=(d+=o*u)>>>16,d&=65535,c+=(f+=n*u)>>>16,f&=65535,c+=(f+=o*l)>>>16,f&=65535,h+=(c+=r*u)>>>16,c&=65535,h+=(c+=n*l)>>>16,c&=65535,h+=(c+=o*a)>>>16,c&=65535,h+=i*u+r*l+n*a+o*s,h&=65535,t.math.Long.fromBits(f<<16|d,h<<16|c)},t.math.Long.prototype.div=function(e){if(e.isZero())throw Error("division by zero");if(this.isZero())return t.math.Long.ZERO;if(this.equals(t.math.Long.MIN_VALUE)){if(e.equals(t.math.Long.ONE)||e.equals(t.math.Long.NEG_ONE))return t.math.Long.MIN_VALUE;if(e.equals(t.math.Long.MIN_VALUE))return t.math.Long.ONE;if((n=this.shiftRight(1).div(e).shiftLeft(1)).equals(t.math.Long.ZERO))return e.isNegative()?t.math.Long.ONE:t.math.Long.NEG_ONE;var i=this.subtract(e.multiply(n));return n.add(i.div(e))}if(e.equals(t.math.Long.MIN_VALUE))return t.math.Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();var r=t.math.Long.ZERO;for(i=this;i.greaterThanOrEqual(e);){for(var n=Math.max(1,Math.floor(i.toNumber()/e.toNumber())),o=Math.ceil(Math.log(n)/Math.LN2),s=o<=48?1:Math.pow(2,o-48),a=t.math.Long.fromNumber(n),l=a.multiply(e);l.isNegative()||l.greaterThan(i);)n-=s,l=(a=t.math.Long.fromNumber(n)).multiply(e);a.isZero()&&(a=t.math.Long.ONE),r=r.add(a),i=i.subtract(l)}return r},t.math.Long.prototype.modulo=function(t){return this.subtract(this.div(t).multiply(t))},t.math.Long.prototype.not=function(){return t.math.Long.fromBits(~this.low_,~this.high_)},t.math.Long.prototype.and=function(e){return t.math.Long.fromBits(this.low_&e.low_,this.high_&e.high_)},t.math.Long.prototype.or=function(e){return t.math.Long.fromBits(this.low_|e.low_,this.high_|e.high_)},t.math.Long.prototype.xor=function(e){return t.math.Long.fromBits(this.low_^e.low_,this.high_^e.high_)},t.math.Long.prototype.shiftLeft=function(e){if(0==(e&=63))return this;var i=this.low_;if(e<32){var r=this.high_;return t.math.Long.fromBits(i<<e,r<<e|i>>>32-e)}return t.math.Long.fromBits(0,i<<e-32)},t.math.Long.prototype.shiftRight=function(e){if(0==(e&=63))return this;var i=this.high_;if(e<32){var r=this.low_;return t.math.Long.fromBits(r>>>e|i<<32-e,i>>e)}return t.math.Long.fromBits(i>>e-32,i>=0?0:-1)},t.math.Long.prototype.shiftRightUnsigned=function(e){if(0==(e&=63))return this;var i=this.high_;if(e<32){var r=this.low_;return t.math.Long.fromBits(r>>>e|i<<32-e,i>>>e)}return 32==e?t.math.Long.fromBits(i,0):t.math.Long.fromBits(i>>>e-32,0)};var e,i="Modern Browser";function r(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function n(){return new r(null)}"Microsoft Internet Explorer"==i?(r.prototype.am=function(t,e,i,r,n,o){for(var s=32767&e,a=e>>15;--o>=0;){var l=32767&this[t],u=this[t++]>>15,h=a*l+u*s;n=((l=s*l+((32767&h)<<15)+i[r]+(1073741823&n))>>>30)+(h>>>15)+a*u+(n>>>30),i[r++]=1073741823&l}return n},e=30):"Netscape"!=i?(r.prototype.am=function(t,e,i,r,n,o){for(;--o>=0;){var s=e*this[t++]+i[r]+n;n=Math.floor(s/67108864),i[r++]=67108863&s}return n},e=26):(r.prototype.am=function(t,e,i,r,n,o){for(var s=16383&e,a=e>>14;--o>=0;){var l=16383&this[t],u=this[t++]>>14,h=a*l+u*s;n=((l=s*l+((16383&h)<<14)+i[r]+n)>>28)+(h>>14)+a*u,i[r++]=268435455&l}return n},e=28),r.prototype.DB=e,r.prototype.DM=(1<<e)-1,r.prototype.DV=1<<e;r.prototype.FV=Math.pow(2,52),r.prototype.F1=52-e,r.prototype.F2=2*e-52;var o,s,a="0123456789abcdefghijklmnopqrstuvwxyz",l=new Array;for(o="0".charCodeAt(0),s=0;s<=9;++s)l[o++]=s;for(o="a".charCodeAt(0),s=10;s<36;++s)l[o++]=s;for(o="A".charCodeAt(0),s=10;s<36;++s)l[o++]=s;function u(t){return a.charAt(t)}function h(t,e){var i=l[t.charCodeAt(e)];return null==i?-1:i}function c(t){var e=n();return e.fromInt(t),e}function f(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function d(t){this.m=t}function m(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}d.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},d.prototype.revert=function(t){return t},d.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},d.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},d.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},m.prototype.convert=function(t){var e=n();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(r.ZERO)>0&&this.m.subTo(e,e),e},m.prototype.revert=function(t){var e=n();return t.copyTo(e),this.reduce(e),e},m.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],r=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[i=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},m.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},m.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},r.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},r.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+DV:this.t=0},r.prototype.fromString=function(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var n=t.length,o=!1,s=0;--n>=0;){var a=8==i?255&t[n]:h(t,n);a<0?"-"==t.charAt(n)&&(o=!0):(o=!1,0==s?this[this.t++]=a:s+i>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=i)>=this.DB&&(s-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&r.ZERO.subTo(this,this)},r.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},r.prototype.dlShiftTo=function(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s},r.prototype.drShiftTo=function(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s},r.prototype.lShiftTo=function(t,e){var i,r=t%this.DB,n=this.DB-r,o=(1<<n)-1,s=Math.floor(t/this.DB),a=this.s<<r&this.DM;for(i=this.t-1;i>=0;--i)e[i+s+1]=this[i]>>n|a,a=(this[i]&o)<<r;for(i=s-1;i>=0;--i)e[i]=0;e[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()},r.prototype.rShiftTo=function(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)e.t=0;else{var r=t%this.DB,n=this.DB-r,o=(1<<r)-1;e[0]=this[i]>>r;for(var s=i+1;s<this.t;++s)e[s-i-1]|=(this[s]&o)<<n,e[s-i]=this[s]>>r;r>0&&(e[this.t-i-1]|=(this.s&o)<<n),e.t=this.t-i,e.clamp()}},r.prototype.subTo=function(t,e){for(var i=0,r=0,n=Math.min(t.t,this.t);i<n;)r+=this[i]-t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r-=t[i],e[i++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[i++]=this.DV+r:r>0&&(e[i++]=r),e.t=i,e.clamp()},r.prototype.multiplyTo=function(t,e){var i=this.abs(),n=t.abs(),o=i.t;for(e.t=o+n.t;--o>=0;)e[o]=0;for(o=0;o<n.t;++o)e[o+i.t]=i.am(0,n[o],e,o,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&r.ZERO.subTo(e,e)},r.prototype.squareTo=function(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var r=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,r,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()},r.prototype.divRemTo=function(t,e,i){var o=t.abs();if(!(o.t<=0)){var s=this.abs();if(s.t<o.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=n());var a=n(),l=this.s,u=t.s,h=this.DB-f(o[o.t-1]);h>0?(o.lShiftTo(h,a),s.lShiftTo(h,i)):(o.copyTo(a),s.copyTo(i));var c=a.t,d=a[c-1];if(0!=d){var m=d*(1<<this.F1)+(c>1?a[c-2]>>this.F2:0),p=this.FV/m,g=(1<<this.F1)/m,_=1<<this.F2,v=i.t,b=v-c,y=null==e?n():e;for(a.dlShiftTo(b,y),i.compareTo(y)>=0&&(i[i.t++]=1,i.subTo(y,i)),r.ONE.dlShiftTo(c,y),y.subTo(a,a);a.t<c;)a[a.t++]=0;for(;--b>=0;){var w=i[--v]==d?this.DM:Math.floor(i[v]*p+(i[v-1]+_)*g);if((i[v]+=a.am(0,w,i,b,0,c))<w)for(a.dlShiftTo(b,y),i.subTo(y,i);i[v]<--w;)i.subTo(y,i)}null!=e&&(i.drShiftTo(c,e),l!=u&&r.ZERO.subTo(e,e)),i.t=c,i.clamp(),h>0&&i.rShiftTo(h,i),l<0&&r.ZERO.subTo(i,i)}}},r.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},r.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},r.prototype.exp=function(t,e){if(t>4294967295||t<1)return r.ONE;var i=n(),o=n(),s=e.convert(this),a=f(t)-1;for(s.copyTo(i);--a>=0;)if(e.sqrTo(i,o),(t&1<<a)>0)e.mulTo(o,s,i);else{var l=i;i=o,o=l}return e.revert(i)},r.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,r=(1<<e)-1,n=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(i=this[s]>>a)>0&&(n=!0,o=u(i));s>=0;)a<e?(i=(this[s]&(1<<a)-1)<<e-a,i|=this[--s]>>(a+=this.DB-e)):(i=this[s]>>(a-=e)&r,a<=0&&(a+=this.DB,--s)),i>0&&(n=!0),n&&(o+=u(i));return n?o:"0"},r.prototype.negate=function(){var t=n();return r.ZERO.subTo(this,t),t},r.prototype.abs=function(){return this.s<0?this.negate():this},r.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(0!=(e=i-t.t))return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0},r.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+f(this[this.t-1]^this.s&this.DM)},r.prototype.mod=function(t){var e=n();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(r.ZERO)>0&&t.subTo(e,e),e},r.prototype.modPowInt=function(t,e){var i;return i=t<256||e.isEven()?new d(e):new m(e),this.exp(t,i)},r.ZERO=c(0),r.ONE=c(1),r.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var i=this.chunkSize(e),n=Math.pow(e,i),o=!1,s=0,a=0,l=0;l<t.length;++l){var u=h(t,l);u<0?"-"==t.charAt(l)&&0==this.signum()&&(o=!0):(a=e*a+u,++s>=i&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),o&&r.ZERO.subTo(this,this)},r.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},r.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},r.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},r.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},r.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),r=c(i),o=n(),s=n(),a="";for(this.divRemTo(r,o,s);o.signum()>0;)a=(i+s.intValue()).toString(t).substr(1)+a,o.divRemTo(r,o,s);return s.intValue().toString(t)+a},r.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},r.prototype.addTo=function(t,e){for(var i=0,r=0,n=Math.min(t.t,this.t);i<n;)r+=this[i]+t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r+=t[i],e[i++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[i++]=r:r<-1&&(e[i++]=this.DV+r),e.t=i,e.clamp()};var p={abs:function(e,i){var r,n=new t.math.Long(e,i);r=n.isNegative()?n.negate():n,HEAP32[tempDoublePtr>>2]=r.low_,HEAP32[tempDoublePtr+4>>2]=r.high_},ensureTemps:function(){p.ensuredTemps||(p.ensuredTemps=!0,p.two32=new r,p.two32.fromString("4294967296",10),p.two64=new r,p.two64.fromString("18446744073709551616",10),p.temp1=new r,p.temp2=new r)},lh2bignum:function(t,e){var i=new r;i.fromString(e.toString(),10);var n=new r;i.multiplyTo(p.two32,n);var o=new r;o.fromString(t.toString(),10);var s=new r;return o.addTo(n,s),s},stringify:function(e,i,n){var o=new t.math.Long(e,i).toString();if(n&&"-"==o[0]){p.ensureTemps();var s=new r;s.fromString(o,10),o=new r,p.two64.addTo(s,o),o=o.toString(10)}return o},fromString:function(e,i,n,o,s){p.ensureTemps();var a=new r;a.fromString(e,i);var l=new r;l.fromString(n,10);var u=new r;if(u.fromString(o,10),s&&a.compareTo(r.ZERO)<0){var h=new r;a.addTo(p.two64,h),a=h}var c=!1;a.compareTo(l)<0?(a=l,c=!0):a.compareTo(u)>0&&(a=u,c=!0);var f=t.math.Long.fromString(a.toString());if(HEAP32[tempDoublePtr>>2]=f.low_,HEAP32[tempDoublePtr+4>>2]=f.high_,c)throw"range error"}};return p}(),initialStackTop;if(memoryInitializer)if("function"==typeof Module.locateFile?memoryInitializer=Module.locateFile(memoryInitializer):Module.memoryInitializerPrefixURL&&(memoryInitializer=Module.memoryInitializerPrefixURL+memoryInitializer),ENVIRONMENT_IS_NODE||ENVIRONMENT_IS_SHELL){var data=Module.readBinary(memoryInitializer);HEAPU8.set(data,STATIC_BASE)}else addRunDependency("memory initializer"),Browser.asyncLoad(memoryInitializer,(function(t){HEAPU8.set(t,STATIC_BASE),removeRunDependency("memory initializer")}),(function(t){throw"could not load memory initializer "+memoryInitializer}));function ExitStatus(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}ExitStatus.prototype=new Error,ExitStatus.prototype.constructor=ExitStatus;var preloadStartTime=null,calledMain=!1;function run(t){function e(){Module.calledRun||(Module.calledRun=!0,ABORT||(ensureInitRuntime(),preMain(),ENVIRONMENT_IS_WEB&&null!==preloadStartTime&&Module.printErr("pre-main prep time: "+(Date.now()-preloadStartTime)+" ms"),Module._main&&shouldRunNow&&Module.callMain(t),postRun()))}t=t||Module.arguments,null===preloadStartTime&&(preloadStartTime=Date.now()),runDependencies>0||(preRun(),runDependencies>0||Module.calledRun||(Module.setStatus?(Module.setStatus("Running..."),setTimeout((function(){setTimeout((function(){Module.setStatus("")}),1),e()}),1)):e()))}function exit(t){if(!Module.noExitRuntime)throw ABORT=!0,EXITSTATUS=t,STACKTOP=initialStackTop,exitRuntime(),ENVIRONMENT_IS_NODE?(process.stdout.once("drain",(function(){process.exit(t)})),console.log(" "),setTimeout((function(){process.exit(t)}),500)):ENVIRONMENT_IS_SHELL&&"function"==typeof quit&&quit(t),new ExitStatus(t)}function abort(t){t&&(Module.print(t),Module.printErr(t)),ABORT=!0,EXITSTATUS=1;throw"abort() at "+stackTrace()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information."}if(dependenciesFulfilled=function t(){!Module.calledRun&&shouldRunNow&&run(),Module.calledRun||(dependenciesFulfilled=t)},Module.callMain=Module.callMain=function(t){assert(0==runDependencies,"cannot call main when async dependencies remain! (listen on __ATMAIN__)"),assert(0==__ATPRERUN__.length,"cannot call main when preRun functions remain to be called"),t=t||[],ensureInitRuntime();var e=t.length+1;function i(){for(var t=0;t<3;t++)r.push(0)}var r=[allocate(intArrayFromString(Module.thisProgram),"i8",ALLOC_NORMAL)];i();for(var n=0;n<e-1;n+=1)r.push(allocate(intArrayFromString(t[n]),"i8",ALLOC_NORMAL)),i();r.push(0),r=allocate(r,"i32",ALLOC_NORMAL),initialStackTop=STACKTOP;try{exit(Module._main(e,r,0))}catch(t){if(t instanceof ExitStatus)return;if("SimulateInfiniteLoop"==t)return void(Module.noExitRuntime=!0);throw t&&"object"==typeof t&&t.stack&&Module.printErr("exception thrown: "+[t,t.stack]),t}finally{calledMain=!0}},Module.run=Module.run=run,Module.exit=Module.exit=exit,Module.abort=Module.abort=abort,Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();var shouldRunNow=!0;Module.noInitialRun&&(shouldRunNow=!1),run();var origMalloc=Module._malloc,origFree=Module._free,MEMSTATS={totalMemory:Module.HEAPU8.length,heapUsed:0},MEMSTATS_DATA={pointerToSizeMap:{},getSizeOfPointer:function(t){return MEMSTATS_DATA.pointerToSizeMap[t]}};Module.MEMSTATS=MEMSTATS,Module.MEMSTATS_DATA=MEMSTATS_DATA;var hookedMalloc=function(t){var e=origMalloc(t);return e?(MEMSTATS.heapUsed+=t,MEMSTATS_DATA.pointerToSizeMap[e]=t,e):0},hookedFree=function(t){return t&&(MEMSTATS.heapUsed-=MEMSTATS_DATA.getSizeOfPointer(t)||0,delete MEMSTATS_DATA.pointerToSizeMap[t]),origFree(t)},setInnerMalloc,setInnerFree;return Module._malloc=hookedMalloc,Module._free=hookedFree,_malloc=hookedMalloc,_free=hookedFree,setInnerMalloc&&(setInnerMalloc(hookedMalloc),setInnerFree(hookedFree)),module.exports},module.exports=C_MINISAT}).call(this,"/")},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";i.r(e);var r={};i.r(r),i.d(r,"TYPE_TEXT",(function(){return I})),i.d(r,"TYPE_NEWLINE",(function(){return F})),i.d(r,"TYPE_FG",(function(){return D})),i.d(r,"TYPE_BG",(function(){return V})),i.d(r,"measure",(function(){return B})),i.d(r,"tokenize",(function(){return U}));class n{constructor(){this.data=new Set}size(){return this.data.size}insert(t,e){this.data.add(t)}clear(){this.data.clear()}get(t){return this.data.has(t)?{}:void 0}remove(t){return this.data.delete(t)?{}:void 0}has(t){return this.data.has(t)}foreach(t){this.data.forEach(e=>t(e,{}))}first(){return this.data.keys().next().value}}class o{constructor(){this.datum=void 0,this.value=void 0}size(){return void 0!==this.datum?1:0}insert(t,e){this.datum=t,this.value=e}clear(){this.datum=void 0}get(t){return this.datum===t?this.value:void 0}remove(t){if(this.datum===t)return this.datum=void 0,this.value}has(t){return this.datum===t}foreach(t){void 0!==this.datum&&t(this.datum,this.value)}first(){return this.datum}}class s{constructor(){this.data=new Map}size(){return this.data.size}insert(t,e){this.data.set(t,e)}clear(){this.data.clear()}get(t){return this.data.get(t)}remove(t){const e=this.get(t);return this.data.delete(t),e}has(t){return this.data.has(t)}foreach(t){this.data.forEach((e,i)=>t(i,e))}first(){return this.data.keys().next().value}}class a{constructor(){this.data=[],this.count=0}size(){return this.count}insert(t,e){void 0===this.data[t]&&this.count++,this.data[t]=e}clear(){this.data=[]}get(t){return this.data[t]}remove(t){void 0!==this.data[t]&&this.count--;const e=this.get(t);return this.data[t]=void 0,e}has(t){return void 0!==this.data[t]}foreach(t){for(let e=0;e<this.data.length;e++){const i=this.data[e];void 0!==i&&t(e,i)}}first(){for(let t=0;t<this.data.length;t++){if(void 0!==this.data[t])return t}}}class l{constructor(t){this.queries=t,this.components=["fov","position"]}update(t,e){const i=t.getComponent(e,"fov"),r=t.getComponent(e,"position");i.fov=[],this.queries.fov(t,r.level,r.position,(t,e)=>i.fov.push({position:t,distance:e}))}}class u{constructor(){this.components=["free-mode-anchor","position"]}update(t,e){const i=t.getComponent(e,"position"),r=t.getResource("input").createMovementDelta();if(r.squaredLength()>0){const n=i.position.add(r);t.editEntity(e).withComponent("position",{level:i.level,position:n})}}}function h(t,e,i,r,n){const o=t.createEntity().withComponent("light",{color:n}).withComponent("position",{level:i,position:r}).withComponent("active",{}).entity;e.levels[i].addLight(r,o)}function c(t,e){return t.getComponent(e,"lighting")||{incomingLight:new Map,incomingLightInFrame:new Map}}class f{constructor(t){this.queries=t,this.components=["active","light","position"]}update(t,e){const i=t.getComponent(e,"light"),r=t.getComponent(e,"position"),n=t.getResource("map").levels[r.level];this.queries.lighting(t,r.level,r.position,i.color,(i,r)=>{const o=n.getTile(i);void 0!==o&&this.addLight(t,o,e,r);const s=n.getCharacter(i);void 0!==s&&this.addLight(t,s,e,r)})}addLight(t,e,i,r){const n=c(t,e);n.incomingLightInFrame.set(i,r),t.editEntity(e).withComponent("lighting",n)}}function d(t){return t.components.get("wait-turn").size()+t.components.get("start-turn").size()+t.components.get("take-turn").size()+t.components.get("took-turn").size()}class m{contains(t){return t.all(t=>this.containsVector(t))}equals(t){return this.contains(t)&&t.contains(this)}foreach(t){let e=0;this.all(i=>(t(i,e),e++,!0))}some(t){return!this.all(e=>!t(e))}}class p{constructor(t){this.width=t,this.objects=new Array(t*t)}get(t){return this.objects[t.index(this.width)]}set(t,e){this.objects[t.index(this.width)]=e}setAll(t,e){t.foreach(t=>this.set(t,e))}remove(t){const e=t.index(this.width),i=this.objects[e];return delete this.objects[e],i}}class g{constructor(t){this.width=t,this.objects=new Array(t*t)}get(t){return this.objects[t.index(this.width)]||[]}set(t,e){this.objects[t.index(this.width)]=e}add(t,e){const i=t.index(this.width);let r=this.objects[i];void 0===r&&(r=[],this.objects[i]=r),r.push(e)}addAll(t,e){t.foreach(t=>this.add(t,e))}retain(t,e){const i=t.index(this.width),r=this.objects[i];void 0!==r&&(this.objects[i]=r.filter(t=>e(t)))}}class _{static fromDirection(t){switch(t){case"up":return new _([0,-1]);case"right":return new _([1,0]);case"down":return new _([0,1]);case"left":return new _([-1,0])}}static interpolate(t,e,i){return t.add(e.minus(t).mult(i))}constructor(t){this.coordinates=t}get key(){return this.coordinates.join(",")}index(t){return Math.floor(this.x)%t+Math.floor(this.y)*t}get center(){return this.add(new _([.5,.25]))}get x(){return this.coordinates[0]}get fX(){return Math.floor(this.coordinates[0])}get y(){return this.coordinates[1]}get fY(){return Math.floor(this.coordinates[1])}equals(t){return this.x===t.x&&this.y===t.y}add(t){return new _([this.x+t.x,this.y+t.y])}minus(t){return new _([this.x-t.x,this.y-t.y])}mult(t){return new _([this.x*t,this.y*t])}abs(){return new _([Math.abs(this.x),Math.abs(this.y)])}bounds(t){return Math.abs(t.x)<Math.abs(this.x)&&Math.abs(t.y)<Math.abs(this.y)}perpendicular(){return new _([-this.y,this.x])}squaredLength(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.squaredLength())}l1(){return Math.abs(this.x)+Math.abs(this.y)}lN(){return Math.max(Math.abs(this.x),Math.abs(this.y))}normalize(){return this.mult(1/this.length())}isNan(){return Number.isNaN(this.x)||Number.isNaN(this.y)}}class v extends m{constructor(t,e,i,r){super(),this.x=t,this.y=e,this.width=i,this.height=r}static fromBounds(t,e,i,r){return new v(t,i,e-t+1,r-i+1)}static footprint(t,e,i){const r=_.fromDirection(e).abs(),n=_.fromDirection(e).perpendicular().abs(),o=Math.floor(i.x/2),s=Math.floor(i.y/2),a=t.add(n.mult(-o)).add(r.mult(-s)),l=a.add(n.mult(i.x-1)).add(r.mult(i.y-1));return v.fromBounds(a.x,l.x,a.y,l.y)}static centerAt(t,e,i){return new v(t-i,e-i,2*i+1,2*i+1)}get left(){return this.x}get right(){return this.x+this.width-1}get top(){return this.y}get bottom(){return this.y+this.height-1}get topLeft(){return new _([this.left,this.top])}get topRight(){return new _([this.right,this.top])}get bottomRight(){return new _([this.right,this.bottom])}get bottomLeft(){return new _([this.left,this.bottom])}get center(){const t=(this.left+this.right)/2,e=(this.top+this.bottom)/2;return new _([Math.floor(t),Math.floor(e)])}centerOf(t){switch(t){case"up":return this.centerTop;case"right":return this.centerRight;case"down":return this.centerBottom;case"left":return this.centerLeft}}get centerLeft(){const t=(this.top+this.bottom)/2;return new _([this.left,Math.floor(t)])}get centerRight(){const t=(this.top+this.bottom)/2;return new _([this.right,Math.floor(t)])}get centerTop(){const t=(this.left+this.right)/2;return new _([Math.floor(t),this.top])}get centerBottom(){const t=(this.left+this.right)/2;return new _([Math.floor(t),this.bottom])}plus(t){return v.fromBounds(Math.min(this.left,t.left),Math.max(this.right,t.right),Math.min(this.top,t.top),Math.max(this.bottom,t.bottom))}intersect(t){return v.fromBounds(Math.max(this.left,t.left),Math.min(this.right,t.right),Math.max(this.top,t.top),Math.min(this.bottom,t.bottom))}cover(t){return v.fromBounds(Math.min(this.left,t.x),Math.max(this.right,t.x),Math.min(this.top,t.y),Math.max(this.bottom,t.y))}bounds(){return this}containsVector(t){return t.x>=this.x&&t.x<this.x+this.width&&t.y>=this.y&&t.y<this.y+this.height}translate(t){return new v(this.x+t.x,this.y+t.y,this.width,this.height)}grow(t=1){return new v(this.x-t,this.y-t,this.width+2*t,this.height+2*t)}shrink(t=1){const e=this.width-2*t,i=this.height-2*t;return new v(e>0?this.x+t:this.x,i>0?this.y+t:this.y,e>0?e:0,i>0?i:0)}all(t){for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){if(!t(new _([i+this.x,e+this.y])))return!1}return!0}}var b=i(0),y=i(4);class w extends y.a{constructor(){super(),this._ctx=document.createElement("canvas").getContext("2d")}schedule(t){requestAnimationFrame(t)}getContainer(){return this._ctx.canvas}setOptions(t){super.setOptions(t);const e=`${t.fontStyle?`${t.fontStyle} `:""} ${t.fontSize}px ${t.fontFamily}`;this._ctx.font=e,this._updateSize(),this._ctx.font=e,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}clear(){this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}eventToPosition(t,e){let i=this._ctx.canvas,r=i.getBoundingClientRect();return t-=r.left,e-=r.top,t*=i.width/r.width,e*=i.height/r.height,t<0||e<0||t>=i.width||e>=i.height?[-1,-1]:this._normalizedEventToPosition(t,e)}}var E=i(1);class k extends w{constructor(){super(),this._spacingX=0,this._spacingY=0,this._hexSize=0}draw(t,e){let[i,r,n,o,s]=t,a=[(i+1)*this._spacingX,r*this._spacingY+this._hexSize];if(this._options.transpose&&a.reverse(),e&&(this._ctx.fillStyle=s,this._fill(a[0],a[1])),!n)return;this._ctx.fillStyle=o;let l=[].concat(n);for(let t=0;t<l.length;t++)this._ctx.fillText(l[t],a[0],Math.ceil(a[1]))}computeSize(t,e){return this._options.transpose&&(t+=e,t-=e=t-e),[Math.floor(t/this._spacingX)-1,Math.floor((e-2*this._hexSize)/this._spacingY+1)]}computeFontSize(t,e){this._options.transpose&&(t+=e,t-=e=t-e);let i=2*t/((this._options.width+1)*Math.sqrt(3))-1,r=e/(2+1.5*(this._options.height-1)),n=Math.min(i,r),o=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let s=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=o;let a=s/100,l=2*(n=Math.floor(n)+1)/(this._options.spacing*(1+a/Math.sqrt(3)));return Math.ceil(l)-1}_normalizedEventToPosition(t,e){let i;this._options.transpose?(t+=e,t-=e=t-e,i=this._ctx.canvas.width):i=this._ctx.canvas.height;let r=i/this._options.height;return e=Math.floor(e/r),Object(E.mod)(e,2)?(t-=this._spacingX,t=1+2*Math.floor(t/(2*this._spacingX))):t=2*Math.floor(t/(2*this._spacingX)),[t,e]}_fill(t,e){let i=this._hexSize,r=this._options.border;const n=this._ctx;n.beginPath(),this._options.transpose?(n.moveTo(t-i+r,e),n.lineTo(t-i/2+r,e+this._spacingX-r),n.lineTo(t+i/2-r,e+this._spacingX-r),n.lineTo(t+i-r,e),n.lineTo(t+i/2-r,e-this._spacingX+r),n.lineTo(t-i/2+r,e-this._spacingX+r),n.lineTo(t-i+r,e)):(n.moveTo(t,e-i+r),n.lineTo(t+this._spacingX-r,e-i/2+r),n.lineTo(t+this._spacingX-r,e+i/2-r),n.lineTo(t,e+i-r),n.lineTo(t-this._spacingX+r,e+i/2-r),n.lineTo(t-this._spacingX+r,e-i/2+r),n.lineTo(t,e-i+r)),n.fill()}_updateSize(){const t=this._options,e=Math.ceil(this._ctx.measureText("W").width);let i,r;this._hexSize=Math.floor(t.spacing*(t.fontSize+e/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,t.transpose?(i="height",r="width"):(i="width",r="height"),this._ctx.canvas[i]=Math.ceil((t.width+1)*this._spacingX),this._ctx.canvas[r]=Math.ceil((t.height-1)*this._spacingY+2*this._hexSize)}}class S extends w{constructor(){super(),this._spacingX=0,this._spacingY=0,this._canvasCache={}}setOptions(t){super.setOptions(t),this._canvasCache={}}draw(t,e){S.cache?this._drawWithCache(t):this._drawNoCache(t,e)}_drawWithCache(t){let e,[i,r,n,o,s]=t,a=""+n+o+s;if(a in this._canvasCache)e=this._canvasCache[a];else{let t=this._options.border,i=(e=document.createElement("canvas")).getContext("2d");if(e.width=this._spacingX,e.height=this._spacingY,i.fillStyle=s,i.fillRect(t,t,e.width-t,e.height-t),n){i.fillStyle=o,i.font=this._ctx.font,i.textAlign="center",i.textBaseline="middle";let t=[].concat(n);for(let e=0;e<t.length;e++)i.fillText(t[e],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[a]=e}this._ctx.drawImage(e,i*this._spacingX,r*this._spacingY)}_drawNoCache(t,e){let[i,r,n,o,s]=t;if(e){let t=this._options.border;this._ctx.fillStyle=s,this._ctx.fillRect(i*this._spacingX+t,r*this._spacingY+t,this._spacingX-t,this._spacingY-t)}if(!n)return;this._ctx.fillStyle=o;let a=[].concat(n);for(let t=0;t<a.length;t++)this._ctx.fillText(a[t],(i+.5)*this._spacingX,Math.ceil((r+.5)*this._spacingY))}computeSize(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}computeFontSize(t,e){let i=Math.floor(t/this._options.width),r=Math.floor(e/this._options.height),n=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let o=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=n;let s=o/100*r/i;return s>1&&(r=Math.floor(r/s)),Math.floor(r/this._options.spacing)}_normalizedEventToPosition(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}_updateSize(){const t=this._options,e=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(t.spacing*e),this._spacingY=Math.ceil(t.spacing*t.fontSize),t.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=t.width*this._spacingX,this._ctx.canvas.height=t.height*this._spacingY}}S.cache=!1;class M extends w{constructor(){super(),this._colorCanvas=document.createElement("canvas")}draw(t,e){let[i,r,n,o,s]=t,a=this._options.tileWidth,l=this._options.tileHeight;if(e&&(this._options.tileColorize?this._ctx.clearRect(i*a,r*l,a,l):(this._ctx.fillStyle=s,this._ctx.fillRect(i*a,r*l,a,l))),!n)return;let u=[].concat(n),h=[].concat(o),c=[].concat(s);for(let t=0;t<u.length;t++){let e=this._options.tileMap[u[t]];if(!e)throw new Error(`Char "${u[t]}" not found in tileMap`);if(this._options.tileColorize){let n=this._colorCanvas,o=n.getContext("2d");o.globalCompositeOperation="source-over",o.clearRect(0,0,a,l);let s=h[t],u=c[t];o.drawImage(this._options.tileSet,e[0],e[1],a,l,0,0,a,l),"transparent"!=s&&(o.fillStyle=s,o.globalCompositeOperation="source-atop",o.fillRect(0,0,a,l)),"transparent"!=u&&(o.fillStyle=u,o.globalCompositeOperation="destination-over",o.fillRect(0,0,a,l)),this._ctx.drawImage(n,i*a,r*l,a,l)}else this._ctx.drawImage(this._options.tileSet,e[0],e[1],a,l,i*a,r*l,a,l)}}computeSize(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}_normalizedEventToPosition(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}_updateSize(){const t=this._options;this._ctx.canvas.width=t.width*t.tileWidth,this._ctx.canvas.height=t.height*t.tileHeight,this._colorCanvas.width=t.tileWidth,this._colorCanvas.height=t.tileHeight}}var A=i(3);class T extends y.a{static isSupported(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}constructor(){super(),this._uniforms={};try{this._gl=this._initWebGL()}catch(t){alert(t.message)}}schedule(t){requestAnimationFrame(t)}getContainer(){return this._gl.canvas}setOptions(t){super.setOptions(t),this._updateSize();let e=this._options.tileSet;e&&"complete"in e&&!e.complete?e.addEventListener("load",()=>this._updateTexture(e)):this._updateTexture(e)}draw(t,e){const i=this._gl,r=this._options;let[n,o,s,a,l]=t,u=i.canvas.height-(o+1)*r.tileHeight;if(i.scissor(n*r.tileWidth,u,r.tileWidth,r.tileHeight),e&&(r.tileColorize?i.clearColor(0,0,0,0):i.clearColor(...L(l)),i.clear(i.COLOR_BUFFER_BIT)),!s)return;let h=[].concat(s),c=[].concat(l),f=[].concat(a);i.uniform2fv(this._uniforms.targetPosRel,[n,o]);for(let t=0;t<h.length;t++){let e=this._options.tileMap[h[t]];if(!e)throw new Error(`Char "${h[t]}" not found in tileMap`);i.uniform1f(this._uniforms.colorize,r.tileColorize?1:0),i.uniform2fv(this._uniforms.tilesetPosAbs,e),r.tileColorize&&(i.uniform4fv(this._uniforms.tint,L(f[t])),i.uniform4fv(this._uniforms.bg,L(c[t]))),i.drawArrays(i.TRIANGLE_STRIP,0,4)}}clear(){const t=this._gl;t.clearColor(...L(this._options.bg)),t.scissor(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT)}computeSize(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}eventToPosition(t,e){let i=this._gl.canvas,r=i.getBoundingClientRect();return t-=r.left,e-=r.top,t*=i.width/r.width,e*=i.height/r.height,t<0||e<0||t>=i.width||e>=i.height?[-1,-1]:this._normalizedEventToPosition(t,e)}_initWebGL(){let t=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=t;let e=function(t,e,i){const r=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(r)||"");const n=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,i),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n)||"");const o=t.createProgram();if(t.attachShader(o,r),t.attachShader(o,n),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(o)||"");return o}(t,x,R);return t.useProgram(e),function(t){const e=new Float32Array([0,0,1,0,0,1,1,1]),i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0)}(t),C.forEach(i=>this._uniforms[i]=t.getUniformLocation(e,i)),this._program=e,t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),t.enable(t.SCISSOR_TEST),t}_normalizedEventToPosition(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}_updateSize(){const t=this._gl,e=this._options,i=[e.width*e.tileWidth,e.height*e.tileHeight];t.canvas.width=i[0],t.canvas.height=i[1],t.viewport(0,0,i[0],i[1]),t.uniform2fv(this._uniforms.tileSize,[e.tileWidth,e.tileHeight]),t.uniform2fv(this._uniforms.targetSize,i)}_updateTexture(t){!function(t,e){let i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}(this._gl,t)}}const C=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],x="\n#version 300 es\n\nin vec2 tilePosRel;\nout vec2 tilesetPosPx;\n\nuniform vec2 tilesetPosAbs;\nuniform vec2 tileSize;\nuniform vec2 targetSize;\nuniform vec2 targetPosRel;\n\nvoid main() {\n\tvec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;\n\tvec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;\n\ttargetPosNdc.y *= -1.0;\n\n\tgl_Position = vec4(targetPosNdc, 0.0, 1.0);\n\ttilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;\n}".trim(),R="\n#version 300 es\nprecision highp float;\n\nin vec2 tilesetPosPx;\nout vec4 fragColor;\nuniform sampler2D image;\nuniform bool colorize;\nuniform vec4 bg;\nuniform vec4 tint;\n\nvoid main() {\n\tfragColor = vec4(0, 0, 0, 1);\n\n\tvec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);\n\n\tif (colorize) {\n\t\ttexel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;\n\t\tfragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;\n\t\tfragColor.a = texel.a + (1.0-texel.a)*bg.a;\n\t} else {\n\t\tfragColor = texel;\n\t}\n}".trim();let O={};function L(t){if(!(t in O)){let e;if("transparent"==t)e=[0,0,0,0];else if(t.indexOf("rgba")>-1){e=(t.match(/[\d.]+/g)||[]).map(Number);for(let t=0;t<3;t++)e[t]=e[t]/255}else(e=A.fromString(t).map(t=>t/255)).push(1);O[t]=e}return O[t]}var P=i(5);const N=/%([bc]){([^}]*)}/g,I=0,F=1,D=2,V=3;function B(t,e){let i={width:0,height:1},r=U(t,e),n=0;for(let t=0;t<r.length;t++){let e=r[t];switch(e.type){case I:n+=e.value.length;break;case F:i.height++,i.width=Math.max(i.width,n),n=0}}return i.width=Math.max(i.width,n),i}function U(t,e){let i=[],r=0;t.replace(N,(function(e,n,o,s){let a=t.substring(r,s);return a.length&&i.push({type:I,value:a}),i.push({type:"c"==n?D:V,value:o.trim()}),r=s+e.length,""}));let n=t.substring(r);return n.length&&i.push({type:I,value:n}),function(t,e){e||(e=1/0);let i=0,r=0,n=-1;for(;i<t.length;){let o=t[i];if(o.type==F&&(r=0,n=-1),o.type!=I){i++;continue}for(;0==r&&" "==o.value.charAt(0);)o.value=o.value.substring(1);let s=o.value.indexOf("\n");if(-1!=s){o.value=K(t,i,s,!0);let e=o.value.split("");for(;e.length&&" "==e[e.length-1];)e.pop();o.value=e.join("")}if(o.value.length){if(r+o.value.length>e){let s=-1;for(;;){let t=o.value.indexOf(" ",s+1);if(-1==t)break;if(r+t>e)break;s=t}if(-1!=s)o.value=K(t,i,s,!0);else if(-1!=n){let e=t[n],r=e.value.lastIndexOf(" ");e.value=K(t,n,r,!0),i=n}else o.value=K(t,i,e-r,!1)}else r+=o.value.length,-1!=o.value.indexOf(" ")&&(n=i);i++}else t.splice(i,1)}t.push({type:F});let o=null;for(let e=0;e<t.length;e++){let i=t[e];switch(i.type){case I:o=i;break;case F:if(o){let t=o.value.split("");for(;t.length&&" "==t[t.length-1];)t.pop();o.value=t.join("")}o=null}}return t.pop(),t}(i,e)}function K(t,e,i,r){let n={type:F},o={type:I,value:t[e].value.substring(i+(r?1:0))};return t.splice(e+1,0,n,o),t[e].value.substring(0,i)}let H=80,W=25;const z={4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},q={VK_CANCEL:3,VK_HELP:6,VK_BACK_SPACE:8,VK_TAB:9,VK_CLEAR:12,VK_RETURN:13,VK_ENTER:14,VK_SHIFT:16,VK_CONTROL:17,VK_ALT:18,VK_PAUSE:19,VK_CAPS_LOCK:20,VK_ESCAPE:27,VK_SPACE:32,VK_PAGE_UP:33,VK_PAGE_DOWN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40,VK_PRINTSCREEN:44,VK_INSERT:45,VK_DELETE:46,VK_0:48,VK_1:49,VK_2:50,VK_3:51,VK_4:52,VK_5:53,VK_6:54,VK_7:55,VK_8:56,VK_9:57,VK_COLON:58,VK_SEMICOLON:59,VK_LESS_THAN:60,VK_EQUALS:61,VK_GREATER_THAN:62,VK_QUESTION_MARK:63,VK_AT:64,VK_A:65,VK_B:66,VK_C:67,VK_D:68,VK_E:69,VK_F:70,VK_G:71,VK_H:72,VK_I:73,VK_J:74,VK_K:75,VK_L:76,VK_M:77,VK_N:78,VK_O:79,VK_P:80,VK_Q:81,VK_R:82,VK_S:83,VK_T:84,VK_U:85,VK_V:86,VK_W:87,VK_X:88,VK_Y:89,VK_Z:90,VK_CONTEXT_MENU:93,VK_NUMPAD0:96,VK_NUMPAD1:97,VK_NUMPAD2:98,VK_NUMPAD3:99,VK_NUMPAD4:100,VK_NUMPAD5:101,VK_NUMPAD6:102,VK_NUMPAD7:103,VK_NUMPAD8:104,VK_NUMPAD9:105,VK_MULTIPLY:106,VK_ADD:107,VK_SEPARATOR:108,VK_SUBTRACT:109,VK_DECIMAL:110,VK_DIVIDE:111,VK_F1:112,VK_F2:113,VK_F3:114,VK_F4:115,VK_F5:116,VK_F6:117,VK_F7:118,VK_F8:119,VK_F9:120,VK_F10:121,VK_F11:122,VK_F12:123,VK_F13:124,VK_F14:125,VK_F15:126,VK_F16:127,VK_F17:128,VK_F18:129,VK_F19:130,VK_F20:131,VK_F21:132,VK_F22:133,VK_F23:134,VK_F24:135,VK_NUM_LOCK:144,VK_SCROLL_LOCK:145,VK_CIRCUMFLEX:160,VK_EXCLAMATION:161,VK_DOUBLE_QUOTE:162,VK_HASH:163,VK_DOLLAR:164,VK_PERCENT:165,VK_AMPERSAND:166,VK_UNDERSCORE:167,VK_OPEN_PAREN:168,VK_CLOSE_PAREN:169,VK_ASTERISK:170,VK_PLUS:171,VK_PIPE:172,VK_HYPHEN_MINUS:173,VK_OPEN_CURLY_BRACKET:174,VK_CLOSE_CURLY_BRACKET:175,VK_TILDE:176,VK_COMMA:188,VK_PERIOD:190,VK_SLASH:191,VK_BACK_QUOTE:192,VK_OPEN_BRACKET:219,VK_BACK_SLASH:220,VK_CLOSE_BRACKET:221,VK_QUOTE:222,VK_META:224,VK_ALTGR:225,VK_WIN:91,VK_KANA:21,VK_HANGUL:21,VK_EISU:22,VK_JUNJA:23,VK_FINAL:24,VK_HANJA:25,VK_KANJI:25,VK_CONVERT:28,VK_NONCONVERT:29,VK_ACCEPT:30,VK_MODECHANGE:31,VK_SELECT:41,VK_PRINT:42,VK_EXECUTE:43,VK_SLEEP:95},j={hex:k,rect:S,tile:M,"tile-gl":T,term:P.a},X={width:H,height:W,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};class Y{constructor(t={}){this._data={},this._dirty=!1,this._options={},t=Object.assign({},X,t),this.setOptions(t),this.DEBUG=this.DEBUG.bind(this),this._tick=this._tick.bind(this),this._backend.schedule(this._tick)}DEBUG(t,e,i){let r=[this._options.bg,this._options.fg];this.draw(t,e,null,null,r[i%r.length])}clear(){this._data={},this._dirty=!0}setOptions(t){if(Object.assign(this._options,t),t.width||t.height||t.fontSize||t.fontFamily||t.spacing||t.layout){if(t.layout){let e=j[t.layout];this._backend=new e}this._backend.setOptions(this._options),this._dirty=!0}return this}getOptions(){return this._options}getContainer(){return this._backend.getContainer()}computeSize(t,e){return this._backend.computeSize(t,e)}computeFontSize(t,e){return this._backend.computeFontSize(t,e)}computeTileSize(t,e){return[Math.floor(t/this._options.width),Math.floor(e/this._options.height)]}eventToPosition(t){let e,i;return"touches"in t?(e=t.touches[0].clientX,i=t.touches[0].clientY):(e=t.clientX,i=t.clientY),this._backend.eventToPosition(e,i)}draw(t,e,i,r,n){r||(r=this._options.fg),n||(n=this._options.bg);let o=`${t},${e}`;this._data[o]=[t,e,i,r,n],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[o]=!0)}drawText(t,e,i,r){let n=null,o=null,s=t,a=e,l=1;r||(r=this._options.width-t);let u=U(i,r);for(;u.length;){let e=u.shift();switch(e.type){case I:let i=!1,r=!1,u=!1,h=!1;for(let t=0;t<e.value.length;t++){let l=e.value.charCodeAt(t),c=e.value.charAt(t);u=l>65280&&l<65377||l>65500&&l<65512||l>65518,i=32==c.charCodeAt(0)||12288==c.charCodeAt(0),!h||u||i||s++,u&&!r&&s++,this.draw(s++,a,c,n,o),r=i,h=u}break;case D:n=e.value||null;break;case V:o=e.value||null;break;case F:s=t,a++,l++}}return l}_tick(){if(this._backend.schedule(this._tick),this._dirty){if(!0===this._dirty){this._backend.clear();for(let t in this._data)this._draw(t,!1)}else for(let t in this._dirty)this._draw(t,!0);this._dirty=!1}}_draw(t,e){let i=this._data[t];i[4]!=this._options.bg&&(e=!0),this._backend.draw(i,e)}}Y.Rect=S,Y.Hex=k,Y.Tile=M,Y.TileGL=T,Y.Term=P.a;class ${constructor(){this._time=0,this._events=[],this._eventTimes=[]}getTime(){return this._time}clear(){return this._events=[],this._eventTimes=[],this}add(t,e){let i=this._events.length;for(let t=0;t<this._eventTimes.length;t++)if(this._eventTimes[t]>e){i=t;break}this._events.splice(i,0,t),this._eventTimes.splice(i,0,e)}get(){if(!this._events.length)return null;let t=this._eventTimes.splice(0,1)[0];if(t>0){this._time+=t;for(let e=0;e<this._eventTimes.length;e++)this._eventTimes[e]-=t}return this._events.splice(0,1)[0]}getEventTime(t){let e=this._events.indexOf(t);if(-1!=e)return this._eventTimes[e]}remove(t){let e=this._events.indexOf(t);return-1!=e&&(this._remove(e),!0)}_remove(t){this._events.splice(t,1),this._eventTimes.splice(t,1)}}class G{constructor(){this._queue=new $,this._repeat=[],this._current=null}getTime(){return this._queue.getTime()}add(t,e){return e&&this._repeat.push(t),this}getTimeOf(t){return this._queue.getEventTime(t)}clear(){return this._queue.clear(),this._repeat=[],this._current=null,this}remove(t){let e=this._queue.remove(t),i=this._repeat.indexOf(t);return-1!=i&&this._repeat.splice(i,1),this._current==t&&(this._current=null),e}next(){return this._current=this._queue.get(),this._current}}class Z extends G{add(t,e){return this._queue.add(t,0),super.add(t,e)}next(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,0),super.next()}}class J extends G{add(t,e,i){return this._queue.add(t,void 0!==i?i:1/t.getSpeed()),super.add(t,e)}next(){return this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,1/this._current.getSpeed()),super.next()}}class Q extends G{constructor(){super(),this._defaultDuration=1,this._duration=this._defaultDuration}add(t,e,i){return this._queue.add(t,i||this._defaultDuration),super.add(t,e)}clear(){return this._duration=this._defaultDuration,super.clear()}remove(t){return t==this._current&&(this._duration=this._defaultDuration),super.remove(t)}next(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&(this._queue.add(this._current,this._duration||this._defaultDuration),this._duration=this._defaultDuration),super.next()}setDuration(t){return this._current&&(this._duration=t),this}}class tt{constructor(t,e={}){this._lightPasses=t,this._options=Object.assign({topology:8},e)}_getCircle(t,e,i){let r,n,o,s=[];switch(this._options.topology){case 4:n=1,o=[0,1],r=[z[8][7],z[8][1],z[8][3],z[8][5]];break;case 6:r=z[6],n=1,o=[-1,1];break;case 8:r=z[4],n=2,o=[-1,1];break;default:throw new Error("Incorrect topology for FOV computation")}let a=t+o[0]*i,l=e+o[1]*i;for(let t=0;t<r.length;t++)for(let e=0;e<i*n;e++)s.push([a,l]),a+=r[t][0],l+=r[t][1];return s}}class et extends tt{compute(t,e,i,r){if(r(t,e,0,1),!this._lightPasses(t,e))return;let n,o,s,a,l,u=[];for(let h=1;h<=i;h++){let i=this._getCircle(t,e,h),c=360/i.length;for(let t=0;t<i.length;t++)if(s=i[t][0],a=i[t][1],o=(n=c*(t-.5))+c,l=!this._lightPasses(s,a),this._visibleCoords(Math.floor(n),Math.ceil(o),l,u)&&r(s,a,h,1),2==u.length&&0==u[0]&&360==u[1])return}}_visibleCoords(t,e,i,r){if(t<0){let n=this._visibleCoords(0,e,i,r),o=this._visibleCoords(360+t,360,i,r);return n||o}let n=0;for(;n<r.length&&r[n]<t;)n++;if(n==r.length)return i&&r.push(t,e),!0;let o=0;if(n%2){for(;n<r.length&&r[n]<e;)n++,o++;return 0!=o&&(i&&(o%2?r.splice(n-o,o,e):r.splice(n-o,o)),!0)}for(;n<r.length&&r[n]<e;)n++,o++;return(t!=r[n-o]||1!=o)&&(i&&(o%2?r.splice(n-o,o,t):r.splice(n-o,o,t,e)),!0)}}class it extends tt{compute(t,e,i,r){if(r(t,e,0,1),!this._lightPasses(t,e))return;let n,o,s,a,l,u,h=[];for(let c=1;c<=i;c++){let i=this._getCircle(t,e,c),f=i.length;for(let t=0;t<f;t++)if(n=i[t][0],o=i[t][1],a=[t?2*t-1:2*f-1,2*f],l=[2*t+1,2*f],s=!this._lightPasses(n,o),(u=this._checkVisibility(a,l,s,h))&&r(n,o,c,u),2==h.length&&0==h[0][0]&&h[1][0]==h[1][1])return}}_checkVisibility(t,e,i,r){if(t[0]>e[0]){return(this._checkVisibility(t,[t[1],t[1]],i,r)+this._checkVisibility([0,1],e,i,r))/2}let n=0,o=!1;for(;n<r.length;){let e=r[n],i=e[0]*t[1]-t[0]*e[1];if(i>=0){0!=i||n%2||(o=!0);break}n++}let s=r.length,a=!1;for(;s--;){let t=r[s],i=e[0]*t[1]-t[0]*e[1];if(i>=0){0==i&&s%2&&(a=!0);break}}let l,u=!0;if(n==s&&(o||a)?u=!1:o&&a&&n+1==s&&s%2?u=!1:n>s&&n%2&&(u=!1),!u)return 0;let h=s-n+1;if(h%2)if(n%2){let t=r[n];l=(e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]),i&&r.splice(n,h,e)}else{let e=r[s];l=(e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]),i&&r.splice(n,h,t)}else{if(!(n%2))return i&&r.splice(n,h,t,e),1;{let t=r[n],e=r[s];l=(e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]),i&&r.splice(n,h)}}return l/((e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]))}}const rt=[[-1,0,0,1],[0,-1,1,0],[0,-1,-1,0],[-1,0,0,-1],[1,0,0,-1],[0,1,-1,0],[0,1,1,0],[1,0,0,1]];class nt extends tt{compute(t,e,i,r){r(t,e,0,1);for(let n=0;n<rt.length;n++)this._renderOctant(t,e,rt[n],i,r)}compute180(t,e,i,r,n){n(t,e,0,1);let o=(r-1+8)%8,s=(r-2+8)%8,a=(r+1+8)%8;this._renderOctant(t,e,rt[s],i,n),this._renderOctant(t,e,rt[o],i,n),this._renderOctant(t,e,rt[r],i,n),this._renderOctant(t,e,rt[a],i,n)}compute90(t,e,i,r,n){n(t,e,0,1);let o=(r-1+8)%8;this._renderOctant(t,e,rt[r],i,n),this._renderOctant(t,e,rt[o],i,n)}_renderOctant(t,e,i,r,n){this._castVisibility(t,e,1,1,0,r+1,i[0],i[1],i[2],i[3],n)}_castVisibility(t,e,i,r,n,o,s,a,l,u,h){if(!(r<n))for(let c=i;c<=o;c++){let i=-c-1,f=-c,d=!1,m=0;for(;i<=0;){let p=t+(i+=1)*s+f*a,g=e+i*l+f*u,_=(i-.5)/(f+.5),v=(i+.5)/(f-.5);if(!(v>r)){if(_<n)break;if(i*i+f*f<o*o&&h(p,g,c,1),d){if(!this._lightPasses(p,g)){m=v;continue}d=!1,r=m}else!this._lightPasses(p,g)&&c<o&&(d=!0,this._castVisibility(t,e,c+1,r,_,o,s,a,l,u,h),m=v)}}if(d)break}}}var ot={DiscreteShadowcasting:class extends tt{compute(t,e,i,r){if(r(t,e,0,1),!this._lightPasses(t,e))return;let n,o,s,a,l,u=[];for(let h=1;h<=i;h++){let i=this._getCircle(t,e,h),c=360/i.length;for(let t=0;t<i.length;t++)if(s=i[t][0],a=i[t][1],o=(n=c*(t-.5))+c,l=!this._lightPasses(s,a),this._visibleCoords(Math.floor(n),Math.ceil(o),l,u)&&r(s,a,h,1),2==u.length&&0==u[0]&&360==u[1])return}}_visibleCoords(t,e,i,r){if(t<0){let n=this._visibleCoords(0,e,i,r),o=this._visibleCoords(360+t,360,i,r);return n||o}let n=0;for(;n<r.length&&r[n]<t;)n++;if(n==r.length)return i&&r.push(t,e),!0;let o=0;if(n%2){for(;n<r.length&&r[n]<e;)n++,o++;return 0!=o&&(i&&(o%2?r.splice(n-o,o,e):r.splice(n-o,o)),!0)}for(;n<r.length&&r[n]<e;)n++,o++;return(t!=r[n-o]||1!=o)&&(i&&(o%2?r.splice(n-o,o,t):r.splice(n-o,o,t,e)),!0)}},PreciseShadowcasting:class extends tt{compute(t,e,i,r){if(r(t,e,0,1),!this._lightPasses(t,e))return;let n,o,s,a,l,u,h=[];for(let c=1;c<=i;c++){let i=this._getCircle(t,e,c),f=i.length;for(let t=0;t<f;t++)if(n=i[t][0],o=i[t][1],a=[t?2*t-1:2*f-1,2*f],l=[2*t+1,2*f],s=!this._lightPasses(n,o),(u=this._checkVisibility(a,l,s,h))&&r(n,o,c,u),2==h.length&&0==h[0][0]&&h[1][0]==h[1][1])return}}_checkVisibility(t,e,i,r){if(t[0]>e[0]){return(this._checkVisibility(t,[t[1],t[1]],i,r)+this._checkVisibility([0,1],e,i,r))/2}let n=0,o=!1;for(;n<r.length;){let e=r[n],i=e[0]*t[1]-t[0]*e[1];if(i>=0){0!=i||n%2||(o=!0);break}n++}let s=r.length,a=!1;for(;s--;){let t=r[s],i=e[0]*t[1]-t[0]*e[1];if(i>=0){0==i&&s%2&&(a=!0);break}}let l,u=!0;if(n==s&&(o||a)?u=!1:o&&a&&n+1==s&&s%2?u=!1:n>s&&n%2&&(u=!1),!u)return 0;let h=s-n+1;if(h%2)if(n%2){let t=r[n];l=(e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]),i&&r.splice(n,h,e)}else{let e=r[s];l=(e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]),i&&r.splice(n,h,t)}else{if(!(n%2))return i&&r.splice(n,h,t,e),1;{let t=r[n],e=r[s];l=(e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]),i&&r.splice(n,h)}}return l/((e[0]*t[1]-t[0]*e[1])/(t[1]*e[1]))}},RecursiveShadowcasting:class extends tt{compute(t,e,i,r){r(t,e,0,1);for(let n=0;n<rt.length;n++)this._renderOctant(t,e,rt[n],i,r)}compute180(t,e,i,r,n){n(t,e,0,1);let o=(r-1+8)%8,s=(r-2+8)%8,a=(r+1+8)%8;this._renderOctant(t,e,rt[s],i,n),this._renderOctant(t,e,rt[o],i,n),this._renderOctant(t,e,rt[r],i,n),this._renderOctant(t,e,rt[a],i,n)}compute90(t,e,i,r,n){n(t,e,0,1);let o=(r-1+8)%8;this._renderOctant(t,e,rt[r],i,n),this._renderOctant(t,e,rt[o],i,n)}_renderOctant(t,e,i,r,n){this._castVisibility(t,e,1,1,0,r+1,i[0],i[1],i[2],i[3],n)}_castVisibility(t,e,i,r,n,o,s,a,l,u,h){if(!(r<n))for(let c=i;c<=o;c++){let i=-c-1,f=-c,d=!1,m=0;for(;i<=0;){let p=t+(i+=1)*s+f*a,g=e+i*l+f*u,_=(i-.5)/(f+.5),v=(i+.5)/(f-.5);if(!(v>r)){if(_<n)break;if(i*i+f*f<o*o&&h(p,g,c,1),d){if(!this._lightPasses(p,g)){m=v;continue}d=!1,r=m}else!this._lightPasses(p,g)&&c<o&&(d=!0,this._castVisibility(t,e,c+1,r,_,o,s,a,l,u,h),m=v)}}if(d)break}}}};class st{constructor(t=H,e=W){this._width=t,this._height=e}_fillMap(t){let e=[];for(let i=0;i<this._width;i++){e.push([]);for(let r=0;r<this._height;r++)e[i].push(t)}return e}}class at extends st{create(t){let e=this._width-1,i=this._height-1;for(let r=0;r<=e;r++)for(let n=0;n<=i;n++){t(r,n,r&&n&&r<e&&n<i?0:1)}return this}}class lt extends st{constructor(t,e){super(t,e),this._rooms=[],this._corridors=[]}getRooms(){return this._rooms}getCorridors(){return this._corridors}}class ut{}class ht extends ut{constructor(t,e,i,r,n,o){super(),this._x1=t,this._y1=e,this._x2=i,this._y2=r,this._doors={},void 0!==n&&void 0!==o&&this.addDoor(n,o)}static createRandomAt(t,e,i,r,n){let o=n.roomWidth[0],s=n.roomWidth[1],a=b.a.getUniformInt(o,s);o=n.roomHeight[0],s=n.roomHeight[1];let l=b.a.getUniformInt(o,s);if(1==i){let i=e-Math.floor(b.a.getUniform()*l);return new this(t+1,i,t+a,i+l-1,t,e)}if(-1==i){let i=e-Math.floor(b.a.getUniform()*l);return new this(t-a,i,t-1,i+l-1,t,e)}if(1==r){let i=t-Math.floor(b.a.getUniform()*a);return new this(i,e+1,i+a-1,e+l,t,e)}if(-1==r){let i=t-Math.floor(b.a.getUniform()*a);return new this(i,e-l,i+a-1,e-1,t,e)}throw new Error("dx or dy must be 1 or -1")}static createRandomCenter(t,e,i){let r=i.roomWidth[0],n=i.roomWidth[1],o=b.a.getUniformInt(r,n);r=i.roomHeight[0],n=i.roomHeight[1];let s=b.a.getUniformInt(r,n),a=t-Math.floor(b.a.getUniform()*o),l=e-Math.floor(b.a.getUniform()*s);return new this(a,l,a+o-1,l+s-1)}static createRandom(t,e,i){let r=i.roomWidth[0],n=i.roomWidth[1],o=b.a.getUniformInt(r,n);r=i.roomHeight[0],n=i.roomHeight[1];let s=b.a.getUniformInt(r,n),a=t-o-1,l=e-s-1,u=1+Math.floor(b.a.getUniform()*a),h=1+Math.floor(b.a.getUniform()*l);return new this(u,h,u+o-1,h+s-1)}addDoor(t,e){return this._doors[t+","+e]=1,this}getDoors(t){for(let e in this._doors){let i=e.split(",");t(parseInt(i[0]),parseInt(i[1]))}return this}clearDoors(){return this._doors={},this}addDoors(t){let e=this._x1-1,i=this._x2+1,r=this._y1-1,n=this._y2+1;for(let o=e;o<=i;o++)for(let s=r;s<=n;s++)o!=e&&o!=i&&s!=r&&s!=n||t(o,s)||this.addDoor(o,s);return this}debug(){console.log("room",this._x1,this._y1,this._x2,this._y2)}isValid(t,e){let i=this._x1-1,r=this._x2+1,n=this._y1-1,o=this._y2+1;for(let s=i;s<=r;s++)for(let a=n;a<=o;a++)if(s==i||s==r||a==n||a==o){if(!t(s,a))return!1}else if(!e(s,a))return!1;return!0}create(t){let e=this._x1-1,i=this._x2+1,r=this._y1-1,n=this._y2+1,o=0;for(let s=e;s<=i;s++)for(let a=r;a<=n;a++)t(s,a,o=s+","+a in this._doors?2:s==e||s==i||a==r||a==n?1:0)}getCenter(){return[Math.round((this._x1+this._x2)/2),Math.round((this._y1+this._y2)/2)]}getLeft(){return this._x1}getRight(){return this._x2}getTop(){return this._y1}getBottom(){return this._y2}}class ct extends ut{constructor(t,e,i,r){super(),this._startX=t,this._startY=e,this._endX=i,this._endY=r,this._endsWithAWall=!0}static createRandomAt(t,e,i,r,n){let o=n.corridorLength[0],s=n.corridorLength[1],a=b.a.getUniformInt(o,s);return new this(t,e,t+i*a,e+r*a)}debug(){console.log("corridor",this._startX,this._startY,this._endX,this._endY)}isValid(t,e){let i=this._startX,r=this._startY,n=this._endX-i,o=this._endY-r,s=1+Math.max(Math.abs(n),Math.abs(o));n&&(n/=Math.abs(n)),o&&(o/=Math.abs(o));let a=o,l=-n,u=!0;for(let h=0;h<s;h++){let c=i+h*n,f=r+h*o;if(e(c,f)||(u=!1),t(c+a,f+l)||(u=!1),t(c-a,f-l)||(u=!1),!u){s=h,this._endX=c-n,this._endY=f-o;break}}if(0==s)return!1;if(1==s&&t(this._endX+n,this._endY+o))return!1;let h=!t(this._endX+n+a,this._endY+o+l),c=!t(this._endX+n-a,this._endY+o-l);return this._endsWithAWall=t(this._endX+n,this._endY+o),!h&&!c||!this._endsWithAWall}create(t){let e=this._startX,i=this._startY,r=this._endX-e,n=this._endY-i,o=1+Math.max(Math.abs(r),Math.abs(n));r&&(r/=Math.abs(r)),n&&(n/=Math.abs(n));for(let s=0;s<o;s++){t(e+s*r,i+s*n,0)}return!0}createPriorityWalls(t){if(!this._endsWithAWall)return;let e=this._startX,i=this._startY,r=this._endX-e,n=this._endY-i;r&&(r/=Math.abs(r)),n&&(n/=Math.abs(n));let o=n,s=-r;t(this._endX+r,this._endY+n),t(this._endX+o,this._endY+s),t(this._endX-o,this._endY-s)}}class ft extends lt{constructor(t,e,i){super(t,e),this._options={roomWidth:[3,9],roomHeight:[3,5],roomDugPercentage:.1,timeLimit:1e3},Object.assign(this._options,i),this._map=[],this._dug=0,this._roomAttempts=20,this._corridorAttempts=20,this._connected=[],this._unconnected=[],this._digCallback=this._digCallback.bind(this),this._canBeDugCallback=this._canBeDugCallback.bind(this),this._isWallCallback=this._isWallCallback.bind(this)}create(t){let e=Date.now();for(;;){if(Date.now()-e>this._options.timeLimit)return null;if(this._map=this._fillMap(1),this._dug=0,this._rooms=[],this._unconnected=[],this._generateRooms(),!(this._rooms.length<2)&&this._generateCorridors())break}if(t)for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)t(e,i,this._map[e][i]);return this}_generateRooms(){let t,e=this._width-2,i=this._height-2;do{if(t=this._generateRoom(),this._dug/(e*i)>this._options.roomDugPercentage)break}while(t)}_generateRoom(){let t=0;for(;t<this._roomAttempts;){t++;let e=ht.createRandom(this._width,this._height,this._options);if(e.isValid(this._isWallCallback,this._canBeDugCallback))return e.create(this._digCallback),this._rooms.push(e),e}return null}_generateCorridors(){let t=0;for(;t<this._corridorAttempts;){t++,this._corridors=[],this._map=this._fillMap(1);for(let t=0;t<this._rooms.length;t++){let e=this._rooms[t];e.clearDoors(),e.create(this._digCallback)}for(this._unconnected=b.a.shuffle(this._rooms.slice()),this._connected=[],this._unconnected.length&&this._connected.push(this._unconnected.pop());;){let t=b.a.getItem(this._connected);if(!t)break;let e=this._closestRoom(this._unconnected,t);if(!e)break;let i=this._closestRoom(this._connected,e);if(!i)break;if(!this._connectRooms(e,i))break;if(!this._unconnected.length)return!0}}return!1}_closestRoom(t,e){let i=1/0,r=e.getCenter(),n=null;for(let e=0;e<t.length;e++){let o=t[e],s=o.getCenter(),a=s[0]-r[0],l=s[1]-r[1],u=a*a+l*l;u<i&&(i=u,n=o)}return n}_connectRooms(t,e){let i,r,n,o,s,a,l,u=t.getCenter(),h=e.getCenter(),c=h[0]-u[0],f=h[1]-u[1];if(Math.abs(c)<Math.abs(f)?(o=((n=f>0?2:0)+2)%4,s=e.getLeft(),a=e.getRight(),l=0):(o=((n=c>0?1:3)+2)%4,s=e.getTop(),a=e.getBottom(),l=1),!(i=this._placeInWall(t,n)))return!1;if(i[l]>=s&&i[l]<=a){r=i.slice();let t=0;switch(o){case 0:t=e.getTop()-1;break;case 1:t=e.getRight()+1;break;case 2:t=e.getBottom()+1;break;case 3:t=e.getLeft()-1}r[(l+1)%2]=t,this._digLine([i,r])}else if(i[l]<s-1||i[l]>a+1){let t=i[l]-h[l],n=0;switch(o){case 0:case 1:n=t<0?3:1;break;case 2:case 3:n=t<0?1:3}if(o=(o+n)%4,!(r=this._placeInWall(e,o)))return!1;let s=[0,0];s[l]=i[l];let a=(l+1)%2;s[a]=r[a],this._digLine([i,s,r])}else{let t=(l+1)%2;if(!(r=this._placeInWall(e,o)))return!1;let n=Math.round((r[t]+i[t])/2),s=[0,0],a=[0,0];s[l]=i[l],s[t]=n,a[l]=r[l],a[t]=n,this._digLine([i,s,a,r])}return t.addDoor(i[0],i[1]),e.addDoor(r[0],r[1]),-1!=(l=this._unconnected.indexOf(t))&&(this._unconnected.splice(l,1),this._connected.push(t)),-1!=(l=this._unconnected.indexOf(e))&&(this._unconnected.splice(l,1),this._connected.push(e)),!0}_placeInWall(t,e){let i=[0,0],r=[0,0],n=0;switch(e){case 0:r=[1,0],i=[t.getLeft(),t.getTop()-1],n=t.getRight()-t.getLeft()+1;break;case 1:r=[0,1],i=[t.getRight()+1,t.getTop()],n=t.getBottom()-t.getTop()+1;break;case 2:r=[1,0],i=[t.getLeft(),t.getBottom()+1],n=t.getRight()-t.getLeft()+1;break;case 3:r=[0,1],i=[t.getLeft()-1,t.getTop()],n=t.getBottom()-t.getTop()+1}let o=[],s=-2;for(let t=0;t<n;t++){let e=i[0]+t*r[0],n=i[1]+t*r[1];o.push(null),1==this._map[e][n]?s!=t-1&&(o[t]=[e,n]):(s=t,t&&(o[t-1]=null))}for(let t=o.length-1;t>=0;t--)o[t]||o.splice(t,1);return o.length?b.a.getItem(o):null}_digLine(t){for(let e=1;e<t.length;e++){let i=t[e-1],r=t[e],n=new ct(i[0],i[1],r[0],r[1]);n.create(this._digCallback),this._corridors.push(n)}}_digCallback(t,e,i){this._map[t][e]=i,0==i&&this._dug++}_isWallCallback(t,e){return!(t<0||e<0||t>=this._width||e>=this._height)&&1==this._map[t][e]}_canBeDugCallback(t,e){return!(t<1||e<1||t+1>=this._width||e+1>=this._height)&&1==this._map[t][e]}}class dt extends st{constructor(t,e,i={}){super(t,e),this._options={born:[5,6,7,8],survive:[4,5,6,7,8],topology:8},this.setOptions(i),this._dirs=z[this._options.topology],this._map=this._fillMap(0)}randomize(t){for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)this._map[e][i]=b.a.getUniform()<t?1:0;return this}setOptions(t){Object.assign(this._options,t)}set(t,e,i){this._map[t][e]=i}create(t){let e=this._fillMap(0),i=this._options.born,r=this._options.survive;for(let t=0;t<this._height;t++){let n=1,o=0;6==this._options.topology&&(n=2,o=t%2);for(let s=o;s<this._width;s+=n){let n=this._map[s][t],o=this._getNeighbors(s,t);n&&-1!=r.indexOf(o)?e[s][t]=1:n||-1==i.indexOf(o)||(e[s][t]=1)}}this._map=e,t&&this._serviceCallback(t)}_serviceCallback(t){for(let e=0;e<this._height;e++){let i=1,r=0;6==this._options.topology&&(i=2,r=e%2);for(let n=r;n<this._width;n+=i)t(n,e,this._map[n][e])}}_getNeighbors(t,e){let i=0;for(let r=0;r<this._dirs.length;r++){let n=this._dirs[r],o=t+n[0],s=e+n[1];o<0||o>=this._width||s<0||s>=this._height||(i+=1==this._map[o][s]?1:0)}return i}connect(t,e,i){e||(e=0);let r=[],n={},o=1,s=[0,0];6==this._options.topology&&(o=2,s=[0,1]);for(let t=0;t<this._height;t++)for(let i=s[t%2];i<this._width;i+=o)if(this._freeSpace(i,t,e)){let e=[i,t];n[this._pointKey(e)]=e,r.push([i,t])}let a=r[b.a.getUniformInt(0,r.length-1)],l=this._pointKey(a),u={};for(u[l]=a,delete n[l],this._findConnected(u,n,[a],!1,e);Object.keys(n).length>0;){let t=this._getFromTo(u,n),r=t[0],o=t[1],s={};s[this._pointKey(r)]=r,this._findConnected(s,n,[r],!0,e),(6==this._options.topology?this._tunnelToConnected6:this._tunnelToConnected).call(this,o,r,u,n,e,i);for(let t in s){let i=s[t];this._map[i[0]][i[1]]=e,u[t]=i,delete n[t]}}t&&this._serviceCallback(t)}_getFromTo(t,e){let i,r=[0,0],n=[0,0],o=Object.keys(t),s=Object.keys(e);for(let a=0;a<5;a++){if(o.length<s.length){let i=o;n=t[i[b.a.getUniformInt(0,i.length-1)]],r=this._getClosest(n,e)}else{let i=s;r=e[i[b.a.getUniformInt(0,i.length-1)]],n=this._getClosest(r,t)}if((i=(r[0]-n[0])*(r[0]-n[0])+(r[1]-n[1])*(r[1]-n[1]))<64)break}return[r,n]}_getClosest(t,e){let i=null,r=null;for(let n in e){let o=e[n],s=(o[0]-t[0])*(o[0]-t[0])+(o[1]-t[1])*(o[1]-t[1]);(null==r||s<r)&&(r=s,i=o)}return i}_findConnected(t,e,i,r,n){for(;i.length>0;){let o,s=i.splice(0,1)[0];o=6==this._options.topology?[[s[0]+2,s[1]],[s[0]+1,s[1]-1],[s[0]-1,s[1]-1],[s[0]-2,s[1]],[s[0]-1,s[1]+1],[s[0]+1,s[1]+1]]:[[s[0]+1,s[1]],[s[0]-1,s[1]],[s[0],s[1]+1],[s[0],s[1]-1]];for(let s=0;s<o.length;s++){let a=this._pointKey(o[s]);null==t[a]&&this._freeSpace(o[s][0],o[s][1],n)&&(t[a]=o[s],r||delete e[a],i.push(o[s]))}}}_tunnelToConnected(t,e,i,r,n,o){let s,a;e[0]<t[0]?(s=e,a=t):(s=t,a=e);for(let t=s[0];t<=a[0];t++){this._map[t][s[1]]=n;let e=[t,s[1]],o=this._pointKey(e);i[o]=e,delete r[o]}o&&s[0]<a[0]&&o(s,[a[0],s[1]]);let l=a[0];e[1]<t[1]?(s=e,a=t):(s=t,a=e);for(let t=s[1];t<a[1];t++){this._map[l][t]=n;let e=[l,t],o=this._pointKey(e);i[o]=e,delete r[o]}o&&s[1]<a[1]&&o([a[0],s[1]],[a[0],a[1]])}_tunnelToConnected6(t,e,i,r,n,o){let s,a;e[0]<t[0]?(s=e,a=t):(s=t,a=e);let l=s[0],u=s[1];for(;l!=a[0]||u!=a[1];){let t=2;u<a[1]?(u++,t=1):u>a[1]&&(u--,t=1),l<a[0]?l+=t:l>a[0]?l-=t:a[1]%2?l-=t:l+=t,this._map[l][u]=n;let e=[l,u],o=this._pointKey(e);i[o]=e,delete r[o]}o&&o(e,t)}_freeSpace(t,e,i){return t>=0&&t<this._width&&e>=0&&e<this._height&&this._map[t][e]==i}_pointKey(t){return t[0]+"."+t[1]}}const mt={room:ht,corridor:ct};class pt extends lt{constructor(t,e,i={}){super(t,e),this._options=Object.assign({roomWidth:[3,9],roomHeight:[3,5],corridorLength:[3,10],dugPercentage:.2,timeLimit:1e3},i),this._features={room:4,corridor:4},this._map=[],this._featureAttempts=20,this._walls={},this._dug=0,this._digCallback=this._digCallback.bind(this),this._canBeDugCallback=this._canBeDugCallback.bind(this),this._isWallCallback=this._isWallCallback.bind(this),this._priorityWallCallback=this._priorityWallCallback.bind(this)}create(t){this._rooms=[],this._corridors=[],this._map=this._fillMap(1),this._walls={},this._dug=0;let e=(this._width-2)*(this._height-2);this._firstRoom();let i,r=Date.now();do{if(i=0,Date.now()-r>this._options.timeLimit)break;let t=this._findWall();if(!t)break;let e=t.split(","),n=parseInt(e[0]),o=parseInt(e[1]),s=this._getDiggingDirection(n,o);if(!s)continue;let a=0;do{if(a++,this._tryFeature(n,o,s[0],s[1])){this._removeSurroundingWalls(n,o),this._removeSurroundingWalls(n-s[0],o-s[1]);break}}while(a<this._featureAttempts);for(let t in this._walls)this._walls[t]>1&&i++}while(this._dug/e<this._options.dugPercentage||i);if(this._addDoors(),t)for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)t(e,i,this._map[e][i]);return this._walls={},this._map=[],this}_digCallback(t,e,i){0==i||2==i?(this._map[t][e]=0,this._dug++):this._walls[t+","+e]=1}_isWallCallback(t,e){return!(t<0||e<0||t>=this._width||e>=this._height)&&1==this._map[t][e]}_canBeDugCallback(t,e){return!(t<1||e<1||t+1>=this._width||e+1>=this._height)&&1==this._map[t][e]}_priorityWallCallback(t,e){this._walls[t+","+e]=2}_firstRoom(){let t=Math.floor(this._width/2),e=Math.floor(this._height/2),i=ht.createRandomCenter(t,e,this._options);this._rooms.push(i),i.create(this._digCallback)}_findWall(){let t=[],e=[];for(let i in this._walls){2==this._walls[i]?e.push(i):t.push(i)}let i=e.length?e:t;if(!i.length)return null;let r=b.a.getItem(i.sort());return delete this._walls[r],r}_tryFeature(t,e,i,r){let n=b.a.getWeightedValue(this._features),o=mt[n].createRandomAt(t,e,i,r,this._options);return!!o.isValid(this._isWallCallback,this._canBeDugCallback)&&(o.create(this._digCallback),o instanceof ht&&this._rooms.push(o),o instanceof ct&&(o.createPriorityWalls(this._priorityWallCallback),this._corridors.push(o)),!0)}_removeSurroundingWalls(t,e){let i=z[4];for(let r=0;r<i.length;r++){let n=i[r],o=t+n[0],s=e+n[1];delete this._walls[o+","+s],o=t+2*n[0],s=e+2*n[1],delete this._walls[o+","+s]}}_getDiggingDirection(t,e){if(t<=0||e<=0||t>=this._width-1||e>=this._height-1)return null;let i=null,r=z[4];for(let n=0;n<r.length;n++){let o=r[n],s=t+o[0],a=e+o[1];if(!this._map[s][a]){if(i)return null;i=o}}return i?[-i[0],-i[1]]:null}_addDoors(){let t=this._map;function e(e,i){return 1==t[e][i]}for(let t=0;t<this._rooms.length;t++){let i=this._rooms[t];i.clearDoors(),i.addDoors(e)}}}function gt(t,e,i){i[e[t+1]]=i[t],e[i[t]]=e[t+1],i[t]=t+1,e[t+1]=t}function _t(t,e,i){i[e[t]]=i[t],e[i[t]]=e[t],i[t]=t,e[t]=t}class vt extends st{create(t){let e,i=this._fillMap(1),r=Math.ceil((this._width-2)/2),n=[],o=[];for(let t=0;t<r;t++)n.push(t),o.push(t);for(n.push(r-1),e=1;e+3<this._height;e+=2)for(let t=0;t<r;t++){let r=2*t+1,s=e;i[r][s]=0,t!=n[t+1]&&b.a.getUniform()>.375&&(gt(t,n,o),i[r+1][s]=0),t!=n[t]&&b.a.getUniform()>.375?_t(t,n,o):i[r][s+1]=0}for(let t=0;t<r;t++){let r=2*t+1,s=e;i[r][s]=0,t!=n[t+1]&&(t==n[t]||b.a.getUniform()>.375)&&(gt(t,n,o),i[r+1][s]=0),_t(t,n,o)}for(let e=0;e<this._width;e++)for(let r=0;r<this._height;r++)t(e,r,i[e][r]);return this}}class bt extends st{constructor(){super(...arguments),this._stack=[],this._map=[]}create(t){let e=this._width,i=this._height;this._map=[];for(let t=0;t<e;t++){this._map.push([]);for(let r=0;r<i;r++){let n=0==t||0==r||t+1==e||r+1==i;this._map[t].push(n?1:0)}}this._stack=[[1,1,e-2,i-2]],this._process();for(let r=0;r<e;r++)for(let e=0;e<i;e++)t(r,e,this._map[r][e]);return this._map=[],this}_process(){for(;this._stack.length;){let t=this._stack.shift();this._partitionRoom(t)}}_partitionRoom(t){let e=[],i=[];for(let i=t[0]+1;i<t[2];i++){let r=this._map[i][t[1]-1],n=this._map[i][t[3]+1];!r||!n||i%2||e.push(i)}for(let e=t[1]+1;e<t[3];e++){let r=this._map[t[0]-1][e],n=this._map[t[2]+1][e];!r||!n||e%2||i.push(e)}if(!e.length||!i.length)return;let r=b.a.getItem(e),n=b.a.getItem(i);this._map[r][n]=1;let o=[],s=[];o.push(s);for(let e=t[0];e<r;e++)this._map[e][n]=1,s.push([e,n]);s=[],o.push(s);for(let e=r+1;e<=t[2];e++)this._map[e][n]=1,s.push([e,n]);s=[],o.push(s);for(let e=t[1];e<n;e++)this._map[r][e]=1,s.push([r,e]);s=[],o.push(s);for(let e=n+1;e<=t[3];e++)this._map[r][e]=1,s.push([r,e]);let a=b.a.getItem(o);for(let t=0;t<o.length;t++){let e=o[t];if(e==a)continue;let i=b.a.getItem(e);this._map[i[0]][i[1]]=0}this._stack.push([t[0],t[1],r-1,n-1]),this._stack.push([r+1,t[1],t[2],n-1]),this._stack.push([t[0],n+1,r-1,t[3]]),this._stack.push([r+1,n+1,t[2],t[3]])}}class yt extends st{constructor(t,e,i=0){super(t,e),this._regularity=i,this._map=[]}create(t){let e=this._width,i=this._height,r=this._fillMap(1);e-=e%2?1:2,i-=i%2?1:2;let n=0,o=0,s=0,a=0,l=0,u=!1,h=[[0,0],[0,0],[0,0],[0,0]];do{if(n=1+2*Math.floor(b.a.getUniform()*(e-1)/2),o=1+2*Math.floor(b.a.getUniform()*(i-1)/2),l||(r[n][o]=0),!r[n][o]){this._randomize(h);do{0==Math.floor(b.a.getUniform()*(this._regularity+1))&&this._randomize(h),u=!0;for(let t=0;t<4;t++)if(s=n+2*h[t][0],a=o+2*h[t][1],this._isFree(r,s,a,e,i)){r[s][a]=0,r[n+h[t][0]][o+h[t][1]]=0,n=s,o=a,u=!1,l++;break}}while(!u)}}while(l+1<e*i/4);for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)t(e,i,r[e][i]);return this._map=[],this}_randomize(t){for(let e=0;e<4;e++)t[e][0]=0,t[e][1]=0;switch(Math.floor(4*b.a.getUniform())){case 0:t[0][0]=-1,t[1][0]=1,t[2][1]=-1,t[3][1]=1;break;case 1:t[3][0]=-1,t[2][0]=1,t[1][1]=-1,t[0][1]=1;break;case 2:t[2][0]=-1,t[3][0]=1,t[0][1]=-1,t[1][1]=1;break;case 3:t[1][0]=-1,t[0][0]=1,t[3][1]=-1,t[2][1]=1}}_isFree(t,e,i,r,n){return!(e<1||i<1||e>=r||i>=n)&&t[e][i]}}class wt extends st{constructor(t,e,i){super(t,e),this.map=[],this.rooms=[],this.connectedCells=[],(i=Object.assign({cellWidth:3,cellHeight:3},i)).hasOwnProperty("roomWidth")||(i.roomWidth=this._calculateRoomSize(this._width,i.cellWidth)),i.hasOwnProperty("roomHeight")||(i.roomHeight=this._calculateRoomSize(this._height,i.cellHeight)),this._options=i}create(t){if(this.map=this._fillMap(1),this.rooms=[],this.connectedCells=[],this._initRooms(),this._connectRooms(),this._connectUnconnectedRooms(),this._createRandomRoomConnections(),this._createRooms(),this._createCorridors(),t)for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)t(e,i,this.map[e][i]);return this}_calculateRoomSize(t,e){let i=Math.floor(t/e*.8),r=Math.floor(t/e*.25);return r<2&&(r=2),i<2&&(i=2),[r,i]}_initRooms(){for(let t=0;t<this._options.cellWidth;t++){this.rooms.push([]);for(let e=0;e<this._options.cellHeight;e++)this.rooms[t].push({x:0,y:0,width:0,height:0,connections:[],cellx:t,celly:e})}}_connectRooms(){let t,e,i,r,n,o,s=b.a.getUniformInt(0,this._options.cellWidth-1),a=b.a.getUniformInt(0,this._options.cellHeight-1),l=!1;do{o=[0,2,4,6],o=b.a.shuffle(o);do{if(l=!1,t=o.pop(),e=s+z[8][t][0],i=a+z[8][t][1],!(e<0||e>=this._options.cellWidth||i<0||i>=this._options.cellHeight)){if((r=this.rooms[s][a]).connections.length>0&&r.connections[0][0]==e&&r.connections[0][1]==i)break;0==(n=this.rooms[e][i]).connections.length&&(n.connections.push([s,a]),this.connectedCells.push([e,i]),s=e,a=i,l=!0)}}while(o.length>0&&0==l)}while(o.length>0)}_connectUnconnectedRooms(){let t,e,i,r=this._options.cellWidth,n=this._options.cellHeight;this.connectedCells=b.a.shuffle(this.connectedCells);for(let o=0;o<this._options.cellWidth;o++)for(let s=0;s<this._options.cellHeight;s++)if(0==(t=this.rooms[o][s]).connections.length){let a=[0,2,4,6];a=b.a.shuffle(a),i=!1;do{let t=a.pop(),l=o+z[8][t][0],u=s+z[8][t][1];if(!(l<0||l>=r||u<0||u>=n)){if(i=!0,0==(e=this.rooms[l][u]).connections.length)break;for(let t=0;t<e.connections.length;t++)if(e.connections[t][0]==o&&e.connections[t][1]==s){i=!1;break}if(i)break}}while(a.length);i?t.connections.push([e.cellx,e.celly]):console.log("-- Unable to connect room.")}}_createRandomRoomConnections(){}_createRooms(){let t,e,i,r,n,o=this._width,s=this._height,a=this._options.cellWidth,l=this._options.cellHeight,u=Math.floor(this._width/a),h=Math.floor(this._height/l),c=this._options.roomWidth,f=this._options.roomHeight;for(let d=0;d<a;d++)for(let a=0;a<l;a++){if(0==(i=u*d)&&(i=1),0==(r=h*a)&&(r=1),t=b.a.getUniformInt(c[0],c[1]),e=b.a.getUniformInt(f[0],f[1]),a>0)for(n=this.rooms[d][a-1];r-(n.y+n.height)<3;)r++;if(d>0)for(n=this.rooms[d-1][a];i-(n.x+n.width)<3;)i++;let l=Math.round(b.a.getUniformInt(0,u-t)/2),m=Math.round(b.a.getUniformInt(0,h-e)/2);for(;i+l+t>=o;)l?l--:t--;for(;r+m+e>=s;)m?m--:e--;i+=l,r+=m,this.rooms[d][a].x=i,this.rooms[d][a].y=r,this.rooms[d][a].width=t,this.rooms[d][a].height=e;for(let n=i;n<i+t;n++)for(let t=r;t<r+e;t++)this.map[n][t]=0}}_getWallPosition(t,e){let i,r,n;return 1==e||3==e?(i=b.a.getUniformInt(t.x+1,t.x+t.width-2),n=1==e?(r=t.y-2)+1:(r=t.y+t.height+1)-1,this.map[i][n]=0):(r=b.a.getUniformInt(t.y+1,t.y+t.height-2),n=2==e?(i=t.x+t.width+1)-1:(i=t.x-2)+1,this.map[n][r]=0),[i,r]}_drawCorridor(t,e){let i,r,n,o,s=e[0]-t[0],a=e[1]-t[1],l=t[0],u=t[1],h=[],c=Math.abs(s),f=Math.abs(a),d=b.a.getUniform(),m=d,p=1-d;for(r=s>0?2:6,n=a>0?4:0,c<f?(i=Math.ceil(f*m),h.push([n,i]),h.push([r,c]),i=Math.floor(f*p),h.push([n,i])):(i=Math.ceil(c*m),h.push([r,i]),h.push([n,f]),i=Math.floor(c*p),h.push([r,i])),this.map[l][u]=0;h.length>0;)for(o=h.pop();o[1]>0;)l+=z[8][o[0]][0],u+=z[8][o[0]][1],this.map[l][u]=0,o[1]=o[1]-1}_createCorridors(){let t,e,i,r,n,o=this._options.cellWidth,s=this._options.cellHeight;for(let a=0;a<o;a++)for(let o=0;o<s;o++){t=this.rooms[a][o];for(let o=0;o<t.connections.length;o++)e=t.connections[o],(i=this.rooms[e[0]][e[1]]).cellx>t.cellx?(r=2,n=4):i.cellx<t.cellx?(r=4,n=2):i.celly>t.celly?(r=3,n=1):(r=1,n=3),this._drawCorridor(this._getWallPosition(t,r),this._getWallPosition(i,n))}}}class Et{}const kt=.5*(Math.sqrt(3)-1),St=(3-Math.sqrt(3))/6;class Mt extends Et{constructor(t=256){super(),this._gradients=[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]];let e=[];for(let i=0;i<t;i++)e.push(i);e=b.a.shuffle(e),this._perms=[],this._indexes=[];for(let i=0;i<2*t;i++)this._perms.push(e[i%t]),this._indexes.push(this._perms[i]%this._gradients.length)}get(t,e){let i,r,n,o=this._perms,s=this._indexes,a=o.length/2,l=0,u=0,h=0,c=(t+e)*kt,f=Math.floor(t+c),d=Math.floor(e+c),m=(f+d)*St,p=t-(f-m),g=e-(d-m);p>g?(r=1,n=0):(r=0,n=1);let _=p-r+St,v=g-n+St,b=p-1+2*St,y=g-1+2*St,w=Object(E.mod)(f,a),k=Object(E.mod)(d,a),S=.5-p*p-g*g;if(S>=0){S*=S,i=s[w+o[k]];let t=this._gradients[i];l=S*S*(t[0]*p+t[1]*g)}let M=.5-_*_-v*v;if(M>=0){M*=M,i=s[w+r+o[k+n]];let t=this._gradients[i];u=M*M*(t[0]*_+t[1]*v)}let A=.5-b*b-y*y;if(A>=0){A*=A,i=s[w+1+o[k+1]];let t=this._gradients[i];h=A*A*(t[0]*b+t[1]*y)}return 70*(l+u+h)}}class At{constructor(t,e,i,r={}){this._toX=t,this._toY=e,this._passableCallback=i,this._options=Object.assign({topology:8},r),this._dirs=z[this._options.topology],8==this._options.topology&&(this._dirs=[this._dirs[0],this._dirs[2],this._dirs[4],this._dirs[6],this._dirs[1],this._dirs[3],this._dirs[5],this._dirs[7]])}_getNeighbors(t,e){let i=[];for(let r=0;r<this._dirs.length;r++){let n=this._dirs[r],o=t+n[0],s=e+n[1];this._passableCallback(o,s)&&i.push([o,s])}return i}}class Tt extends At{constructor(t,e,i,r){super(t,e,i,r),this._computed={},this._todo=[],this._add(t,e,null)}compute(t,e,i){let r=t+","+e;if(r in this._computed||this._compute(t,e),!(r in this._computed))return;let n=this._computed[r];for(;n;)i(n.x,n.y),n=n.prev}_compute(t,e){for(;this._todo.length;){let i=this._todo.shift();if(i.x==t&&i.y==e)return;let r=this._getNeighbors(i.x,i.y);for(let t=0;t<r.length;t++){let e=r[t],n=e[0],o=e[1];n+","+o in this._computed||this._add(n,o,i)}}}_add(t,e,i){let r={x:t,y:e,prev:i};this._computed[t+","+e]=r,this._todo.push(r)}}class Ct extends At{constructor(t,e,i,r={}){super(t,e,i,r),this._todo=[],this._done={}}compute(t,e,i){for(this._todo=[],this._done={},this._fromX=t,this._fromY=e,this._add(this._toX,this._toY,null);this._todo.length;){let i=this._todo.shift(),r=i.x+","+i.y;if(r in this._done)continue;if(this._done[r]=i,i.x==t&&i.y==e)break;let n=this._getNeighbors(i.x,i.y);for(let t=0;t<n.length;t++){let e=n[t],r=e[0],o=e[1];r+","+o in this._done||this._add(r,o,i)}}let r=this._done[t+","+e];if(r)for(;r;)i(r.x,r.y),r=r.prev}_add(t,e,i){let r=this._distance(t,e),n={x:t,y:e,prev:i,g:i?i.g+1:0,h:r},o=n.g+n.h;for(let t=0;t<this._todo.length;t++){let e=this._todo[t],i=e.g+e.h;if(o<i||o==i&&r<e.h)return void this._todo.splice(t,0,n)}this._todo.push(n)}_distance(t,e){switch(this._options.topology){case 4:return Math.abs(t-this._fromX)+Math.abs(e-this._fromY);case 6:let i=Math.abs(t-this._fromX),r=Math.abs(e-this._fromY);return r+Math.max(0,(i-r)/2);case 8:return Math.max(Math.abs(t-this._fromX),Math.abs(e-this._fromY))}}}class xt{constructor(t,e={}){this._reflectivityCallback=t,this._options={},e=Object.assign({passes:1,emissionThreshold:100,range:10},e),this._lights={},this._reflectivityCache={},this._fovCache={},this.setOptions(e)}setOptions(t){return Object.assign(this._options,t),t&&t.range&&this.reset(),this}setFOV(t){return this._fov=t,this._fovCache={},this}setLight(t,e,i){let r=t+","+e;return i?this._lights[r]="string"==typeof i?A.fromString(i):i:delete this._lights[r],this}clearLights(){this._lights={}}reset(){return this._reflectivityCache={},this._fovCache={},this}compute(t){let e={},i={},r={};for(let t in this._lights){let e=this._lights[t];i[t]=[0,0,0],A.add_(i[t],e)}for(let t=0;t<this._options.passes;t++)this._emitLight(i,r,e),t+1!=this._options.passes&&(i=this._computeEmitters(r,e));for(let e in r){let i=e.split(",");t(parseInt(i[0]),parseInt(i[1]),r[e])}return this}_emitLight(t,e,i){for(let r in t){let n=r.split(","),o=parseInt(n[0]),s=parseInt(n[1]);this._emitLightFromCell(o,s,t[r],e),i[r]=1}return this}_computeEmitters(t,e){let i={};for(let r in t){if(r in e)continue;let n,o=t[r];if(r in this._reflectivityCache)n=this._reflectivityCache[r];else{let t=r.split(","),e=parseInt(t[0]),i=parseInt(t[1]);n=this._reflectivityCallback(e,i),this._reflectivityCache[r]=n}if(0==n)continue;let s=[0,0,0],a=0;for(let t=0;t<3;t++){let e=Math.round(o[t]*n);s[t]=e,a+=e}a>this._options.emissionThreshold&&(i[r]=s)}return i}_emitLightFromCell(t,e,i,r){let n,o=t+","+e;n=o in this._fovCache?this._fovCache[o]:this._updateFOV(t,e);for(let t in n){let e,o=n[t];t in r?e=r[t]:(e=[0,0,0],r[t]=e);for(let t=0;t<3;t++)e[t]+=Math.round(i[t]*o)}return this}_updateFOV(t,e){let i=t+","+e,r={};this._fovCache[i]=r;let n=this._options.range;return this._fov.compute(t,e,n,function(t,e,i,o){let s=o*(1-i/n);0!=s&&(r[t+","+e]=s)}.bind(this)),r}}const Rt=A;class Ot{constructor(t){this.color=t,this.rgb=void 0}static fromHex(t){return new Ot(Rt.fromString(t))}toRgb(){return void 0===this.rgb&&(this.rgb=Rt.toRGB(this.color)),this.rgb}brightness(){return(this.color[0]+this.color[1]+this.color[2])/3}add(t){return new Ot(Rt.add(this.color,t.color))}multiply(t){return new Ot(Rt.multiply(this.color,t.color))}}const Lt=[Ot.fromHex("#FD971F"),Ot.fromHex("#A6E22E"),Ot.fromHex("#66D9EF"),Ot.fromHex("#F92672"),Ot.fromHex("#272822")],Pt=[Ot.fromHex("#E6E6E6"),Ot.fromHex("#6f7261"),Ot.fromHex("#46483d"),Ot.fromHex("#272822"),Ot.fromHex("#080807")];class Nt{constructor(t,e={focused:!0,firstRow:0,hovered:0,selected:void 0}){this.items=t,this.state=e}setItems(t){this.items=t}get selected(){if(void 0!==this.state.selected){const{selected:t}=this.state;return this.itemAtIndex(t)}}get hovered(){if(void 0!==this.state.hovered){const{hovered:t}=this.state;return this.itemAtIndex(t)}}get selectedIndex(){return this.state.selected}get hoveredIndex(){return this.state.hovered}get length(){return this.items.length}itemAtIndex(t){return this.items[t]}update(t,e){!function(t,e,i,r){const n=t.getResource("input");let o;n.position?(o=new _([n.position.x,n.position.y]),e.focused=i.containsVector(o)):e.focused=!1;const s=n.isActive("up"),a=n.isActive("down");s&&e.hovered--;a&&e.hovered++;e.hovered+=r,e.hovered%=r,e.firstRow>e.hovered?e.firstRow=e.hovered:e.firstRow<=e.hovered-i.height&&(e.firstRow=e.hovered-i.height+1);if(e.selected=void 0,o&&i.containsVector(o)){const t=o.minus(i.topLeft);e.hovered=t.y+e.firstRow,n.mousePressed&&(e.selected=t.y+e.firstRow)}n.isActive("accept")&&(e.selected=e.hovered);const l=n.numericActive();void 0!==l&&(e.selected=l)}(t,this.state,e,this.length)}isItemVisible(t,e){return function(t,e,i){return i>=t.firstRow&&i<t.firstRow+e.height}(this.state,t,e)}}class It{constructor(t,e){this.content=t,this.groups=e;const i=Math.floor(t.width/2);this.actions=new v(t.left,t.top,i,t.height),this.descriptions=new v(this.actions.right,t.top,t.width-i,t.height),this.groupSelector=new Nt(this.groups)}render(t){this.renderActions(t),this.renderDescription(t)}get selected(){if(void 0!==this.actionSelector&&void 0!==this.selectedGroupIndex){const t=this.groupSelector.itemAtIndex(this.selectedGroupIndex),e=this.actionSelector.selected;if(void 0!==t&&void 0!==e&&e.available)return{entity:t.entity,action:e.action}}}get hovered(){if(void 0!==this.actionSelector&&void 0!==this.selectedGroupIndex){const t=this.groupSelector.itemAtIndex(this.selectedGroupIndex),e=this.actionSelector.hovered;if(void 0!==t&&void 0!==e)return{entity:t.entity,action:e.action}}}get length(){return void 0!==this.actionSelector?this.actionSelector.length+1:this.groupSelector.length}update(t){const e=t.getResource("input");if(this.groupSelector.update(t,this.actions),void 0!==this.actionSelector)this.actionSelector.update(t,this.actions),e.isActive("cancel")&&(this.selectedGroupIndex=void 0,this.actionSelector=void 0);else{const t=this.groupSelector.selected;void 0!==t&&(this.selectedGroupIndex=this.groupSelector.selectedIndex,this.actionSelector=new Nt(t.items))}}renderActions(t){let e=0;if(void 0===this.selectedGroupIndex)this.groups.forEach((i,r)=>{e=this.renderGroup(t,e,r)});else{this.groupSelector.itemAtIndex(this.selectedGroupIndex).items.forEach((i,r)=>{e=this.renderAction(t,e,r)})}}renderGroup(t,e,i){const r=this.groupSelector.itemAtIndex(i);if(void 0===r||!this.groupSelector.isItemVisible(this.actions,i))return e;const n=r.items.find(t=>t.available);return t.text(`${e+1} ${r.name}`,this.actions.topLeft.add(new _([0,e])),n?Lt[1]:Pt[3],this.groupSelector.hoveredIndex===i?Pt[1]:void 0),e+1}renderAction(t,e,i){const r=this.actionSelector.itemAtIndex(i);return void 0!==r&&this.actionSelector.isItemVisible(this.actions,i)?(t.text(`${e+1} ${r.action.name}`,this.actions.topLeft.add(new _([0,e])),r.available?Lt[1]:Pt[3],this.actionSelector.hoveredIndex===i?Pt[1]:void 0),e+1):e}renderDescription(t){const e=this.groupSelector.hovered,i=this.actionSelector&&this.actionSelector.hovered;if(void 0!==i){const{name:e,cost:r,subActions:n}=i.action;t.text(e,this.descriptions.topLeft,Lt[1]),r.costsAll?t.text("cost: all AP, MP",this.descriptions.topLeft.add(new _([0,1])),Lt[1]):t.text(`cost: ${r.actions}AP ${r.movement}MP`,this.descriptions.topLeft.add(new _([0,2])),Lt[1]);let o=3;n.forEach(e=>{t.text(function(t){switch(t.kind){case"movement":return`${t.kind} ${t.range}`;case"attack":const e=t.effects.filter(t=>"damage"===t.type)[0].value,i=t.effects.filter(t=>"damage"!==t.type).map(t=>t.negated?"-":"+"+t.type[0]);return`${t.kind} ${e} ${i}`;case"status":return t.effects.map(t=>t.negated?"-":"+"+t.type[0]).join(" ")}}(e),this.descriptions.topLeft.add(new _([1,o])),Lt[1]),o++})}else if(void 0!==e){const{name:i,description:r}=e;t.text(i,this.descriptions.topLeft,Lt[1]),t.flowText(r,this.descriptions.topLeft.add(new _([0,1])),this.descriptions.width-2,Lt[1])}else t.text("choose an action to perform",this.descriptions.topLeft.add(new _([1,1])),Lt[1])}}class Ft{constructor(t){this.groups=t,this.key="actionSelector",this.name="select your move",this.shortName="q",this.command="focus",this.minimizedHint="overview"}setFull(t){this.full=new It(t,this.groups)}setMinimized(t){this.minimized=new It(t,this.groups)}get selected(){if(void 0!==this.full)return this.full.selected}get hovered(){if(void 0!==this.full)return this.full.hovered}get length(){return void 0===this.full?0:this.full.length}}function Dt(t){let e=0;return t.incomingLight.forEach(t=>{e=Math.max(e,t.brightness())}),Math.floor(e/255*10)}function Vt(t){return{type:t,current:JSON.parse(JSON.stringify(Zt[t]))}}function Bt(t){return t.current.movement/13}const Ut=["─","═","┐","╖","╕","╗","┌","╔","╒","╓","│","║","└","╙","╘","╚","┘","╝","╛","╜","┬","╥","╤","╦","┤","╡","╢","╣","┼","╫","┴","╨","╧","╩","├","╞","╟","╠","╪","╬"],Kt=["ƒ","å","ß","π","†","¡","∞","•","∂","∆","¬","…","≈","ç","µ","Á","∏","Í","Î","Ó","Ô","","Ò","Ú","»","«","Ç","◊","Â","¿","‼","░","▒","▓"];var Ht,Wt;const zt={wall:{character:"#",diffuse:Pt[3],blocking:!0,lightBlocking:!0,name:"wall"},corridor:{character:".",diffuse:Pt[0],blocking:!1,lightBlocking:!1,name:"corridor"},room:{character:".",diffuse:Lt[1],blocking:!1,lightBlocking:!1,name:"floor"},locker:{character:Kt[16],diffuse:Lt[1],blocking:!0,lightBlocking:!0,name:"locker"},trash:{character:Kt[21],diffuse:Pt[2],blocking:!1,lightBlocking:!1,name:"trash"},door:{character:Kt[27],diffuse:Lt[1],blocking:!0,lightBlocking:!0,name:"door"},hub:{character:".",diffuse:Lt[0],blocking:!1,lightBlocking:!1,name:"floor"},player:{character:"@",diffuse:Lt[0],blocking:!0,lightBlocking:!0,name:"you"},loot:{character:"l",diffuse:Lt[1],blocking:!1,lightBlocking:!1,name:"some loot"},table:{character:Kt[3],diffuse:Lt[1],blocking:!0,lightBlocking:!1,name:"a table"},guard:(Ht="g",Wt="guard",{character:Ht,diffuse:Lt[1],blocking:!0,lightBlocking:!0,name:Wt}),eliteGuard:function(t,e){return{character:t,diffuse:Lt[3],blocking:!0,lightBlocking:!0,name:e}}("g","elite guard")},qt={block:t=>({character:Ut[[7,5,15,17][t]],diffuse:Lt[1],blocking:!0,lightBlocking:!1,name:"a block of concrete"})};function jt(t,e,i){return{check:i,text:t,navigation:e}}function Xt(){return jt("[attack]","attack")}const Yt={randomRemarks:{steps:[{text:["we suspect that your sister controls the mutant rom chip and the frozen wand.","I apoligize for this statement","The CNT-FAI briefly considered joining the Comintern because they fetishized revolutionary upsurges and apparently knew nothing about politics or socialism","Thinking about building a railgun","Kinda want to hug, but like irl. for the propriocetive stimmy feels :P","I am, at my core, a stubborn and frustrating human who only exists to be set in my ways.","England are gonna win. And I'm gonna post so many garbage selfies tonight","Love that my old man is spending his saturday swearing at remainers appearing on the news","you think you do but you don't","I reject nation states","Woah I wish I could read","What the hell is 'pajama'","Always use protection","Subsurface warfare is going to get lit","Gracious wife, gracious life","im about to nut these loads","May biqueerplatonic people find success in their lives","I hope hologender people are getting enough time to rest!","Washing my chin","I am still against full luxury automated communism. thats not what i aim for.","#Javascript was a mistake.","we had fun looking at all the medieval babies at the art gallery today","Oh, me? I'm strictly chillin'","It's a comfortable dusk in the city, and you are a comfortable salmon.","adulthood is having your debit card declined, fashionably"],answers:[jt("ok","close")]}]},guardRandomRemarks:{steps:[{text:["Do you want to cry now?","Love a neurogender bitch, oh, it get my dick hard","You ain't gonna let me fuck you and I feel you","I'm icy bitch, don't look at my wrist.","Fuck love. All I got for hoes is hard dick and bubblegum.","I punched this transhumanist in the ripcage and kicked her in the stomach"],answers:[jt("ok","close"),Xt()]}]},restrictedAreaCheck:{steps:[{text:["Hey you, stop it right there. This is a restricted area.","Identify yourself"],answers:[Xt(),jt("[show id card]",1,(t=>(e,i)=>{return e.getComponent(i,"inventory").content.some(i=>e.getComponent(i,"item").type===t)})("idCard"))]},{text:["Ok, you can pass"],answers:[jt("ok","authorized")]}]}};function $t(t,e,i){const r=t.createEntity().withComponent("triggered-by",{entity:e}).withComponent("dialog",{type:i}).entity;t.getComponent(e,"triggers").entities.push(r)}function Gt(t,e,i){return{head:{type:"head",itemAttachments:["helmet"],health:e},leftArm:{type:"arm",itemAttachments:["glove","weapon"],health:i},rightArm:{type:"arm",itemAttachments:["glove","weapon"],health:i},torso:{type:"torso",itemAttachments:["armor"],health:t},leftLeg:{type:"leg",itemAttachments:["pants","boots"],health:i},rightLeg:{type:"leg",itemAttachments:["pants","boots"],health:i}}}const Zt={player:{bodyParts:Gt(14,5,5),strength:5,movement:3,actions:4,aim:10},guard:{bodyParts:Gt(3,1,1),strength:5,movement:3,actions:3,aim:6},eliteGuard:{bodyParts:Gt(5,3,3),strength:8,movement:2,actions:5,aim:6},boss:{bodyParts:Gt(8,5,5),strength:10,movement:3,actions:9,aim:8}},Jt={player:t=>(function(t){const e=ne(t,"you","player","player",Qt);return t.editEntity(e).withComponent("player",{}).withComponent("fov",{fov:[]}).withComponent("viewport-focus",{}),ee(t,e,"rifle"),ee(t,e,"bootsOfStriding"),ie(t,e,"nailGun",["leftArm"]),ie(t,e,"leatherJacket",["torso","leftArm","rightArm"]),e})(t),eliteGuard:t=>{const e=te(t,"some elite guard","eliteGuard","eliteGuard");return $t(t,e,"guardRandomRemarks"),e},guard:t=>{const e=te(t,"some guard","guard","guard");return $t(t,e,"guardRandomRemarks"),e}},Qt=["longMove","hit","rush","endTurn"];function te(t,e,i,r){const n=re(t,e,i,r,Qt);return ie(t,n,"rifle",["leftArm"]),n}function ee(t,e,i){const r=t.createEntity().withComponent("item",{type:i}).entity;return t.getComponent(e,"inventory").content.push(r),r}function ie(t,e,i,r){const n=ee(t,e,i);t.getComponent(e,"equiped-items").equipment.push({entity:n,bodyParts:r})}function re(t,e,i,r,n){const o=ne(t,e,i,r,n);return t.editEntity(o).withComponent("npc",{}).withComponent("ai",{type:"rushing",state:"idle",interest:void 0,distrust:0}).withComponent("inventory",{content:[]}).withComponent("equiped-items",{equipment:[]}).entity}function ne(t,e,i,r,n){return t.createEntity().withComponent("has-action",{actions:n}).withComponent("triggers",{entities:[],type:"dialog",name:e}).withComponent("feature",{feature:()=>zt[r]}).withComponent("character-stats",Vt(i)).withComponent("active-effects",{effects:[]}).entity}const oe=Jt;class se{constructor(t,e){this.content=t,this.state={focus:e,enemies:[]}}render(t){let e=new _([0,0]);const i=new _([0,1]),r=new _([15,0]);if(void 0!==this.state.stats){const n=this.state.stats;Object.keys(n.current.bodyParts).forEach(r=>{!function(t,e,i,r,n){const o=r.current.bodyParts[i].health,s=Zt[r.type].bodyParts[i].health,a=Math.ceil(5*o/s),l=`${i}${" ".repeat(8-i.length)}${"|".repeat(a)}`,u=n.effects.filter(t=>t.bodyPart===i&&!t.effect.global).map(t=>t.effect.type[0]),h=u.length>0||a<=2?Lt[3]:Lt[1];t.text(l,e,h),u.forEach((i,r)=>{t.text(i,e.add(new _([r+14,0])),Lt[2])})}(t,this.content.topLeft.add(e),r,n,this.state.activeEffects),e=e.add(i)});const o=this.state.activeEffects.effects.filter(t=>t.effect.global).map(t=>t.effect.type[0]).join();t.text("effects",this.content.topLeft.add(e),Lt[1]),t.text(`${o}`,this.content.topLeft.add(e).add(r),Lt[2]),e=e.add(r.mult(2))}if(e=new _([e.x,0]),void 0!==this.state.stats&&void 0!==this.state.takeTurn){const r=this.state.stats.current;t.text(`${this.state.takeTurn.actions}/${r.actions} AP ${this.state.takeTurn.movements}/${r.movement} MP`,this.content.topLeft.add(e),Lt[1]),e=e.add(i),this.state.enemies.forEach(r=>{if(void 0!==r.feature){const n=this.content.topLeft.add(e);t.character(r.feature().character,n,r.feature().diffuse),t.text(r.feature().name,n.add(new _([3,0])),Lt[1]),e=e.add(i)}})}if(void 0!==this.state.lighting){const r=Dt(this.state.lighting);t.text(`brightness: ${r}`,this.content.topLeft.add(e),Lt[1]),e=e.add(i)}}update(t){this.state.takeTurn=t.getComponent(this.state.focus,"take-turn"),this.state.enemies=[],t.getStorage("took-turn").foreach(e=>{const i=t.getComponent(e,"feature")||{feature:void 0};this.state.enemies.push({feature:i.feature})}),t.getStorage("wait-turn").foreach(e=>{const i=t.getComponent(e,"feature")||{feature:void 0};this.state.enemies.push({feature:i.feature})}),this.state.activeEffects=t.getComponent(this.state.focus,"active-effects"),this.state.stats=t.getComponent(this.state.focus,"character-stats"),this.state.lighting=t.getComponent(this.state.focus,"lighting")}}class ae{constructor(t){this.focus=t,this.key="overview",this.name="overview",this.shortName="u",this.command="overview",this.minimizedHint="log"}setFull(t){this.full=new se(t,this.focus)}setMinimized(t){this.minimized=new se(t,this.focus)}}class le extends m{constructor(t,e){super(),this.baseShape=t,this.subtractionShape=e}static innerBorder(t){return new le(t,t.shrink())}bounds(){return this.baseShape.bounds()}containsVector(t){return this.baseShape.containsVector(t)&&!this.subtractionShape.containsVector(t)}grow(t=1){return new le(this.baseShape.grow(t),this.subtractionShape.grow(t))}shrink(t=1){return new le(this.baseShape.shrink(t),this.subtractionShape.shrink(t))}translate(t){return new le(this.baseShape.translate(t),this.subtractionShape.translate(t))}all(t){return this.bounds().all(e=>!this.containsVector(e)||t(e))}}class ue{constructor(t,e,i=!1){this.rectangle=t,this.title=e,this.bottomCollapse=i}get topLeft(){return this.rectangle.topLeft}get right(){return this.rectangle.right}get bottom(){return this.rectangle.bottom}get content(){return this.rectangle.shrink()}containsVector(t){return this.rectangle.containsVector(t)}get width(){return this.rectangle.width}render(t){le.innerBorder(this.rectangle).foreach(e=>{e.y===this.rectangle.top||e.y===this.rectangle.bottom?t.character("-",e,Lt[1]):t.character("|",e,Lt[1])});const e=`/${this.title}/`;t.text(e,{x:this.rectangle.right-e.length,y:this.rectangle.top},Lt[1])}update(t){}}function he(t){const e=[];for(let i=0;i<t;i++)e.push(i);return e}function ce(t,e){t[e]=t[t.length-1],t.pop()}function fe(t,e,i,r,n,o){return{kind:"weapon",name:t,description:e,actions:n,effects:r,weight:i,attachments:o}}function de(t,e,i,r){return{kind:"consumable",attachments:0,actions:["consume"],name:t,description:e,effects:r,weight:i}}function me(t,e,i,r,n,o,s){return{kind:t,name:e,description:i,actions:o,effects:n,weight:r,attachments:s}}const pe={nailGun:fe("nail gun","a tool to drive nails into wood, control panels or bodies.",5,[],["overcharge","hitAndRun","bolt"],1),rifle:fe("rifle","a regular rifle.",5,[],["shoot"],2),sniperRifle:fe("sniper rifle","",6,[],["headshot","shoot"],2),deathPill:de("death pill","a pill that kills you",1,[{type:"kill",global:!0,negated:!1}]),bandages:de("bandages","a bandage to stop bleeding",1,[{type:"bleed",global:!1,negated:!0}]),leatherJacket:me("armor","leather jacket","a nice leather jacket",3,[{type:"defend",global:!1,negated:!1,value:1}],["tighten"],1),bootsOfStriding:me("boots","boots of striding","Original Boots Of Striding TM, authentic D&D merch but not at all mint anymore",3,[],["strideAndSlip"],2),idCard:function(t,e){return{kind:"scrap",attachments:0,actions:[],name:t,description:e,effects:[],weight:0}}("id card","id card")};function ge(t,e){const i=t.getComponent(e,"inventory"),r=t.getComponent(e,"character-stats"),n=t.getComponent(e,"equiped-items")||{equipment:[]};let o=void 0;void 0!==r&&(o=function(t){return 5*t.current.strength}(r));const s=i.content.map(e=>{const i=t.getComponent(e,"item");return pe[i.type]}),a=i.content.map(e=>{const i=t.getComponent(e,"item");return pe[i.type].weight}).reduce((t,e)=>t+e,0);return{inventory:i,items:s,maximumWeight:o,currentWeight:a,equipment:n.equipment}}class _e{constructor(t){this.state=t,this.closed=!1}render(t){const{leftWindow:e,rightWindow:i,leftInventory:r,rightInventory:n,leftActive:o,hovered:s}=this.state;this.renderInventory(t,e,r,o,o?s:void 0),this.renderInventory(t,i,n,!o,o?void 0:s)}renderInventory(t,e,i,r,n){e.render(t);const o=i.items||[];let s=0;if(o.forEach(i=>{const o=r?`${s+1} `:"";t.text(`${o}${i.name} (${i.weight})`,e.content.topLeft.add(new _([0,s])),Lt[1],n===s?Pt[1]:void 0),s++}),void 0!==i.maximumWeight){const r=`${i.currentWeight}/${i.maximumWeight}`;t.text(r,e.content.bottomRight.add(new _([-r.length,1])),Lt[1])}}update(t){this.state.leftInventory=ge(t,this.state.left),this.state.rightInventory=ge(t,this.state.right);const e=t.getResource("input");let i;e.position&&(i=new _([e.position.x,e.position.y])),e.isActive("cancel")&&(this.closed=!0);const r=e.isActive("up"),n=e.isActive("down"),o=e.isActive("right"),s=e.isActive("left");r&&this.state.hovered--,n&&this.state.hovered++,(o||s)&&(this.state.leftActive=!this.state.leftActive);const a=this.state.leftActive?this.state.leftInventory:this.state.rightInventory,l=this.state.leftActive?this.state.rightInventory:this.state.leftInventory;a.inventory.content.length>0?(this.state.hovered+=a.inventory.content.length,this.state.hovered%=a.inventory.content.length):(this.state.leftActive=!this.state.leftActive,this.state.hovered=0);let u=void 0;if(e.isActive("accept")&&(u=this.state.hovered),i){const t=this.state.leftWindow.content.containsVector(i),r=this.state.rightWindow.content.containsVector(i);if(t||r){let r;this.state.leftActive=t,r=t?i.minus(this.state.leftWindow.content.topLeft):i.minus(this.state.rightWindow.content.topLeft),e.mousePressed&&(u=r.y),this.state.hovered=r.y}}const h=e.numericActive();void 0!==h&&(u=h),void 0!==u&&this.transfer(a,l,u)}transfer(t,e,i){const r=t.items[i];void 0!==r&&(void 0===e.maximumWeight||e.currentWeight+r.weight<=e.maximumWeight)&&(e.inventory.content.push(t.inventory.content[i]),ce(t.inventory.content,i))}contains(t){return this.state.leftWindow.containsVector(t)||this.state.rightWindow.containsVector(t)}}class ve{constructor(t,e){this.command=t,this.position=e,this.clicked=!1,this.hovered=!1,this.text="",this.bounds=new v(this.position.x,this.position.y,0,1)}setText(t){this.text=t,this.bounds=new v(this.position.x,this.position.y,t.length,1)}update(t){const e=t.getResource("input");if(e.position){const t=new _([e.position.x,e.position.y]);this.hovered=this.bounds.containsVector(t),this.hovered&&e.mousePressed?this.clicked=!0:this.clicked=!1}else this.hovered=!1,this.clicked=!1;e.isActive(this.command)&&(this.clicked=!0)}render(t){t.text(`${this.command+1} ${this.text}`,this.position,Lt[1],this.hovered?Pt[1]:void 0)}}class be{constructor(t,e){this.content=t,this.state={focus:e},this.button=new ve(0,this.content.bottomLeft),this.itemSelector=new Nt([])}render(t){if(void 0!==this.state.inventory){const e=this.state.inventory;void 0===this.selectedItemIndex?this.renderInventory(t,e,this.itemSelector.hoveredIndex):this.renderDescription(t,e,this.selectedItemIndex)}}renderInventory(t,e,i){const r=e.items||[];let n=0;r.forEach(e=>{t.text(`${n+1} ${e.name}`,this.content.topLeft.add(new _([0,n])),Lt[1],i===n?Pt[1]:void 0),n++}),void 0!==e.maximumWeight&&t.text(`weight: ${e.currentWeight}/${e.maximumWeight}`,this.content.bottomLeft,Lt[1])}renderDescription(t,e,i){const r=e.inventory.content[i],n=(e.items||[])[i];let o=0;if(void 0!==n&&(o+=t.flowText(`${n.description}`,this.content.topLeft.add(new _([0,o])),this.content.width,Lt[1]),o+=t.flowText("actions: "+n.actions.join(", "),this.content.topLeft.add(new _([0,o])),this.content.width,Lt[1]),n.attachments>0)){const i=void 0!==e.equipment.find(t=>t.entity===r)?"unequip":"equip";this.button.setText(i),this.button.render(t)}}update(t){if(void 0===this.selectedItemIndex){this.state.inventory=ge(t,this.state.focus),this.itemSelector.setItems(this.state.inventory.items),this.itemSelector.update(t,this.content),void 0!==this.itemSelector.selected&&(this.selectedItemIndex=this.itemSelector.selectedIndex)}else{t.getResource("input").isActive("cancel")?this.selectedItemIndex=void 0:(this.button.update(t),this.button.clicked&&this.equip(t))}}equip(t){const e=this.state.inventory,i=e.inventory.content[this.selectedItemIndex],r=(e.items||[])[this.selectedItemIndex];if(r.attachments>0){const n=t.getComponent(this.state.focus,"equiped-items"),o=e.equipment.findIndex(t=>t.entity===i);if(o>=0)ce(n.equipment,o);else{const e=t.getComponent(this.state.focus,"character-stats"),o=[];Object.keys(e.current.bodyParts).forEach(t=>{e.current.bodyParts[t].itemAttachments.filter(t=>t===r.kind).forEach(()=>o.push(t))}),n.equipment.forEach(e=>{const i=t.getComponent(e.entity,"item");pe[i.type].kind===r.kind&&e.bodyParts.forEach(t=>{const e=o.findIndex(e=>e===t);e>=0&&ce(o,e)})});const s=new Set(o);if(s.size>=r.attachments){const t=[];s.forEach(e=>{t.length<r.attachments&&t.push(e)}),n.equipment.push({entity:i,bodyParts:t})}}}}}class ye{constructor(t,e){this.content=t;const i=Math.floor(t.width/2);this.inventoryContent=new v(t.left,t.top,i,t.height),this.state={focus:e}}render(t){if(void 0!==this.state.inventory){const e=this.state.inventory;this.renderInventory(t,this.inventoryContent,e)}}renderInventory(t,e,i){const r=i.items||[];let n=0;r.forEach(i=>{t.text(`${i.name}`,e.topLeft.add(new _([0,n])),Lt[1]),n++}),void 0!==i.maximumWeight&&t.text(`inventory (${i.currentWeight}/${i.maximumWeight})`,e.topLeft.add(new _([0,n])),Lt[1])}update(t){this.state.inventory=ge(t,this.state.focus)}}class we{constructor(t){this.focus=t,this.key="inventory",this.name="inventory",this.shortName="i",this.command="inventory",this.minimizedHint="overview"}setFull(t){this.full=new be(t,this.focus)}setMinimized(t){this.minimized=new ye(t,this.focus)}}class Ee{constructor(t,e){this.window=t,this.options=e,this.closed=!1,this.selector=new Nt(this.options)}render(t){this.window.render(t);const e=this.options||[];let i=0;e.forEach((e,r)=>{t.text(`${r+1} ${e.description}`,this.window.content.topLeft.add(new _([0,i])),Lt[1],this.selector.hoveredIndex===r?Pt[1]:void 0),i++})}update(t){this.selector.update(t,this.window.content),void 0!==this.selector.selected&&(this.closed=!0)}contains(t){return this.window.containsVector(t)}}class ke{constructor(t,e){this.mainTab=void 0,this.minimizedTab=void 0,this.tabs=[],this.focusTab=void 0,this.mainTabWindow=new ue(t,"tabs"),this.minimizedTabWindow=new ue(e,"tabs")}add(t){this.tabs.push(t),void 0===this.mainTab&&this.setTab(t),t.setFull(this.mainTabWindow.content),t.setMinimized(this.minimizedTabWindow.content)}setFocusTab(t){this.focusTab=t,this.setTab(t),t.setFull(this.mainTabWindow.content),t.setMinimized(this.minimizedTabWindow.content)}reset(){this.focusTab=void 0,this.setTab(this.tabs[0])}render(t){this.mainTabWindow.render(t),this.minimizedTabWindow.render(t),void 0!==this.mainTab&&this.mainTab.full.render(t),void 0!==this.minimizedTab&&this.minimizedTab.minimized.render(t)}update(t){const e=t.getResource("input");this.mainTabWindow.update(e),(void 0!==this.focusTab?[this.focusTab,...this.tabs]:this.tabs).forEach(t=>{e.isActive(t.command)&&this.setTab(t)}),void 0!==this.mainTab&&this.mainTab.full.update(t),void 0!==this.minimizedTab&&this.minimizedTab.minimized.update(t)}contains(t){return this.mainTabWindow.containsVector(t)}setTab(t){this.mainTab=t;const e=void 0!==this.focusTab?[this.focusTab,...this.tabs]:this.tabs;this.minimizedTab=e.find(e=>e.key===t.minimizedHint)||t,this.mainTabWindow.title=e.map(t=>this.mainTab===t?t.name:t.shortName).join("/"),this.minimizedTabWindow.title=this.minimizedTab.name}}class Se{constructor(t){this.content=t,this.entries=[]}render(t){const e=this.content.topLeft;this.entries.forEach((i,r)=>{t.text(i,e.add(new _([0,r])),Lt[1])})}update(t){const e=t.getResource("log");this.entries=e.getEntries(0,this.content.height)}}class Me{constructor(){this.key="log",this.name="log",this.shortName="o",this.command="log",this.minimizedHint="overview"}setFull(t){this.full=new Se(t)}setMinimized(t){this.minimized=new Se(t)}}class Ae{constructor(t,e,i,r){this.content=t,this.target=e,this.queries=i,this.movement=r,this.isSelected=!1}render(t){void 0!==this.targetFeature&&t.text(this.targetFeature.feature().name,this.content.topLeft,Lt[0])}get selected(){if(this.isSelected)return this.path}get hovered(){return this.path}get length(){return void 0===this.path?0:this.path.cost}update(t){const e=t.getResource("input"),i=t.getResource("map"),r=t.getResource("viewport");if(void 0!==e.position){const n=r.fromDisplay(e.position),o=t.getComponent(this.target,"position"),s=i.levels[o.level],a=this.queries.shortestPath(t,o.level,o.position,n,{maximumCost:this.movement.range,onlyDiscovered:!0});void 0!==a&&a.path.forEach(e=>{const i=s.getTile(e);t.editEntity(i).withComponent("overlay",{background:Lt[2]})});const l=i.levels[o.level].getTile(n);void 0!==l&&(this.targetFeature=t.getComponent(l,"feature")),this.path=a,e.mousePressed&&(this.isSelected=e.mousePressed)}}}class Te{constructor(t,e,i){this.target=t,this.queries=e,this.movement=i,this.key="movementSelector",this.name="select a location to move to",this.shortName="q",this.command="focus",this.minimizedHint="overview"}setFull(t){this.full=new Ae(t,this.target,this.queries,this.movement)}setMinimized(t){this.minimized=new Ae(t,this.target,this.queries,this.movement)}get selected(){if(void 0!==this.full)return this.full.selected}get hovered(){if(void 0!==this.full)return this.full.hovered}get length(){return 1}}class Ce{constructor(t,e,i,r){this.content=t,this.target=e,this.queries=i,this.range=r,this.isSelected=!1,this.enemies=[]}render(t){this.enemies.forEach(e=>{t.text(e.feature().name,this.content.topLeft,Lt[0])})}get selected(){if(this.isSelected)return this.path}get hovered(){return this.path}get length(){return void 0===this.path?0:this.path.cost}update(t){const e=t.getResource("input"),i=t.getResource("map"),r=t.getResource("viewport");if(void 0!==e.position){const n=r.fromDisplay(e.position),o=t.getComponent(this.target,"position"),s=this.queries.ray(t,o.level,o.position,n,{maximumCost:this.range});if(void 0!==s){const r=i.levels[o.level];s.path.forEach(e=>{const i=r.getCharacter(e);if(void 0!==i&&i!==this.target)t.editEntity(i).withComponent("overlay",{background:Lt[3]}),this.enemies.push(t.getComponent(i,"feature"));else{const i=r.getTile(e);t.editEntity(i).withComponent("overlay",{background:Lt[1]})}}),this.path=s,e.mousePressed&&(this.isSelected=e.mousePressed)}}}}class xe{constructor(t,e,i){this.target=t,this.queries=e,this.range=i,this.key="attackSelector",this.name="select an enemy target",this.shortName="q",this.command="focus",this.minimizedHint="overview"}setFull(t){this.full=new Ce(t,this.target,this.queries,this.range)}setMinimized(t){this.minimized=new Ce(t,this.target,this.queries,this.range)}get selected(){if(void 0!==this.full)return this.full.selected}get hovered(){if(void 0!==this.full)return this.full.hovered}get length(){return 1}}class Re{constructor(t,e,i,r,n,o){this.random=e,this.window=i,this.dialog=r,this.player=n,this.npc=o,this.closed=!1,this.result=void 0,this.currentText="",this.currentAnswers=[],this.selectY=0,this.select(t,0)}render(t){this.window.render(t);let e=t.flowText(this.currentText,this.window.content.topLeft,this.window.width,Lt[1])+1;void 0!==this.selector&&(this.selectY=e,this.currentAnswers.forEach((i,r)=>{t.text(`${r+1} ${i.text}`,this.window.content.topLeft.add(new _([0,e])),Lt[1],this.selector.hoveredIndex===r?Pt[1]:void 0),e++}))}update(t){if(void 0===this.selector&&(this.selector=new Nt(this.currentAnswers)),this.selector.update(t,new v(this.window.content.x,this.window.content.y+this.selectY,this.window.content.width,this.currentAnswers.length)),void 0!==this.selector.selected){const e=this.selector.selected.navigation;"number"==typeof e?this.select(t,e):(this.closed=!0,this.result=e)}}select(t,e){const i=this.dialog.steps[e];this.currentText=this.random.pick(i.text),this.currentAnswers=i.answers.filter(e=>void 0===e.check||e.check(t,this.player,this.npc)),this.selector=void 0}contains(t){return this.window.containsVector(t)}}class Oe{constructor(t,e){this.name=t,this.usedSystems=e}start(t){t.activeSystems.forEach(e=>t.disableSystem(e)),this.usedSystems.forEach(e=>t.enableSystem(e))}stop(t){}isDone(t){return void 0===this.usedSystems.find(e=>!t.emptySystems.has(e))}}class Le extends Oe{constructor(t){super("modal",t.filter(t=>"free-mode-control"!==t&&"player-control"!==t&&"player-round-control"!==t&&"player-interaction"!==t))}update(t){}isDone(t){return!t.getResource("ui").isModal}isFrameLocked(){return!0}}function Pe(t,e,i,r,n,o,s){const a=t.dialogResult();return t.dialogShowing()?void 0!==a&&t.hideDialogModal():(t.showDialogModal(e,i,r,n,o),s(new Le(e.activeSystemsList()))),a}const Ne=15;class Ie{constructor(){this.kind="ui",this.visibleElements=[],this.isModal=!1,this.inventoryTransferModal=void 0,this.multipleChoiceModal=void 0,this.dialogModal=void 0,this.tabs=void 0,this.actionSelector=void 0,this.movementSelector=void 0,this.attackSelector=void 0}update(t){this.isModal&&(void 0!==this.inventoryTransferModal?(this.inventoryTransferModal.update(t),this.inventoryTransferModal.closed&&this.hideInventoryTransferModal()):void 0!==this.multipleChoiceModal?(this.multipleChoiceModal.update(t),this.multipleChoiceModal.closed&&(this.isModal=!1)):void 0!==this.dialogModal&&(this.dialogModal.update(t),this.dialogModal.closed&&(this.isModal=!1))),void 0!==this.tabs&&this.tabs.update(t)}render(t){void 0!==this.tabs&&this.tabs.render(t),void 0!==this.inventoryTransferModal?this.inventoryTransferModal.render(t):void 0!==this.multipleChoiceModal?this.multipleChoiceModal.render(t):void 0!==this.dialogModal&&this.dialogModal.render(t)}reset(){this.inventoryTransferModal=void 0,void 0!==this.tabs&&this.tabs.reset()}createTabs(t,e){const i=t.getResource("viewport"),r=new v(0,i.boundaries.y-12,i.boundaries.x,12),n=new v(i.boundaries.x-20,0,20,9);this.tabs=new ke(r,n),this.tabs.add(new Me),this.tabs.add(new we(e)),this.tabs.add(new ae(e))}showInventoryTransferModal(t,e,i,r,n){this.isModal=!0;const o=t.getResource("viewport"),s=new ue(new v(o.boundaries.x/2-30,o.boundaries.y/2-Ne,30,20),i),a=new ue(new v(o.boundaries.x/2,o.boundaries.y/2-Ne,30,20),n);this.inventoryTransferModal=new _e({left:e,right:r,leftWindow:s,rightWindow:a,leftActive:!0,hovered:0})}inventoryTransferModalShowing(){return void 0!==this.inventoryTransferModal}hideInventoryTransferModal(){void 0!==this.inventoryTransferModal&&(this.inventoryTransferModal=void 0)}showMultipleChoiceModal(t,e,i){this.isModal=!0;const r=t.getResource("viewport"),n=new ue(new v(r.boundaries.x/2-20,r.boundaries.y/2-Ne,40,10),e);this.multipleChoiceModal=new Ee(n,i)}selectedOption(){if(void 0!==this.multipleChoiceModal){const t=this.multipleChoiceModal.selector.selected;if(void 0!==t)return t.entity}}multipleChoiceModalShowing(){return void 0!==this.multipleChoiceModal}hideMultipleChoiceModal(){void 0!==this.multipleChoiceModal&&(this.multipleChoiceModal=void 0)}showDialogModal(t,e,i,r,n){this.isModal=!0;const o=t.getResource("viewport"),s=new ue(new v(o.boundaries.x/2-20,o.boundaries.y/2-Ne,40,10),"dialog");this.dialogModal=new Re(t,e,s,Yt[i],r,n)}dialogResult(){if(void 0!==this.dialogModal)return this.dialogModal.result}dialogShowing(){return void 0!==this.dialogModal}hideDialogModal(){void 0!==this.dialogModal&&(this.dialogModal=void 0)}hideSelectors(){this.movementSelector=void 0,this.actionSelector=void 0,this.attackSelector=void 0,void 0!==this.tabs&&this.tabs.reset()}showActionSelector(t){void 0!==this.tabs&&void 0===this.actionSelector&&(this.actionSelector=new Ft(t),this.tabs.setFocusTab(this.actionSelector))}selectedAction(){if(void 0!==this.actionSelector)return this.actionSelector.selected}showMovementSelector(t,e,i){void 0!==this.tabs&&void 0===this.movementSelector&&(this.hideSelectors(),this.movementSelector=new Te(t,e,i),this.tabs.setFocusTab(this.movementSelector))}selectedMovement(){if(void 0!==this.movementSelector)return this.movementSelector.selected}showAttackSelector(t,e,i){void 0!==this.tabs&&void 0===this.attackSelector&&(this.hideSelectors(),this.attackSelector=new xe(t,e,i),this.tabs.setFocusTab(this.attackSelector))}selectedAttack(){if(void 0!==this.attackSelector)return this.attackSelector.selected}hasElement(t){return this.isModal&&(void 0!==this.inventoryTransferModal&&this.inventoryTransferModal.contains(t)||void 0!==this.multipleChoiceModal&&this.multipleChoiceModal.contains(t)||void 0!==this.dialogModal&&this.dialogModal.contains(t))||void 0!==this.tabs&&this.tabs.contains(t)}}class Fe extends Oe{constructor(){super("fighting",["start-round","player-round-control","ai-round-control","fov","light","npc","script","effect"]),this.wasGridLocked=!0}start(t){super.start(t);let e=t.getStorage("player").first();this.setNextEntity(t,e);const i=t.getResource("viewport");this.wasGridLocked=i.gridLocked,i.gridLocked=!0}stop(t){super.stop(t),t.getResource("viewport").gridLocked=this.wasGridLocked}update(t){if(0===t.getStorage("start-turn").size()&&0===t.getStorage("take-turn").size()){let e=t.getStorage("wait-turn").first();void 0===e&&(this.newRound(t),e=t.getStorage("wait-turn").first()),this.setNextEntity(t,e)}}isDone(t){const e=function(t){const e=t.getStorage("player").first();return t.hasComponent(e,"dead")}(t),i=function(t){const e=t.getStorage("player").first();return void 0!==t.getComponent(e,"active-effects").effects.find(t=>"bleed"===t.effect.type)}(t),r=d(t)<=t.components.get("player").size();return e||r&&!i}newRound(t){t.getStorage("took-turn").foreach(e=>this.addToTurn(t,e)),t.getStorage("took-turn").clear()}addToTurn(t,e){t.editEntity(e).withComponent("wait-turn",{})}setNextEntity(t,e){t.editEntity(e).withComponent("start-turn",{}).removeComponent("wait-turn")}isFrameLocked(){return!0}}function De(t,e,i,r){const n=d(t)>0;i.state="engaging",t.editEntity(e).withComponent("wait-turn",{}),n||r(new Fe)}function Ve(t,e,i){const r=t.getResource("map").levels[e.level].getStructure(e.position),n=t.getComponent(r,"structure");return t.getComponent(n.region,"region").authorized.has(i)}class Be{constructor(t,e,i){this.queries=t,this.random=e,this.pushState=i,this.components=["npc","ai","position"]}update(t,e){const i=t.getComponent(e,"position"),r=t.getComponent(e,"ai"),n=t.getResource("ui");"idle"!==r.state||n.isModal||(void 0===r.interest?this.findInterest(t,r,i):this.tryToAuthorizeInterest(t,r,i),this.confrontInterest(t,e,r,i))}findInterest(t,e,i){t.getStorage("player").foreach(r=>{if(!Ve(t,i,r)){const n=t.getComponent(r,"position");if(void 0!==n&&n.level===i.level&&n.position.minus(i.position).l1()<10){void 0!==this.queries.ray(t,i.level,i.position,n.position,{})&&(e.interest=r)}}})}tryToAuthorizeInterest(t,e,i){Ve(t,i,e.interest)&&(e.interest=void 0,e.distrust=0)}confrontInterest(t,e,i,r){if(void 0!==i.interest){if(d(t)>0)De(t,e,i,this.pushState);else if(i.distrust>9){const n=Pe(t.getResource("ui"),t,this.random,"restrictedAreaCheck",i.interest,e,this.pushState);void 0!==n&&("authorized"===n?(!function(t,e,i){const r=t.getResource("map").levels[e.level].getStructure(e.position),n=t.getComponent(r,"structure");t.getComponent(n.region,"region").authorized.add(i)}(t,r,i.interest),i.interest=void 0,i.distrust=0):De(t,e,i,this.pushState))}else i.distrust+=1}}}class Ue{constructor(){this.components=["player","position","character-stats"]}update(t,e){const i=t.getComponent(e,"position"),r=t.getComponent(e,"character-stats"),n=t.getResource("input").createMovementDelta();if(n.squaredLength()>0){const o=i.position.add(n.mult(Bt(r))),s=t.getResource("map").levels[i.level];s.isBlocking(t,o,e)||(s.removeCharacter(i.position),s.setCharacter(o,e),t.editEntity(e).withComponent("position",{level:i.level,position:o}))}}}class Ke extends m{constructor(t,e){super(),this.f=t,this.boundary=e}static lN(t,e=1,i=!1){return Ke.fromMeasure(t,e,i,t=>t.lN()<=e)}static l1(t,e=1,i=!1){return Ke.fromMeasure(t,e,i,t=>t.l1()<=e)}static l2(t,e=1,i=!1){return Ke.fromMeasure(t,e,i,t=>t.squaredLength()<=e*e)}static fromMeasure(t,e,i,r){const n=v.centerAt(t.x,t.y,e);return new Ke(e=>{const n=e.minus(t).abs();return 0===n.fX&&0===n.fY?i:r(n)},n)}bounds(){return this.boundary}containsVector(t){return this.f(t)}translate(t){return new Ke(e=>this.f(e.add(t)),this.boundary.translate(t))}grow(){return this}shrink(){return this}all(t){return this.boundary.all(e=>!this.f(e)||t(e))}}class He{constructor(t){this.pushState=t,this.components=["player","position"]}update(t,e){const i=t.getResource("ui");let r;if(t.getResource("input").isActive("use")){const n=t.getResource("map"),o=t.getComponent(e,"position"),s=Ke.lN(o.position,1,!0),a=this.findTriggers(t,n,o.level,s);1===a.length?r=a[0].entity:a.length>1&&(i.showMultipleChoiceModal(t,"interact with",a),this.pushState(new Le(t.activeSystemsList())))}else i.multipleChoiceModalShowing()&&(r=i.selectedOption(),i.hideMultipleChoiceModal());void 0!==r&&t.editEntity(r).withComponent("active",{}).withComponent("triggered-by",{entity:e})}findTriggers(t,e,i,r){const n=new Set,o=[];return r.foreach(r=>{const s=e.levels[i].getTile(r);void 0!==s&&We(t,n,s,o);const a=e.levels[i].getCharacter(r);void 0!==a&&We(t,n,a,o)}),o}}function We(t,e,i,r){const n=function(t,e){if(void 0!==t.getComponent(e,"triggers"))return e;const i=t.getComponent(e,"triggered-by");if(void 0!==i&&void 0!==t.getComponent(i.entity,"triggers"))return i.entity;return}(t,i);if(void 0!==n&&!e.has(n)){e.add(n);const i=t.getComponent(n,"triggers");r.push({entity:n,description:i.name})}}function ze(t,e){const i=t.getComponent(e,"feature");if(i)return i.feature()}function qe(t,e,i,r,n){return je(t,e,i,r,()=>zt[n])}function je(t,e,i,r,n){if(void 0!==e.levels[i].getTile(r))throw new Error(`there is already a tile at ${r.key}`);const o=t.createEntity().withComponent("position",{level:i,position:r}).withComponent("feature",{feature:n}).entity;return e.levels[i].setTile(r,o),o}class Xe extends m{constructor(t,e){super(),this.a=t,this.b=e}bounds(){return this.a.bounds().intersect(this.b.bounds())}containsVector(t){return this.a.containsVector(t)&&this.b.containsVector(t)}grow(t=1){return new Xe(this.a.grow(t),this.b.grow(t))}shrink(t=1){return new Xe(this.a.shrink(t),this.b.shrink(t))}translate(t){return new Xe(this.a.translate(t),this.b.translate(t))}all(t){return this.bounds().all(e=>!this.containsVector(e)||t(e))}}class Ye{constructor(t){this.distribution=t}floatBetween(t,e){return this.distribution.sample()*(e-t)+t}integerBetween(t,e){const i=this.distribution.sample();return Math.floor(i*(e-t+1))+t}decision(t){return this.distribution.sample()<t}weightedDecision(t){const e=t.reduce((t,e)=>t+e,0),i=this.integerBetween(0,e-1);let r=0;for(let e=0;e<t.length;e++)if(i<(r+=t[e]))return e;throw new Error("invalid input to weighted decision")}pick(t){return t[this.integerBetween(0,t.length-1)]}pickIndex(t){return this.integerBetween(0,t.length-1)}shuffle(t){for(let e=t.length-1;e>=0;e--){const i=this.integerBetween(0,e),r=t[e];t[e]=t[i],t[i]=r}}insideRectangle(t){return new _([this.integerBetween(t.left,t.right),this.integerBetween(t.top,t.bottom)])}}var $e=i(7);class Ge{constructor(t){this.rng=Object($e.create)(t)}sample(){return this.rng.random()}}class Ze{constructor(t,e=1){this.distribution=t,this.lambda=e,this.scale=1-Math.exp(-this.lambda)}static fromSeed(t,e=1){return new Ze(new Ge(t),e)}sample(){const t=this.distribution.sample();return-Math.log(1-this.scale*t)/this.lambda}}const Je=["up","right","down","left"];const Qe=new _([1,1]),ti=new _([1,1]),ei=new _([3,1]),ii=new _([2,2]);function ri(t,e,i,r){return{name:t,size:e,cover:i,hasInventory:!0,feature:r}}const ni={door:ri("metal door",ei,"full",()=>zt.door),locker:ri("a locker",Qe,"full",()=>zt.locker),trash:ri("some trash",Qe,"none",()=>zt.trash),loot:ri("a dead body",Qe,"none",()=>zt.loot),table:ri("a table",ti,"partial",()=>zt.table),generator:ri("a generator",ii,"full",qt.block)};function oi(t,e,i){const r=ni[t];return v.footprint(e,i,r.size)}function si(t,e,i,r,n){const o=ni[n],s=t.createEntity().withComponent("asset",{type:n}).withComponent("triggers",{name:o.name,type:"asset",entities:[]}).entity;return o.hasInventory&&t.editEntity(s).withComponent("inventory",{content:[]}),r.foreach((r,n)=>{const a=li(t,e,i,r,()=>o.feature(n));ui(t,a,s)}),s}function ai(t,e,i){t.getComponent(i,"triggers").entities.forEach(i=>(function(t,e,i){const r=t.getComponent(i,"ground"),n=t.getComponent(i,"position");e.levels[n.level].removeTile(n.position),je(t,e,n.level,n.position,r.feature),t.deleteEntity(i)})(t,e,i)),t.deleteEntity(i)}function li(t,e,i,r,n){const o=function(t,e,i,r){const n=e.levels[i].removeTile(r);if(void 0===n)throw new Error(`cannot build asset on missing ground at ${r.key}`);const o=t.getComponent(n,"feature");if(void 0===o||o.feature().blocking)throw new Error("cannot build asset on missing or blocking ground");return t.deleteEntity(n),o.feature}(t,e,i,r),s=t.createEntity().withComponent("position",{level:i,position:r}).withComponent("feature",{feature:n}).withComponent("ground",{feature:o}).entity;return e.levels[i].setTile(r,s),s}function ui(t,e,i){t.editEntity(e).withComponent("triggered-by",{entity:i}),t.getComponent(i,"triggers").entities.push(e)}var hi=i(2);function ci(t,e,i){let r=5;for(;e.length>0&&r>0;){const n=t.pickIndex(e);i(e[n])?(ce(e,n),r=5):r--}}const fi="_";function di(t=1,e){return{minimum:t,maximum:void 0===e?t:e}}function mi(t=1){return{minimum:0,maximum:t}}function pi(...t){return{types:t,occurrence:di()}}function gi(t,e){return{types:[t],occurrence:di(e)}}function _i(t,e){return{types:[t],occurrence:mi(e)}}function vi(t,e,i){const r=new Set(i.filter(t=>t.blocking).map(t=>t.embedding)),n=[],o=new Map;t.getStorage("structure").foreach((t,i)=>{i.region===e&&(o.set(t,n.length),n.push(t))});const s=he(n.length),a=[],l=[];return n.forEach((e,i)=>{const n=t.getComponent(e,"structure");l[i]=new Set,l[i].add(n.kind),r.has(e)&&l[i].add("blocked"),n.connections.forEach(t=>{const e=o.get(t.other),r=yi(i,e);void 0!==r&&a.push(r)})}),{V:s,E:a,labels:l,getData:t=>n[t]}}function bi(t){const e=[],i=[],r=[];return t.forEach(t=>{he(t.occurrence.minimum).forEach(()=>{const n=i.length;t.template.structures.forEach(t=>{const o=i.length;r[o]=new Set,(void 0===t.restriction.blocking||t.restriction.blocking)&&r[o].add("blocking"),t.restriction.exact&&r[o].add("exact"),t.restriction.kind&&(r[o].add("restricted"),r[o].add(t.restriction.kind)),(t.restriction.connects||[]).forEach(t=>{const i=yi(o,n+t);void 0!==i&&e.push(i)}),i.push(t.description)})})}),{V:he(i.length),E:e,labels:r,getData:t=>i[t]}}function yi(t,e){if(t<e)return[t,e]}function wi(t,e){var i=new hi.Solver;e.V.forEach(e=>{const r=t.V.map(t=>Ei(t,e));i.require(Object(hi.exactlyOne)(...r))}),t.V.forEach(t=>{const r=e.V.filter(t=>e.labels[t].has("blocking")).map(e=>Ei(t,e));i.require(Object(hi.atMostOne)(...r))}),e.V.forEach(r=>{t.V.forEach(n=>{const o=Ei(n,r);e.E.forEach(e=>{const s=ki(e,r);if(void 0!==s){const e=[];t.E.forEach(t=>{const i=ki(t,n);void 0!==i&&e.push(Ei(i,s))}),i.require(Object(hi.or)(Object(hi.not)(o),...e))}})})}),e.V.forEach(r=>{t.V.forEach(n=>{const o=Ei(n,r);let s=!1;t.labels[n].forEach(t=>{e.labels[r].has(t)||(s=!0)});const a=e.labels[r].has("restricted"),l=e.labels[r].has("exact"),u=t.labels[n].has("blocked");s&&a?i.require(Object(hi.not)(o)):u?i.require(Object(hi.not)(o)):l&&t.E.forEach(t=>{const s=ki(t,n);if(void 0!==s){const t=[];e.E.forEach(e=>{const i=ki(e,r);void 0!==i&&t.push(Ei(s,i))}),i.require(Object(hi.or)(Object(hi.not)(o),...t))}})})});const r=i.solve(),n=[];return null!==r&&r.getTrueVars().forEach(i=>{const[r,o]=function(t){const e=t.split(fi);return[Number.parseInt(e[0]),Number.parseInt(e[1])]}(i);n.push({structure:e.getData(o),embedding:t.getData(r),blocking:e.labels[o].has("blocking")})}),n}function Ei(t,e){return`${t}${fi}${e}`}function ki(t,e){return t[0]===e?t[1]:t[1]===e?t[0]:void 0}function Si(t){return t}const Mi={anEncounter:{structures:[{description:{decorations:[pi("trash")],containers:[pi("locker")],loots:[pi("nailGun","leatherJacket"),_i("bootsOfStriding")],npcs:[pi(oe.eliteGuard,oe.guard)],bosses:[pi(t=>{const e=re(t,"overseer","boss","eliteGuard",Qt);return $t(t,e,"guardRandomRemarks"),ee(t,e,"rifle"),ee(t,e,"bootsOfStriding"),ie(t,e,"nailGun",["leftArm"]),ie(t,e,"leatherJacket",["torso","leftArm","rightArm"]),e})]},restriction:Si({kind:"room"})}]},guardsStation:{structures:[{description:{decorations:[],containers:[gi("table",5)],loots:[pi("bandages","deathPill")],npcs:[gi(oe.eliteGuard,2),gi(oe.guard,3)],bosses:[]},restriction:Si({kind:"room",connects:[1]})},{description:{decorations:[],containers:[gi("locker",5)],loots:[gi("sniperRifle",5),gi("bandages",3),gi("leatherJacket",5)],npcs:[pi(oe.eliteGuard,oe.guard)],bosses:[]},restriction:Si({kind:"room",connects:[0],exact:!0})}]},generators:{structures:[{description:{decorations:[gi("generator",3)],containers:[_i("locker")],loots:[gi("bandages",2)],npcs:[],bosses:[]},restriction:Si({kind:"corridor"})}]}},Ai={red:[{occurrence:di(1,2),template:Mi.anEncounter},{occurrence:di(1),template:Mi.guardsStation},{occurrence:di(1,2),template:Mi.generators}]};function Ti(t,e,i,r,n,o){const s=t.getComponent(r,"structure"),a=[];o.containers.forEach(t=>a.push(...Ci(n,t)));const l=[];o.decorations.forEach(t=>l.push(...Ci(n,t)));const u=[];o.loots.forEach(t=>u.push(...Ci(n,t)));const h=[];o.npcs.forEach(t=>h.push(...Ci(n,t)));const c=function(t,e,i,r,n,o){const s=[];return ci(r,n,n=>{const a=r.pick(Je),l=function(t){switch(t){case"up":return"down";case"right":return"left";case"down":return"up";case"left":return"right"}}(a),u=o.centerOf(a),h=Math.floor(o.height/2),c=_.fromDirection(a).perpendicular().mult(r.integerBetween(-h,h)),f=oi(n,u.add(c),l),d=f.translate(_.fromDirection(a)),m=f.all(r=>e.levels[i].tileMatches(t,r,t=>void 0!==t&&(t.feature()===zt.room||t.feature()===zt.corridor))),p=d.all(r=>e.levels[i].tileMatches(t,r,t=>void 0===t||t.feature()===zt.wall));return m&&p&&s.push(si(t,e,i,f,n)),m}),s}(t,e,i,n,a,s.shape.bounds());if(function(t,e,i,r,n,o){const s=[];ci(r,n,n=>{const a=r.pick(Je),l=oi(n,new _([r.integerBetween(o.left,o.right),r.integerBetween(o.top,o.bottom)]),a),u=l.all(r=>xi(t,e,i,r));return u&&s.push(si(t,e,i,l,n)),u})}(t,e,i,n,l,s.shape.bounds()),function(t,e,i,r,n,o){const s=[];ci(r,n,n=>{const a=new _([r.integerBetween(o.left,o.right),r.integerBetween(o.top,o.bottom)]),l=xi(t,e,i,a);if(l){const r=n(t);e.levels[i].setCharacter(a,r),t.editEntity(r).withComponent("position",function(t,e){return{level:t,position:e.center}}(i,a)),s.push(r)}return l})}(t,e,i,n,h,s.shape.bounds()),c.length>0){u.map(e=>t.createEntity().withComponent("item",{type:e}).entity).forEach(e=>{const i=n.pick(c);t.getComponent(i,"inventory").content.push(e)})}}function Ci(t,e){const i=t.integerBetween(e.occurrence.minimum,e.occurrence.maximum),r=[];for(let n=0;n<i;n++)r.push(t.pick(e.types));return r}function xi(t,e,i,r){return e.levels[i].tileMatches(t,r,t=>void 0!==t&&(t.feature()===zt.room||t.feature()===zt.corridor))}class Ri{constructor(t){this.components=["active","region"],this.uniform=new Ye(t),this.exponential=new Ye(new Ze(t))}update(t,e){const i=t.getComponent(e,"region"),r=this.buildStructure(i.shape,8,15,3),n=t.getResource("map");this.renderCorridors(t,n,e,i.level,r),this.renderRooms(t,n,e,i.level,r),this.createConnections(t,n,i.level),i.entry=r.shape.bounds().centerLeft;const o=n.levels[i.level].getStructure(i.entry);this.fillStructure(t,n,i.level,e,o),t.editEntity(e).removeComponent("active")}fillStructure(t,e,i,r,n){if(t.getComponent(n,"structure").region===r){const n=t.getComponent(r,"region"),o=Ai[n.type];(function(t,e,i,r){const n=wi(vi(t,i,[]),bi(r.filter(t=>t.occurrence.minimum>0).map(t=>({occurrence:di(t.occurrence.minimum),template:t.template})))),o=[];return r.forEach(t=>{for(let e=0;e<t.occurrence.maximum-t.occurrence.minimum;++e)o.push({occurrence:di(),template:t.template})}),ci(e,o,e=>{const r=wi(vi(t,i,n),bi([e]));return 1===r.length&&n.push(r[0]),1===r.length}),n})(t,this.uniform,r,o).forEach(r=>Ti(t,e,i,r.embedding,this.uniform,r.structure))}}buildStructure(t,e,i,r){const n=t.bounds(),o=this.canSplit(n,t=>this.canCorridorSplit(t,i,r)),s=this.canSplit(n,t=>this.canRoomSplit(t,e));return o.length>0?this.corridorSplit(t,e,i,r,this.uniform.pick(o)):s.length>0?this.roomSplit(t,e,this.uniform.pick(s)):{kind:"room",shape:t,rooms:[]}}canSplit(t,e){const i=[];return e(t.width)&&i.push("x"),e(t.height)&&i.push("y"),i}canCorridorSplit(t,e,i){return t>=2*e+i}canRoomSplit(t,e){return t>=2*e}corridorSplit(t,e,i,r,n){const o=t.bounds(),s="x"===n?o.width:o.height,a=this.uniform.integerBetween(i,s-i),l=this.split3(o,n,a,3),u=new Xe(t,l[0]),h=new Xe(t,l[1]),c=new Xe(t,l[2]),f=this.buildStructure(u,e,i,r),d=this.buildStructure(c,e,i,r),m=[],p=[];return"room"===f.kind?p.push(f):m.push(f),"room"===d.kind?p.push(d):m.push(d),{kind:"corridor",shape:h,exits:m,rooms:p}}roomSplit(t,e,i){const r=t.bounds(),n="x"===i?r.width:r.height,o=this.uniform.integerBetween(e,n-e),s=this.split2(r,i,o);return this.uniform.shuffle(s),{kind:"room",shape:new Xe(t,s[0]),rooms:[{kind:"room",shape:new Xe(t,s[1]),rooms:[]}]}}split2(t,e,i){let r,n;return"x"===e?(r=v.fromBounds(t.left,t.left+i,t.top,t.bottom),n=v.fromBounds(r.right,t.right,t.top,t.bottom)):(r=v.fromBounds(t.left,t.right,t.top,t.top+i),n=v.fromBounds(t.left,t.right,r.bottom,t.bottom)),[r,n]}split3(t,e,i,r){let n,o,s;return"x"===e?(n=v.fromBounds(t.left,t.left+i,t.top,t.bottom),o=v.fromBounds(n.right+1,n.right+r,t.top,t.bottom),s=v.fromBounds(o.right+1,t.right,t.top,t.bottom)):(n=v.fromBounds(t.left,t.right,t.top,t.top+i),o=v.fromBounds(t.left,t.right,n.bottom+1,n.bottom+r),s=v.fromBounds(t.left,t.right,o.bottom+1,t.bottom)),[n,o,s]}renderCorridors(t,e,i,r,n){const o=t.createEntity().withComponent("structure",{kind:"corridor",shape:n.shape,connections:[],region:r}).entity;n.shape.foreach(r=>{qe(t,e,i,r,"corridor"),e.levels[i].setStructure(r,o)});for(let r=0;r<5;r++){const r=new Ot([this.uniform.integerBetween(100,255),this.uniform.integerBetween(100,255),this.uniform.integerBetween(100,255)]);h(t,e,i,this.uniform.insideRectangle(n.shape.bounds()),r)}n.exits.forEach(n=>this.renderCorridors(t,e,i,r,n))}renderRooms(t,e,i,r,n){n.rooms.forEach(n=>this.renderRoom(t,e,i,r,n)),n.exits.forEach(n=>this.renderRooms(t,e,i,r,n))}renderRoom(t,e,i,r,n){const o=n.shape.shrink(),s=t.createEntity().withComponent("structure",{kind:"room",shape:o,connections:[],region:r}).entity;o.foreach(r=>{qe(t,e,i,r,"room"),e.levels[i].setStructure(r,s)});for(let r=0;r<5;r++){const r=new Ot([this.uniform.integerBetween(100,255),this.uniform.integerBetween(100,255),this.uniform.integerBetween(100,255)]);h(t,e,i,this.uniform.insideRectangle(n.shape.bounds()),r)}const a=this.findPossibleDoors(t,e,i,n.shape.bounds());this.uniform.shuffle(a);const l=this.exponential.integerBetween(1,a.length);for(let r=0;r<l;++r){const n=a[r];n.foreach(r=>{qe(t,e,i,r,"corridor"),e.levels[i].setStructure(r,s)}),si(t,e,i,n,"door")}n.rooms.forEach(n=>this.renderRoom(t,e,i,r,n))}findPossibleDoors(t,e,i,r){const n=[];return Je.forEach(o=>{const s=oi("door",r.centerOf(o),o);s.translate(_.fromDirection(o)).all(r=>e.levels[i].tileMatches(t,r,t=>void 0!==t&&"wall"!==t.feature().name))&&n.push(s)}),n}createConnections(t,e,i){e.levels[i].boundary.foreach(r=>{const n=e.levels[i].getStructure(r);if(void 0!==n){const o=t.getComponent(n,"structure");Je.forEach(t=>{const s=r.add(_.fromDirection(t)),a=e.levels[i].getStructure(s);void 0!==a&&a!==n&&o.connections.push({position:s,other:a})})}})}}function Oi(t,e=["torso"]){return{type:"damage",global:!1,negated:!1,value:t,restricted:e}}function Li(t){return{type:"immobilize",global:!0,negated:!1,duration:t}}function Pi(t){return{kind:"movement",range:t}}function Ni(t,e,i){return{kind:"attack",range:t,accuracy:e,effects:i}}function Ii(t){return{kind:"status",effects:t}}var Fi;const Di={endTurn:{name:"end turn",cost:{actions:0,movement:0,costsAll:!0},subActions:[]},shortMove:{name:"move",cost:{actions:0,movement:2},subActions:[Pi(3)]},consume:{name:"consume",cost:{actions:1,movement:0},subActions:[]},longMove:{name:"move",cost:{actions:0,movement:2},subActions:[Pi(5)]},hit:{name:"hit",cost:{actions:2,movement:0},subActions:[Ni(1,8,[Oi(3)])]},strideAndSlip:{name:"stride and slip",cost:{actions:0,movement:3},subActions:[Pi(8),Ii([Li(1)])]},rush:{name:"rush",cost:{actions:2,movement:3,costsAll:!0},subActions:[Pi(8)]},shoot:{name:"shoot",cost:{actions:3,movement:0},subActions:[Ni(10,4,[Oi(5)])]},headshot:{name:"headshot",cost:{actions:4,movement:0},subActions:[Ni(20,10,[Oi(5,["head"])])]},overcharge:{name:"overcharge",cost:{actions:3,movement:0},attack:{},subActions:[Ni(8,4,[Oi(3),Li(1)])]},bolt:{name:"bolt",cost:{actions:3,movement:0},subActions:[Ni(1,5,[Oi(2,["head"]),(Fi=1,{type:"stun",global:!0,negated:!1,duration:Fi})])]},hitAndRun:{name:"hit and run",cost:{actions:3,movement:3},subActions:[Ni(1,4,[Oi(3),function(t){return{type:"confuse",global:!0,negated:!1,duration:t}}(1)]),Pi(6)]},tighten:{name:"tighten",cost:{actions:1,movement:0},subActions:[Ii([function(t,e){return{type:"defend",global:!0,negated:!1,duration:e,value:t}}(2,1)])]}};function Vi(t,e,i){const r=function(t,e,i){return{items:Bi(t.getComponent(e,"has-action").actions,i),name:"player",description:"actions you can do without any equipment",entity:e}}(t,e,i);return function(t,e,i){return t.getComponent(e,"equiped-items").equipment.map(e=>{const r=pe[t.getComponent(e.entity,"item").type];return{items:Bi(r.actions,i),description:r.description,name:r.name,entity:e.entity}})}(t,e,i).concat(r)}function Bi(t,e){return t.map(t=>{const i=Di[t];return{action:i,available:i.cost.actions<=e.actions&&i.cost.movement<=e.movements}})}function Ui(t,e,i,r,n){const o=function(t,e,i,r){const n=t.getComponent(e,"character-stats"),o=t.getComponent(e,"position"),s=t.getComponent(i,"position"),a=new _([o.position.fX-s.position.fX,o.position.fY-s.position.fY]).lN(),l=Math.floor(10*(a-1)/r.range),u=Dt(c(t,i)),h=n.current.aim+r.accuracy,f=u>5?0:u>3?3:4,d=l<5?0:l<7?2:3;return console.log(`(10 * ${a} - 1)  / ${r.range}`),console.log(`${n.current.aim} + ${r.accuracy} - ${f} - ${d}`),(h-d-f)/10}(t,i,r,n),s=t.getResource("log");s.attack(t,i,r,n),e.decision(o)?n.effects.forEach(n=>{const o=function(t,e,i,r){if(r.global)return;{const n=t.getComponent(i,"character-stats");let o=Object.keys(n.current.bodyParts);return void 0!==r.restricted&&(o=Object.keys(n.current.bodyParts).filter(t=>{const e=n.current.bodyParts[t];return r.restricted.find(t=>t===e.type)})),[e.pick(o)]}}(t,e,r,n);t.createEntity().withComponent("effect",{source:i,target:r,bodyParts:o,effect:n})}):s.missed(t,i)}class Ki{constructor(t,e){this.queries=t,this.random=e,this.components=["take-turn","player","position"]}update(t,e){const i=t.getComponent(e,"script"),r=t.getComponent(e,"take-turn");if(!(void 0!==i)){if(r.actions+r.movements===0)this.endTurn(t,e);else{const i=Vi(t,e,r);this.doTurn(t,e,r,i)}}}doTurn(t,e,i,r){const n=t.getResource("ui"),o=t.getResource("input"),s=t.getComponent(e,"selected-action");if(void 0===s)n.showActionSelector(r),t.editEntity(e).withComponent("selected-action",{currentSubAction:0,skippedActions:0});else if(void 0===s.selection){const t=n.selectedAction();void 0!==t&&(s.selection=t,n.hideSelectors())}else{const r=o.isActive("cancel"),n=s.selection.action,a=n.subActions.length;if(s.currentSubAction>=a){const r=s.selection.action;(0==a||a-s.skippedActions>0)&&(r.cost.costsAll?(i.movements=0,i.actions=0):(i.movements-=r.cost.movement,i.actions-=r.cost.actions)),this.clearAction(t,e)}else if(r)s.currentSubAction+=1,s.skippedActions+=1;else{const i=n.subActions[s.currentSubAction];this.handleSubAction(t,e,i,s)&&(s.currentSubAction+=1)}}}handleSubAction(t,e,i,r){switch(i.kind){case"attack":return void 0===r.target?(r.target=this.findTarget(t,e,i),!1):this.attackTarget(t,e,i,r.target);case"movement":return this.move(t,e,i);case"status":return this.status(t,e,i)}}endTurn(t,e){t.editEntity(e).removeComponent("take-turn").withComponent("took-turn",{})}clearAction(t,e){t.editEntity(e).removeComponent("selected-action")}move(t,e,i){const r=t.getResource("ui");r.showMovementSelector(e,this.queries,i);const n=r.selectedMovement();return void 0!==n&&(r.hideSelectors(),t.editEntity(e).withComponent("script",{path:n.path}),!0)}findTarget(t,e,i){const r=t.getResource("viewport"),n=t.getResource("map"),o=t.getResource("ui");o.showAttackSelector(e,this.queries,i.range);const s=o.selectedAttack();if(void 0!==s)for(let t=0;t<s.path.length;++t){let i=n.levels[r.level].getCharacter(s.path[t]);if(void 0!==i&&i!==e)return o.hideSelectors(),i}}attackTarget(t,e,i,r){return Ui(t,this.random,e,r,i),!0}status(t,e,i){return i.effects.forEach(i=>{t.createEntity().withComponent("effect",{source:e,target:e,effect:i})}),!0}}class Hi{constructor(t,e){this.random=t,this.pushState=e,this.components=["active","triggers"]}update(t,e){let i=!0;const r=t.getComponent(e,"triggers");switch(r.type){case"dialog":i=this.handleDialog(t,e,r);break;case"asset":i=this.handleAsset(t,e,r)}i&&t.editEntity(e).removeComponent("active").removeComponent("triggered-by")}handleDialog(t,e,i){const r=t.getComponent(i.entities[0],"dialog"),n=t.getComponent(e,"triggered-by"),o=Pe(t.getResource("ui"),t,this.random,r.type,n.entity,e,this.pushState);if(void 0!==o){if("attack"===o){const i=t.getComponent(e,"ai");void 0!==i&&De(t,e,i,this.pushState)}return!0}return!1}handleAsset(t,e,i){switch(t.getComponent(e,"asset").type){case"door":return this.door(t,i);case"loot":return this.loot(t,e,i,!0);case"trash":case"locker":case"table":return this.loot(t,e,i,!1);case"generator":return this.log(t,"clonck"),!0}return!1}door(t,e){return e.entities.forEach(e=>this.swapGroundAndFeature(t,e)),!0}loot(t,e,i,r){const n=t.getResource("map"),o=t.getResource("ui");if(o.isModal){if(!o.inventoryTransferModalShowing()){o.isModal=!1;const i=t.getComponent(e,"inventory");return r&&0===i.content.length&&ai(t,n,e),!0}}else{const r=t.getComponent(e,"triggered-by"),n=t.getComponent(i.entities[0],"feature"),s=t.getComponent(r.entity,"feature").feature().name,a=n.feature().name;o.showInventoryTransferModal(t,e,a,r.entity,s),this.pushState(new Le(t.activeSystemsList()))}return!1}log(t,e){t.getResource("log").text(e)}swapGroundAndFeature(t,e){const i=t.getComponent(e,"feature"),r=t.getComponent(e,"ground"),n=i.feature;i.feature=r.feature,r.feature=n}}function Wi(t,e,i,r,n,o){const s=r.current.bodyParts[n];if(s.health=Math.max(0,s.health-o),0===s.health){"torso"===s.type||"head"===s.type?zi(t,i):t.createEntity().withComponent("effect",{effect:{type:"bleed",negated:!1,global:!1},bodyParts:["torso"],source:e,target:i})}}function zi(t,e){if(t.hasComponent(e,"position")){const i=t.getComponent(e,"position"),r=t.getComponent(e,"inventory"),n=t.getResource("map");n.levels[i.level].removeCharacter(i.position),t.editEntity(e).withComponent("dead",{}).removeComponent("take-turn").removeComponent("start-turn").removeComponent("took-turn").removeComponent("wait-turn");const o=new _([i.position.fX,i.position.fY]),s=function(t,e,i,r,n,o){const s=ni[o],a=t.createEntity().withComponent("asset",{type:o}).withComponent("triggers",{name:s.name,type:"asset",entities:[]}).entity;return s.hasInventory&&t.editEntity(a).withComponent("inventory",{content:[]}),oi(o,r,n).foreach((r,n)=>{const o=li(t,e,i,r,()=>s.feature(n));ui(t,o,a)}),a}(t,n,i.level,o,"up","loot");t.editEntity(s).withComponent("inventory",Object.assign({},r)),t.getResource("log").died(t,e)}}class qi{constructor(){this.components=["effect"]}update(t,e){const i=t.getComponent(e,"effect");switch(i.effect.type){case"damage":i.effect.negated?this.applyHeal(t,i):this.applyDamage(t,i);break;case"kill":zi(t,i.target);break;default:this.applyStatusEffect(t,i)}t.deleteEntity(e)}applyDamage(t,e){const{effect:i,source:r,target:n,bodyParts:o}=e,s=t.getComponent(n,"character-stats");if(void 0!==s&&void 0!==o){const a=t.getResource("log");console.error("not implemeted yet: splash damage onto to multiple body parts"),o.forEach(o=>{const l=t.getComponent(n,"equiped-items"),u=[];l.equipment.forEach(e=>{pe[t.getComponent(e.entity,"item").type].effects.forEach(t=>{(t.global||e.bodyParts.find(t=>t===o))&&"defend"===t.type&&u.push(t)})}),t.getComponent(n,"active-effects").effects.forEach(t=>{(t.effect.global||t.bodyPart===o)&&"defend"===t.effect.type&&u.push(t.effect)});const h=u.reduce((t,e)=>t+e.value*(e.negated?-1:1),0),c=Math.max(0,i.value-h);a.effectApplied(t,e,o),Wi(t,r,n,s,o,c)})}}applyHeal(t,e){const i=t.getComponent(e.target,"character-stats"),{effect:r}=e;if(void 0!==i){const n=t.getResource("log");e.bodyParts.forEach(o=>{!function(t,e,i){const r=t.current.bodyParts[e],n=Zt[t.type].bodyParts[e];r.health=Math.max(r.health+i,n.health)}(i,o,r.value),n.effectApplied(t,e,o)})}}applyStatusEffect(t,e){const i=t.getResource("log"),r=t.getComponent(e.target,"active-effects");void 0!==e.bodyParts?e.bodyParts.forEach(n=>{i.effectApplied(t,e,n),r.effects.push({effect:e.effect,bodyPart:n})}):(r.effects.push({effect:e.effect}),i.effectApplied(t,e))}}class ji{constructor(t,e){this.origin=t,this.direction=e}side(t){const e=(t.x-this.origin.x)*this.direction.y-(t.y-this.origin.y)*this.direction.x;return e<0?"left":0===e?"inside":"right"}}class Xi{constructor(){this.components=["script"]}update(t,e){const i=t.getComponent(e,"script"),r=i.path.pop();if(void 0===r)t.editEntity(e).removeComponent("script");else{this.move(t,e,r)||i.path.push(r)}}move(t,e,i){const r=t.getComponent(e,"character-stats"),n=t.getComponent(e,"position"),o=i.center.minus(n.position).normalize();if(o.isNan())return console.warn("target already reached"),!0;const s=o.mult(Bt(r));let a=n.position.add(s);const l=t.getResource("map"),u=new ji(i.center,o.perpendicular());let h=!1;return u.side(n.position)!==u.side(a)&&(a=i.center,h=!0),l.levels[n.level].removeCharacter(n.position),l.levels[n.level].setCharacter(a,e),n.position=a,h}}class Yi{constructor(t){this.width=t,this.objects=new Uint8Array(t*t)}has(t){return this.objects[t.index(this.width)]>0}set(t){this.objects[t.index(this.width)]=1}setAll(t){t.foreach(t=>this.set(t))}remove(t){const e=t.index(this.width),i=this.objects[e];return this.objects[e]=0,i>0}}class $i{constructor(t){this.boundary=new v(0,0,t,t),this.tiles=new p(t),this.characters=new p(t),this.structures=new p(t),this.visible=new Yi(t),this.discovered=new Yi(t),this.lights=new g(t)}setTile(t,e){this.tiles.set(t,e)}getTile(t){return this.tiles.get(t)}removeTile(t){return this.tiles.remove(t)}setStructure(t,e){this.structures.set(t,e)}getStructure(t){return this.structures.get(t)}setCharacter(t,e){this.characters.set(t,e)}getCharacter(t){return this.characters.get(t)}removeCharacter(t){return this.characters.remove(t)}addLight(t,e){this.lights.addAll(Ke.l2(t,6,!0),e)}isDiscovered(t){return this.discovered.has(t)}isVisible(t){return this.visible.has(t)}isBlocking(t,e,i){return this.tileMatches(t,e,t=>void 0===t||t.feature().blocking)||this.characterMatches(t,e,t=>void 0!==t&&t.feature().blocking,i)}isLightBlocking(t,e,i=!0){return this.tileMatches(t,e,t=>void 0===t||t.feature().lightBlocking)||i&&this.characterMatches(t,e,t=>void 0!==t&&t.feature().lightBlocking)}tileMatches(t,e,i){return this.featureMatches(t,this.tiles.get(e),i)}characterMatches(t,e,i,r){const n=this.characters.get(e);return(void 0===n||void 0===r||r!==n)&&this.featureMatches(t,n,i)}featureMatches(t,e,i){let r;return void 0!==e&&(r=t.getComponent(e,"feature")),i(r)}isShapeFree(t,e){return this.shapeHasAll(t,e,t=>void 0===t)}isShapeBlocked(t,e){return this.shapeHasSome(t,e,t=>void 0!==t)}shapeHasAll(t,e,i){return e.all(e=>this.tileMatches(t,e,i))}shapeHasSome(t,e,i){return e.some(e=>this.tileMatches(t,e,i))}}class Gi{constructor(t){this.width=t,this.kind="map",this.levels=[],this.levels.push(new $i(this.width))}update(t){const e=new Set;t.components.get("player").foreach(i=>{const r=t.getComponent(i,"position");if(void 0!==r){const n=this.levels[r.level],o=t.getComponent(i,"fov");n.visible=new Yi(this.width),void 0!==o&&o.fov.forEach(t=>{n.visible.set(t.position),n.discovered.set(t.position),n.lights.get(t.position).forEach(t=>e.add(t))})}}),t.components.get("light").foreach(i=>{const r=t.editEntity(i);e.has(i)?r.withComponent("active",{}):r.removeComponent("active")})}}class Zi{constructor(t){this.boundaries=t,this.kind="viewport",this.gridLocked=!1,this.topLeft=new _([0,0]),this.level=0,this.layers=[]}update(t){t.getResource("input").isActive("grid")&&(this.gridLocked=!this.gridLocked),t.components.get("viewport-focus").foreach(e=>{const i=t.getComponent(e,"position");void 0!==i&&this.focus(i.level,i.position)})}collectRenderables(t){const e=[];for(let i=0;i<this.boundaries.y;i++)for(let r=0;r<this.boundaries.x;r++)for(let n=this.layers.length-1;n>=0;n--){const o=this.layers[n];let s;if(void 0!==(s=o.transformed?o.getRenderable(t,this.level,this.fromDisplay({x:r,y:i})):o.getRenderable(t,this.level,new _([r,i]))).entity&&e.push(s),!s.opaque)break}return e.reverse()}addLayer(t){this.layers.push(t)}fromDisplay(t){return new _([this.topLeft.x+t.x,this.topLeft.y+t.y])}toDisplay(t,e){const i={x:t.x-this.topLeft.x,y:t.y-this.topLeft.y};return this.gridLocked&&(i.x=Math.floor(i.x),i.y=Math.floor(i.y)),!this.gridLocked&&e&&(i.x+=.5,i.y+=.25),i}focus(t,e){this.level=t;const i=e.x-Math.floor(this.boundaries.x/2)+5,r=e.y-Math.floor(this.boundaries.y/2)+5;this.gridLocked?this.topLeft=new _([Math.floor(i),Math.floor(r)]):this.topLeft=new _([i,r])}}const Ji={left:q.VK_H,down:q.VK_J,up:q.VK_K,right:q.VK_L,use:q.VK_E,accept:q.VK_RETURN,cancel:q.VK_ESCAPE,0:q.VK_1,1:q.VK_2,2:q.VK_3,3:q.VK_4,4:q.VK_5,5:q.VK_6,6:q.VK_7,7:q.VK_8,8:q.VK_9,inventory:q.VK_I,log:q.VK_O,overview:q.VK_U,focus:q.VK_Q,grid:q.VK_G};class Qi{constructor(t){this.eventToPosition=t,this.kind="input",this.position=void 0,this.mouseDown=!1,this.mousePressed=!1,this.mouseReleased=!1,this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.keyDown=new Set,this.keyPressed=new Set,this.keyReleased=new Set,this.mouseEvent=void 0,this.keyEvents=[],document.addEventListener("mousedown",t=>this.mouseEvent=t),document.addEventListener("mousemove",t=>this.mouseEvent=t),document.addEventListener("keydown",t=>this.keyEvents.push(t)),document.addEventListener("keyup",t=>this.keyEvents.push(t))}update(){this.handleMouseEvent(),this.handleKeyboardEvents()}isActive(t){const e=Ji[t];return"number"==typeof e?!this.shift&&!this.alt&&!this.ctrl&&!this.meta&&this.keyPressed.has(e):this.shift===e.shift&&this.alt===e.alt&&this.ctrl===e.ctrl&&this.meta===e.meta&&this.keyPressed.has(e.pressed)}numericActive(){return[0,1,2,3,4,5,6,7,8].find(t=>this.isActive(t))}createMovementDelta(){let t=new _([0,0]);return this.keyDown.has(q.VK_H)&&(t=t.add(_.fromDirection("left"))),this.keyDown.has(q.VK_J)&&(t=t.add(_.fromDirection("down"))),this.keyDown.has(q.VK_K)&&(t=t.add(_.fromDirection("up"))),this.keyDown.has(q.VK_L)&&(t=t.add(_.fromDirection("right"))),t.normalize()}handleMouseEvent(){if(this.mouseReleased=!1,this.mousePressed=!1,this.mouseEvent){this.position=this.eventToPosition(this.mouseEvent),this.mouseEvent.buttons>0?this.position&&(this.mousePressed=!0,this.mouseDown=!0):(this.mouseDown=!1,this.mouseReleased=!0),this.mouseEvent=void 0}}handleKeyboardEvents(){this.keyPressed.clear(),this.keyReleased.clear();for(const t of this.keyEvents)this.shift=t.shiftKey,this.ctrl=t.ctrlKey,this.alt=t.altKey,this.meta=t.metaKey,"keydown"===t.type?(this.keyPressed.add(t.keyCode),this.keyDown.add(t.keyCode)):(this.keyReleased.add(t.keyCode),this.keyDown.delete(t.keyCode));this.keyEvents=[]}}class tr{constructor(){this.kind="log",this.entries=[]}update({}){}render({}){}getEntries(t,e){const i=Math.max(0,this.entries.length+t-e),r=Math.min(this.entries.length,i+e);return this.entries.slice(i,r)}effectApplied(t,e,i){const{effect:r}=e,n=this.getName(t,e.source),o=this.getName(t,e.target),s=this.verbify(n,r.type);if(r.global)this.entries.push(`${n} ${s} ${o}`);else{const t=this.owner(o),e=void 0!==r.value?`(${r.value})`:"";this.entries.push(`${n} ${s} ${t} ${i} ${e}`)}}text(t){this.entries.push(t)}attack(t,e,i,r){const n=this.getName(t,e),o=this.getName(t,i);let s=this.verbify(n,"try");const a=o;this.entries.push(`${n} ${s} to ${r.kind} ${a}`)}died(t,e){const i=this.getName(t,e);this.entries.push(`${i} died`)}missed(t,e){const i=this.getName(t,e);this.entries.push(`${i} missed`)}getName(t,e){const i=ze(t,e);return void 0!==i?i.name:"something"}verbify(t,e){return"you"!==t?"try"===e?"tries":e+"s":e}owner(t){return"you"===t?"your":`${t}'s`}}class er{constructor(t,e){this.queries=t,this.random=e,this.components=["take-turn","ai","position"]}update(t,e){const i=t.getComponent(e,"script"),r=t.getComponent(e,"take-turn"),n=void 0!==i,o=0===r.actions&&0===r.movements;if(!n)if(o)this.endTurn(t,e);else{const i=t.getComponent(e,"selected-action");if(void 0===i){const i=Vi(t,e,r);this.selectAction(t,e,i)}else this.takeAction(t,e,r,i)}}selectAction(t,e,i){const r=t.getComponent(e,"position");let n=this.findTarget(t,r.position);if(void 0!==n){const o=t.getComponent(n,"position"),s=this.queries.ray(t,r.level,r.position,o.position,{}),a=[],l=[],u=[];for(const t of i)t.items.filter(t=>t.available).map(e=>{const i={entity:t.entity,action:e.action};void 0!==e.action.subActions.find(t=>"movement"===t.kind)&&a.push(i),void 0!==e.action.subActions.find(t=>void 0!==s&&"attack"===t.kind&&t.range>=s.cost)&&l.push(i),u.push(i)});let h=void 0;const c=o.position.minus(r.position).lN()>1&&a.length>0,f=void 0!==s;c?h=this.random.pick(a):l.length>0&&f&&(h=this.random.pick(l)),void 0!==h?t.editEntity(e).withComponent("selected-action",{skippedActions:0,target:n,currentSubAction:0,selection:h}):this.endTurn(t,e)}else this.endTurn(t,e)}takeAction(t,e,i,r){const n=r.selection.action,o=n.subActions.length;if(r.currentSubAction>=o)n.cost.costsAll?(i.movements=0,i.actions=0):(i.movements-=n.cost.movement,i.actions-=n.cost.actions),t.editEntity(e).removeComponent("selected-action");else{const i=n.subActions[r.currentSubAction];switch(i.kind){case"movement":this.move(t,e,r.target,i);break;case"attack":this.attack(t,e,r.target,i)}r.currentSubAction++}}move(t,e,i,r){const n=t.getComponent(e,"position"),o=t.getComponent(i,"position"),s=this.queries.shortestPath(t,n.level,n.position,o.position,{maximumCost:r.range,bestEffort:!0});void 0!==s&&s.path.length>0&&t.editEntity(e).withComponent("script",{path:s.path})}attack(t,e,i,r){const n=t.getComponent(e,"position"),o=t.getComponent(i,"position"),s=this.queries.ray(t,n.level,n.position,o.position,{});void 0!==s&&s.cost<=r.range&&Ui(t,this.random,e,i,r)}findTarget(t,e){let i,r=Number.MAX_SAFE_INTEGER;return t.getStorage("player").foreach(n=>{const o=t.getComponent(n,"position");if(void 0!==o){const t=e.minus(o.position).squaredLength();void 0===i&&t<r&&(i=n,r=t)}}),i}endTurn(t,e){t.editEntity(e).removeComponent("take-turn").withComponent("took-turn",{})}}class ir{constructor(t){this.random=t,this.components=["start-turn","position"]}update(t,e){const i=t.getComponent(e,"character-stats"),r=t.getComponent(e,"active-effects");r.effects=r.effects.filter(t=>void 0===t.effect.duration||t.effect.duration>0);let n=!0,o=!0,s=!0;r.effects.forEach(r=>{switch(r.effect.type){case"bleed":Wi(t,e,e,i,r.bodyPart,1);break;case"confuse":n=!1;break;case"immobilize":o=!1;break;case"stun":o=!1,s=!1}void 0!==r.effect.duration&&(r.effect.duration-=1)});let a,l=0,u=0,h=0,c=0;Object.keys(i.current.bodyParts).forEach(t=>{const e=i.current.bodyParts[t];switch(e.type){case"leg":u++,e.health>0&&c++;break;case"arm":l++,e.health>0&&h++}}),a=c>0?c/u:h/l/3;let f=h>0?1:.3;i.current.aim=n?Zt[i.type].aim:0,o||(a=0),s||(f=0),t.editEntity(e).removeComponent("start-turn").withComponent("take-turn",{movements:Math.ceil(a*i.current.movement),actions:Math.ceil(f*i.current.actions)})}}class rr extends Oe{constructor(){super("main-menu",["free-mode-control"])}start(t){super.start(t);const e=t.getStorage("viewport-focus").first();t.getStorage("viewport-focus").clear();const i=t.getComponent(e,"position");t.createEntity().withComponent("free-mode-anchor",{}).withComponent("viewport-focus",{}).withComponent("position",Object.assign({},i))}isDone(t){return!1}update(t){}isFrameLocked(){return!0}}class nr extends Oe{constructor(){super("running",["fov","light","player-control","player-interaction","npc","trigger","free-mode-control","effect"])}start(t){super.start(t),0===t.components.get("viewport-focus").size()&&this.createViewportFocus(t),t.getResource("ui").reset()}createViewportFocus(t){const e=t.getResource("map");t.components.get("spawn").foreach(i=>{this.spawnPlayer(t,e,i)}),this.createUILayer(t)}spawnPlayer(t,e,i){const r=t.getComponent(i,"position"),n=Vt("player"),o=t.createEntity().withComponent("item",{type:"idCard"}).entity,s=t.createEntity().withComponent("item",{type:"nailGun"}).entity,a=t.createEntity().withComponent("item",{type:"sniperRifle"}).entity,l=t.createEntity().withComponent("item",{type:"rifle"}).entity,u=t.createEntity().withComponent("item",{type:"bootsOfStriding"}).entity,h=t.createEntity().withComponent("item",{type:"leatherJacket"}).entity,c=t.createEntity().withComponent("player",{}).withComponent("viewport-focus",{}).withComponent("position",Object.assign({},r)).withComponent("feature",{feature:()=>zt.player}).withComponent("fov",{fov:[]}).withComponent("has-action",{actions:["longMove","hit","rush","endTurn"]}).withComponent("character-stats",n).withComponent("inventory",{content:[s,a,l,h,u,o]}).withComponent("active-effects",{effects:[]}).withComponent("equiped-items",{equipment:[{entity:s,bodyParts:["leftArm"]},{entity:h,bodyParts:["torso","leftArm","rightArm"]}]}).entity;t.getResource("ui").createTabs(t,c),e.levels[r.level].setCharacter(r.position,c)}createUILayer(t){t.getResource("viewport").addLayer({getRenderable:(t,e,i)=>{return{entity:void 0,opaque:!t.getResource("ui").hasElement(i),centered:!0}},transformed:!1})}update(t,e){const i=t.getStorage("player").first();t.hasComponent(i,"dead")&&e(new rr)}isFrameLocked(){return!0}}class or extends Oe{constructor(){super("map-creation",["region-creator"])}start(t){super.start(t);const e=t.getResource("viewport"),i=t.getResource("map");e.addLayer({getRenderable:(t,e,r)=>{return{entity:i.levels[e].getTile(r),opaque:!0,centered:!0}},transformed:!0}),e.addLayer({getRenderable:(t,e,r)=>{return{entity:i.levels[e].getCharacter(r),opaque:!0,centered:!1}},transformed:!0}),this.startRegion=t.createEntity().withComponent("region",{type:"red",shape:new v(0,0,50,50),level:0,entry:void 0,authorized:new Set}).withComponent("active",{}).entity}update({}){}stop(t){if(super.stop(t),void 0!==this.startRegion){const e=t.getComponent(this.startRegion,"region");t.createEntity().withComponent("position",{level:e.level,position:e.entry}).withComponent("spawn",{})}this.fillWalls(t)}isFrameLocked(){return!1}fillWalls(t){const e=t.getResource("map");e.levels.forEach((i,r)=>{i.boundary.foreach(n=>{const o=Ke.lN(n,1,!1).some(e=>{const r=i.getTile(e);return void 0!==r&&"wall"!==t.getComponent(r,"feature").feature().name});void 0===i.getTile(n)&&o&&qe(t,e,r,n,"wall")})})}}function sr(t,e,i,r){e.foreach(e=>{!t.has(e)&&r(e)&&(i.push(e),t.set(e))})}class ar{constructor(t){this.maximumKeySpan=t,this.bucketOfValue=new Map,this.buckets=[],this.boundaries=[],this.bucketCount=Math.floor(Math.log2(t+1))+1,this.boundaries[0]=0,this.buckets[0]=[],this.boundaries[1]=1,this.buckets[1]=[],this.boundaries[this.bucketCount+1]=t;for(let t=2;t<=this.bucketCount;t++)this.boundaries[t]=2<<t-2,this.buckets[t]=[]}insert(t,e,i){this.insertIntoLargestPossibleBucket(t,e,i,this.bucketCount)}getPriority(t){let e=this.bucketOfValue.get(t);if(void 0!==e)return this.findInBucket(e,t)}decreasePriority(t,e){let i=this.bucketOfValue.get(t);if(void 0===i)throw Error(`unknown bucket for key ${t}`);const r=this.removeFromBucket(t,i);this.insertIntoLargestPossibleBucket(t,r.value,e,i)}extractMin(){let t=this.buckets[0].pop();if(void 0===t){let e=1;for(;e<=this.bucketCount&&0===this.buckets[e].length;)e++;if(e>this.bucketCount)return;let i=Number.MAX_SAFE_INTEGER;const r=this.buckets[e];this.buckets[e]=[];for(let t=0;t<r.length;t++){const e=r[t];i>e.priority&&(i=e.priority),this.bucketOfValue.delete(e.key)}this.boundaries[0]=i,this.boundaries[1]=i+1;for(let t=2;t<=e;t++)this.boundaries[t]=Math.min(this.boundaries[t-1]+(2<<t-2),this.boundaries[e+1]);for(let t=0;t<r.length;t++){const i=r[t];this.insertIntoLargestPossibleBucket(i.key,i.value,i.priority,e)}t=this.buckets[0].pop()}return this.bucketOfValue.delete(t.key),t.value}removeFromBucket(t,e){this.bucketOfValue.delete(t);const i=this.buckets[e],r=i.findIndex(e=>e.key===t),n=i[r];return i[r]=i[i.length-1],i.pop(),n}insertIntoLargestPossibleBucket(t,e,i,r){for(;this.boundaries[r]>i;)--r;this.buckets[r].push({key:t,value:e,priority:i}),this.bucketOfValue.set(t,r)}findInBucket(t,e){const i=this.buckets[t],r=i.findIndex(t=>t.key===e),n=i[r];if(void 0!==n)return n.priority}}function lr(t,e,i,r,n,o,s=!1){const a=s?Number.MAX_SAFE_INTEGER:o,{parent:l,costMap:u,closest:h}=function(t,e,i,r,n,o){const s=e.key,a=new Map,l=new Set,u=new ar(256),h=new Map;let c=t,f=n(t);u.insert(t.key,t,f),h.set(t.key,0),a.set(t.key,t);for(;;){const t=u.extractMin();if(void 0===t)break;const e=n(t);e<=f&&(c=t,f=e);const d=t.key;if(s===d||e>5*f)break;l.add(d);const m=h.get(d);r(t).foreach(e=>{const r=e.key;if(!l.has(r)){const s=i(t,e);if(void 0!==s){const i=m+s;if(i<(h.get(r)||Number.MAX_SAFE_INTEGER)&&i<=o){a.set(r,t),h.set(r,i);const o=i+n(e);void 0===u.getPriority(r)?u.insert(r,e,o):u.decreasePriority(r,o)}}}})}return{parent:a,costMap:h,closest:c}}(t,e,i,r,n,a);if(!1!==s||h.key===e.key)return function(t,e,i,r){let n=[],o=t,s=i.get(t.key);for(;;){const t=o.key,a=i.get(o.key);s>r&&(s=a),s<=r&&n.push(o);const l=e.get(t);if(void 0===l)return;if(o.key===l.key)break;o=l}return{path:n,cost:s}}(h,l,u,o)}function ur(t,e,i=!1){let r={x:Math.abs(e.x),y:Math.abs(e.y)};const n=Math.sign(e.x),o=Math.sign(e.y);let s=!1;r.y>r.x&&(r={x:r.y,y:r.x},s=!0);let a=2*r.y-r.x,l=0;const u={x:t.x,y:t.y};let h=!1;return()=>{if(h)return;const t=new _([u.x,u.y]);if(i||l<r.x){for(;a>0;)a-=2*r.x,s?u.x+=n:u.y+=o;a+=2*r.y,s?u.y+=o:u.x+=n}else h=!0;return l+=1,t}}class hr extends m{constructor(t,e){super(),this.from=t,this.to=e}get direction(){return this.to.minus(this.from)}bounds(){return new v(Math.min(this.from.x,this.to.x),Math.min(this.from.y,this.to.y),Math.abs(this.from.x-this.to.x),Math.abs(this.from.y-this.to.y))}translate(t){return new hr(this.from.add(t),this.to.add(t))}containsVector(t){return this.some(e=>t.equals(e))}grow(t=1){const e=ur(this.from,this.direction.mult(-1),!0),i=ur(this.to,this.direction,!0);let r=e(),n=i();for(let o=0;o<t;o++)r=e(),n=i();return new hr(r,n)}shrink(t=1){const e=ur(this.from,this.direction,!0),i=ur(this.to,this.direction.mult(-1),!0);let r=e(),n=i();for(let o=0;o<t;o++)r=e(),n=i();return new hr(r,n)}all(t){const e=ur(this.from,this.direction,!1);for(;;){const i=e();if(void 0===i)return!0;if(!t(i))return!1}}}class cr{fov(t,e,i,r){const n=new _([i.fX,i.fY]),o=t.getResource("map"),s=new ot.RecursiveShadowcasting((i,r)=>!o.levels[e].isLightBlocking(t,new _([i,r])),{topology:8}),a=new Yi(o.levels[e].boundary.width);s.compute(n.x,n.y,20,(t,e,i)=>{const n=new _([t,e]);a.has(n)||(a.set(n),r(n,i))})}lighting(t,e,i,r,n){const o=t.getResource("map"),s=new _([i.fX,i.fY]),a=new ot.RecursiveShadowcasting((i,r)=>!o.levels[e].isLightBlocking(t,new _([i,r])),{topology:8}),l=new xt((i,r)=>o.levels[e].isLightBlocking(t,new _([i,r]))?0:1,{passes:1});l.setLight(s.x,s.y,r.color),l.setFOV(a),l.setOptions({range:6}),l.compute((t,e,i)=>{n(new _([t,e]),new Ot(i))})}explore(t,e,i,r,n){const o=t.getResource("map"),s=new _([i.fX,i.fY]),a=n.maximumCost||Number.MAX_SAFE_INTEGER,l=n.onlyDiscovered||!1;!function(t,e,i,r,n){const o=new Yi(t);o.set(e);let s=1,a=[],l=[];sr(o,i(e),a,t=>n(t,s));let u=!1;for(;!u;){const t=a.pop();if(void 0!==t)u=r(t,s),sr(o,i(t),l,t=>n(t,s));else if(a=l,l=[],s++,0===a.length)break}}(o.levels[e].boundary.width,s,t=>Ke.lN(t,1,!1),r,(i,r)=>!(r>=a||o.levels[e].isBlocking(t,i))&&(!l||o.levels[e].isDiscovered(i)))}shortestPath(t,e,i,r,n){const o=t.getResource("map"),s=n.onlyDiscovered||!1,a=new _([i.fX,i.fY]),l=new _([r.fX,r.fY]),u=n.maximumCost||Number.MAX_SAFE_INTEGER,h=n.bestEffort||!1,c=lr(a,l,(i,r)=>{if(!o.levels[e].isBlocking(t,r)&&(!s||o.levels[e].isDiscovered(r)))return i.minus(r).l1()},t=>Ke.l1(t,1,!1),t=>l.minus(t).l1(),u,h);if(void 0!==c&&c.path.length-1<=u)return{path:c.path.slice(0,c.path.length-1),cost:c.cost}}ray(t,e,i,r,n){const o=t.getResource("map"),s=new _([i.fX,i.fY]),a=new _([r.fX,r.fY]),l=n.maximumCost||Number.MAX_SAFE_INTEGER,u=[];if(new hr(a,s).all(i=>(u.push(i),!o.levels[e].isLightBlocking(t,i,!1)))){let t=u.length-1;if(u.length-1<=l)return{path:u.slice(0,u.length-1),cost:t}}}}class fr{constructor(t,e){this.world=t,this.entity=e}withComponent(t,e){return this.world.getStorage(t).insert(this.entity,e),this}removeComponent(t){return this.world.getStorage(t).remove(this.entity),this}delete(){this.world.components.forEach(t=>t.remove(this.entity))}}class dr{constructor(t,e){this.display=t,this.ambientColor=e}get boundaries(){return new _([this.display.getOptions().width,this.display.getOptions().height])}static createAndMount(t,e={width:80,height:50,forceSquareRatio:!0,fontSize:16,fontFamily:"Monaco, monospace",bg:Pt[4].toRgb()}){const i=new Ot([200,120,120]),r=new Y(e);return t.appendChild(r.getContainer()),new dr(r,i)}clear(){this.display.clear()}render(t){this.clear();const e=t.getResource("viewport");e.collectRenderables(t).forEach(({entity:i,centered:r})=>{void 0!==i&&this.renderEntity(t,e,i,r)}),t.getResource("ui").render(this),t.getStorage("lighting").foreach(({},t)=>{const e=t.incomingLight;t.incomingLight=t.incomingLightInFrame,t.incomingLightInFrame=e,t.incomingLightInFrame.clear()}),t.components.get("overlay").clear()}renderEntity(t,e,i,r){const n=ze(t,i),o=t.getComponent(i,"position");n&&o&&this.renderFeature(t,e,i,r,n,o)}renderFeature(t,e,i,r,n,o){const s=t.getResource("map").levels[o.level],a=o.position;if(s.isDiscovered(a)){let o=void 0;s.isVisible(a)&&(o=t.getComponent(i,"lighting"));const l=t.getComponent(i,"overlay")||{background:void 0},u=e.toDisplay(a,r);this.character(n.character,u,this.computeColor(this.ambientColor,n.diffuse,o),l.background)}}computeColor(t,e,i){if(void 0===i)return e.multiply(t);{let r=t;return i.incomingLight.forEach(t=>{r=r.add(t)}),e.multiply(r)}}eventToPosition(t){const e=this.display.eventToPosition(t);if("object"==typeof e)return{x:e[0],y:e[1]}}character(t,e,i,r){const n=i.toRgb(),o=r?r.toRgb():void 0;this.display.draw(e.x,e.y,t[0],n,o||null)}text(t,e,i,r){const n=i.toRgb(),o=r?r.toRgb():void 0;for(let i=0;i<t.length;i++)this.display.draw(e.x+i,e.y,t[i],n,o||null)}flowText(t,e,i,r,n){const o=`%c{${r.toRgb()}}`,s=n?`%b{${n.toRgb()}}`:"";return this.display.drawText(e.x,e.y,`${o}${s}${t}`,i)}}const mr=new class{constructor(t,e,i){this.world=t,this.renderer=e,this.targetFps=i,this.computeTime=0,this.frames=0,this.renderTime=0,this.started=0,this.currentState=-1,this.states=[],this.rayCaster=new cr}init(){var t;(t=this.world).registerComponentStorage("active",new n),t.registerComponentStorage("age",new s),t.registerComponentStorage("ai",new s),t.registerComponentStorage("asset",new s),t.registerComponentStorage("character-stats",new s),t.registerComponentStorage("dead",new n),t.registerComponentStorage("dialog",new s),t.registerComponentStorage("effect",new s),t.registerComponentStorage("feature",new a),t.registerComponentStorage("fov",new s),t.registerComponentStorage("free-mode-anchor",new o),t.registerComponentStorage("ground",new s),t.registerComponentStorage("has-action",new s),t.registerComponentStorage("inventory",new s),t.registerComponentStorage("structure",new s),t.registerComponentStorage("equiped-items",new s),t.registerComponentStorage("item",new s),t.registerComponentStorage("light",new s),t.registerComponentStorage("lighting",new s),t.registerComponentStorage("npc",new n),t.registerComponentStorage("overlay",new s),t.registerComponentStorage("player",new o),t.registerComponentStorage("position",new a),t.registerComponentStorage("region",new s),t.registerComponentStorage("script",new s),t.registerComponentStorage("selected-action",new o),t.registerComponentStorage("active-effects",new s),t.registerComponentStorage("spawn",new o),t.registerComponentStorage("take-turn",new s),t.registerComponentStorage("took-turn",new n),t.registerComponentStorage("start-turn",new n),t.registerComponentStorage("triggered-by",new s),t.registerComponentStorage("triggers",new s),t.registerComponentStorage("viewport-focus",new o),t.registerComponentStorage("wait-turn",new n),function(t,e){t.registerResource(new Gi(256)),t.registerResource(new Zi(e.boundaries)),t.registerResource(new Qi(t=>e.eventToPosition(t))),t.registerResource(new Ie),t.registerResource(new tr)}(this.world,this.renderer),function(t,e,i){const r=new Ge("some seed");t.registerSystem("ai-round-control",new er(e,new Ye(r))),t.registerSystem("effect",new qi),t.registerSystem("fov",new l(e)),t.registerSystem("free-mode-control",new u),t.registerSystem("light",new f(e)),t.registerSystem("npc",new Be(e,new Ye(r),i)),t.registerSystem("player-control",new Ue),t.registerSystem("player-interaction",new He(i)),t.registerSystem("player-round-control",new Ki(e,new Ye(r))),t.registerSystem("region-creator",new Ri(r)),t.registerSystem("script",new Xi),t.registerSystem("trigger",new Hi(new Ye(r),i)),t.registerSystem("start-round",new ir(new Ye(r)))}(this.world,this.rayCaster,t=>this.pushState(t));const e=new nr,i=new or;this.states=[e,i]}execute(){this.enterState(),this.started=Date.now(),this.tick()}tick(){this.currentState!=this.states.length-1&&this.enterState();const t=this.states[this.currentState];let e=1e3/this.targetFps;const i=Date.now();this.world.updateResources(),this.renderer.render(this.world);const r=Date.now()-i;for(e-=r,this.renderTime+=r,t.update(this.world,t=>this.pushState(t));;){const i=Date.now();this.world.updateSystems();const r=Date.now()-i;if(e-=r,this.computeTime+=r,t.isFrameLocked()||t.isDone(this.world)||e<r)break}if(this.currentState<this.states.length-1)t.stop(this.world);else if(t.isDone(this.world)&&(t.stop(this.world),this.states.pop(),0===this.states.length))return;this.frames++,this.frames%100==0&&(console.log(`${this.mspf.toFixed(2)} ms per frame @${this.fps.toFixed(1)} FPS`),console.log(`(computation, rendering) = (${this.mscpf.toFixed(2)}, ${this.msrpf.toFixed(2)}) ms`),console.log(`Entities: ${this.world.entityCount}`),this.frames=0,this.computeTime=0,this.renderTime=0,this.started=Date.now()),requestAnimationFrame(()=>this.tick())}get fps(){return this.frames/((Date.now()-this.started)/1e3)}get mspf(){return(this.computeTime+this.renderTime)/this.frames}get msrpf(){return this.renderTime/this.frames}get mscpf(){return this.computeTime/this.frames}pushState(t){this.states.push(t)}enterState(){this.currentState=this.states.length-1,this.states[this.currentState].start(this.world)}}(new class{constructor(){this.components=new Map,this.resources=new Map,this.systems=new Map,this.emptySystems=new Set,this.activeSystems=new Set,this.openEntities=new Set,this.lastEntity=-1}get entityCount(){return this.lastEntity+1-this.openEntities.size}registerComponentStorage(t,e){this.components.set(t,e)}getStorage(t){return this.components.get(t)}getResource(t){return this.resources.get(t)}getComponent(t,e){const i=this.getStorage(e);if(void 0!==i)return i.get(t)}hasEntity(t){return t<=this.lastEntity&&!this.openEntities.has(t)}hasComponent(t,e){const i=this.getStorage(e);return void 0!==i&&i.has(t)}createEntity(){let t;return this.openEntities.size>0?(t=this.openEntities.values().next().value,this.openEntities.delete(t)):t=++this.lastEntity,new fr(this,t)}editEntity(t){return new fr(this,t)}deleteEntity(t){this.editEntity(t).delete(),this.openEntities.add(t)}registerSystem(t,e){this.systems.set(t,e)}enableSystem(t){this.activeSystems.add(t)}disableSystem(t){this.activeSystems.delete(t)}activeSystemsList(){const t=[];return this.activeSystems.forEach(e=>t.push(e)),t}registerResource(t){this.resources.set(t.kind,t)}updateResources(){for(const t of this.resources)t[1].update(this)}updateSystems(){this.emptySystems.clear();for(const t of this.activeSystems){const e=this.systems.get(t),i=this.getStorage(e.components[0]);let r=0;i.foreach(t=>{let i=!0;for(let r=1;r<e.components.length;r++)if(!this.hasComponent(t,e.components[r])){i=!1;break}i&&(e.update(this,t),r++)}),0===r&&this.emptySystems.add(t)}}},dr.createAndMount(document.getElementById("tlb")),60);mr.init(),mr.execute()}]);
//# sourceMappingURL=tlb.bundle.js.map